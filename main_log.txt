(flax) tbadings@verifai-benchmark-server:~/Documents/martingales/neural_stochastic_control$ python3 run.py --model LinearEnv --counterx_refresh_fraction 0.5 --counterx_fraction 0.25 --verify_batch_size 30000 --expdecrease_loss_type 2 --probability_bound 0.999 --expDecr_multiplier 100 --local_refinement --epochs 25 --perturb_counterexamples --mesh_refine_min 0.00001 --mesh_loss 0.0001 --mesh_train_grid 0.01 --mesh_verify_grid_init 0.01 --mesh_verify_grid_min 0.01 --plot_intermediate

Run using arguments:
 - `model`: LinearEnv
 - `seed`: 1
 - `ppo_load_file`:
 - `ppo_max_policy_lipschitz`: 3
 - `ppo_total_timesteps`: 1000000.0
 - `ppo_num_envs`: 10
 - `ppo_num_steps`: 2048
 - `ppo_num_minibatches`: 32
 - `mesh_train_grid`: 0.01
 - `mesh_loss`: 0.0001
 - `mesh_verify_grid_init`: 0.01
 - `mesh_verify_grid_min`: 0.01
 - `mesh_refine_min`: 1e-05
 - `max_refine_factor`: 100
 - `max_refine_samples`: 1000000000
 - `cegis_iterations`: 100
 - `epochs`: 25
 - `batches`: -1
 - `batch_size`: 4096
 - `probability_bound`: 0.999
 - `loss_lipschitz_lambda`: 0
 - `loss_lipschitz_certificate`: 15
 - `loss_lipschitz_policy`: 4
 - `expDecr_multiplier`: 100.0
 - `verify_batch_size`: 30000
 - `noise_partition_cells`: 12
 - `counterx_refresh_fraction`: 0.5
 - `counterx_fraction`: 0.25
 - `perturb_counterexamples`: True
 - `local_refinement`: True
 - `update_certificate`: True
 - `update_policy`: True
 - `plot_intermediate`: True
 - `perturb_train_samples`: False
 - `expdecrease_loss_type`: 2
 - `linfty`: False
 - `weighted`: True
 - `cplip`: True
 - `split_lip`: True
 - `improved_softplus_lip`: True
 - `cwd`: /home/tbadings/Documents/martingales/neural_stochastic_control

================

Run PPO for model `LinearEnv`
- Total loss after iteration 20: 49.6284
- Total loss after iteration 40: 49.1502
- Export PPO checkpoint to file: /home/tbadings/Documents/martingales/neural_stochastic_control/ckpt/LinearEnv_seed=1_2024-03-05_15-37-07

=== POLICY TRAINING (WITH PPO) COMPLETED ===

- Learner setting: Expected decrease loss type is: 2
- Create initial training grid of size: [300 300]
- Create initial counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

=== Start CEGIS iteration 0 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 972
- Init. samples: 2
- Unsafe samples: 32
- Target samples: 18
- Initializing iteration took 2.6635143756866455 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 0): 100%|█████████████████████████████████████████████████████████| 25/25 [00:13<00:00,  1.88it/s]
Number of times the learn.train_step function was compiled: 1

Loss components in last train step:
 - 0. total: 51.9043
 - 1. init: 32.75238
 - 2. init counterx: 17.227106
 - 3. unsafe: 1.6160864
 - 4. unsafe counterx: 5.0501086e-07
 - 5. expDecrease: 0.004298062
 - 6. expDecrease counterx: 0.30443242
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(5.197486, dtype=float32), Array([1., 1.], dtype=float32)), (Array(2.8039722, dtype=float32), Array([1.        , 0.95679873], dtype=float32)), (Array(9.839895, dtype=float32), Array([0.99999994], dtype=float32)), (Array(5.028569, dtype=float32), Array([1.        , 0.95679873], dtype=float32)), (Array(38.954094, dtype=float32), None), (Array(9.2325115, dtype=float32), None), (Array(34.024075, dtype=float32), None), (Array(27.603884, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2443.5464, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1175.3738, dtype=float32), Array([0.99999994, 0.71975   ], dtype=float32)), (Array(3560.191, dtype=float32), Array([0.99999994], dtype=float32)), (Array(2070.1794, dtype=float32), Array([0.99999994, 0.71975   ], dtype=float32)), (Array(20334.58, dtype=float32), None), (Array(2719.275, dtype=float32), None), (Array(14994.915, dtype=float32), None), (Array(6066.904, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 5481.677 (L1)
-- Lipschitz coefficient of certificate: 1175.374 (L1)
-- Lipschitz coefficient of policy: 2.804 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:06<00:00,  2.13s/it]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 73719
-- Number of factors below 0.75: 589
-- Number of factors below 0.5: 566
-- Number of factors below 0.25: 535
-- Number of factors below 0.1: 508
-- Number of factors below 0.05: 484
-- Number of factors below 0.01: 433
Most violating states:
[[-0.045       0.205       0.01      ]
 [-0.035       0.205       0.01      ]
 [-0.055       0.205       0.01      ]
 [-0.055       0.215       0.01      ]
 [-0.065       0.215       0.01      ]
 [-0.065       0.205       0.01      ]
 [-0.075       0.215       0.01      ]
 [-0.075       0.205       0.01      ]
 [-0.075       0.225       0.01      ]
 [-0.085       0.225       0.01      ]
 [-0.085       0.215       0.01      ]
 [-0.085       0.205       0.01      ]
 [-0.065       0.225       0.01      ]
 [-0.045       0.215       0.01      ]
 [-0.095       0.225       0.01      ]
 [-0.095       0.215       0.01      ]
 [-0.095       0.205       0.01      ]
 [-0.095       0.235       0.01      ]
 [-0.105       0.235       0.01      ]
 [-0.105       0.225       0.01      ]
 [-0.115       0.235       0.01      ]
 [-0.105       0.215       0.01      ]
 [-0.025       0.205       0.01      ]
 [-0.125       0.235       0.01      ]
 [-0.105       0.205       0.01      ]
 [-0.085       0.235       0.01      ]
 [-0.115       0.225       0.01      ]
 [-0.115       0.215       0.01      ]
 [-0.115       0.245       0.01      ]
 [-0.125       0.225       0.01      ]
 [-0.115       0.205       0.01      ]
 [-0.125       0.245       0.01      ]
 [-0.135       0.235       0.01      ]
 [-0.125       0.215       0.01      ]
 [-0.125       0.205       0.01      ]
 [-0.135       0.225       0.01      ]
 [-0.105       0.245       0.01      ]
 [-0.135       0.215       0.01      ]
 [-0.135       0.205       0.01      ]
 [-0.145       0.225       0.01      ]
 [-0.145       0.235       0.01      ]
 [-0.135       0.245       0.01      ]
 [-0.145       0.215       0.01      ]
 [-0.075       0.235       0.01      ]
 [-0.145       0.205       0.01      ]
 [-0.095       0.245       0.01      ]
 [-0.055       0.225       0.01      ]
 [-0.155       0.225       0.01      ]
 [-0.155       0.215       0.01      ]
 [-0.155       0.205       0.01      ]
 [-0.155       0.235       0.01      ]
 [-0.145       0.245       0.01      ]
 [-0.165       0.215       0.01      ]
 [-0.125       0.255       0.01      ]
 [-0.165       0.225       0.01      ]
 [-0.165       0.205       0.01      ]
 [-0.035       0.215       0.01      ]
 [-0.115       0.255       0.01      ]
 [-0.165       0.235       0.01      ]
 [-0.175       0.205       0.01      ]
 [-0.175       0.215       0.01      ]
 [-0.085       0.245       0.01      ]
 [-0.135       0.255       0.01      ]
 [-0.155       0.245       0.01      ]
 [-0.105       0.255       0.01      ]
 [-0.065       0.235       0.01      ]
 [-0.175       0.225       0.01      ]
 [-0.015       0.205       0.01      ]
 [-0.185       0.205       0.01      ]
 [-0.185       0.215       0.01      ]
 [-0.045       0.225       0.01      ]
 [-0.145       0.255       0.01      ]
 [-0.165       0.245       0.01      ]
 [-0.175       0.235       0.01      ]
 [-0.19500001  0.205       0.01      ]
 [-0.095       0.255       0.01      ]
 [-0.205       0.165       0.01      ]
 [-0.205       0.155       0.01      ]
 [-0.185       0.225       0.01      ]
 [-0.205       0.175       0.01      ]
 [-0.205       0.145       0.01      ]
 [-0.075       0.245       0.01      ]
 [-0.025       0.215       0.01      ]
 [-0.205       0.135       0.01      ]
 [-0.155       0.255       0.01      ]
 [-0.125       0.26500002  0.01      ]
 [-0.205       0.185       0.01      ]
 [-0.205       0.125       0.01      ]
 [-0.205       0.105       0.01      ]
 [-0.205       0.115       0.01      ]
 [-0.205       0.095       0.01      ]
 [-0.205       0.085       0.01      ]
 [-0.205       0.075       0.01      ]
 [-0.205       0.065       0.01      ]
 [-0.115       0.26500002  0.01      ]
 [-0.19500001  0.215       0.01      ]
 [-0.135       0.26500002  0.01      ]
 [-0.205       0.055       0.01      ]
 [-0.055       0.235       0.01      ]
 [-0.205       0.19500001  0.01      ]]
Corresponding V values are:
[[3.4289748e-12]
 [3.3077989e-12]
 [3.5976356e-12]
 [3.0251418e-12]
 [3.1042202e-12]
 [3.7281489e-12]
 [3.2197248e-12]
 [3.8113727e-12]
 [2.6955532e-12]
 [2.8095744e-12]
 [3.3006709e-12]
 [3.8798201e-12]
 [2.6243617e-12]
 [3.0401289e-12]
 [2.8619513e-12]
 [3.3580951e-12]
 [3.9329664e-12]
 [2.4247037e-12]
 [2.4678200e-12]
 [2.9394594e-12]
 [2.5258031e-12]
 [3.4002660e-12]
 [3.5478903e-12]
 [2.4548584e-12]
 [3.9185747e-12]
 [2.4145829e-12]
 [2.8928387e-12]
 [3.3266727e-12]
 [2.2069939e-12]
 [2.7925262e-12]
 [3.7816980e-12]
 [2.2771817e-12]
 [2.7571929e-12]
 [3.2165514e-12]
 [3.7344476e-12]
 [3.1572570e-12]
 [2.2920539e-12]
 [3.5443801e-12]
 [3.9362385e-12]
 [4.2283187e-12]
 [3.8444027e-12]
 [2.6674795e-12]
 [4.6575430e-12]
 [2.6780425e-12]
 [4.9833653e-12]
 [2.6618228e-12]
 [3.1071285e-12]
 [6.1080299e-12]
 [6.5979210e-12]
 [6.8440626e-12]
 [5.5723932e-12]
 [4.2036726e-12]
 [8.9136649e-12]
 [3.0474091e-12]
 [8.6505499e-12]
 [9.2268701e-12]
 [3.9691844e-12]
 [2.9987503e-12]
 [8.7905317e-12]
 [1.4614806e-11]
 [1.3867799e-11]
 [3.5186762e-12]
 [4.2870646e-12]
 [6.8589730e-12]
 [4.4213791e-12]
 [3.9198380e-12]
 [1.3787255e-11]
 [5.5966039e-12]
 [2.3669788e-11]
 [2.3203032e-11]
 [5.8320480e-12]
 [8.3053599e-12]
 [1.2546281e-11]
 [1.7681251e-11]
 [4.0199209e-11]
 [8.2635019e-12]
 [6.4651527e-11]
 [6.1676449e-11]
 [2.8143600e-11]
 [6.7116125e-11]
 [5.9698989e-11]
 [8.7200438e-12]
 [9.3514953e-12]
 [6.2315569e-11]
 [1.7157206e-11]
 [1.0516675e-11]
 [6.7129698e-11]
 [6.6404583e-11]
 [7.2847055e-11]
 [7.1495587e-11]
 [7.1451692e-11]
 [7.2209058e-11]
 [7.3897333e-11]
 [7.6746748e-11]
 [1.3712904e-11]
 [4.7693783e-11]
 [1.4800652e-11]
 [7.8960491e-11]
 [1.2291910e-11]
 [7.2826772e-11]]
[[1.36336472e-11]
 [3.67820045e-11]
 [9.38292239e-12]
 [2.30954301e-11]
 [1.07391639e-11]
 [8.69798417e-12]
 [8.19498896e-12]
 [8.69435166e-12]
 [1.76035193e-11]
 [9.41538948e-12]
 [7.73064598e-12]
 [8.47757194e-12]
 [6.69906630e-11]
 [1.01689213e-10]
 [7.83932121e-12]
 [7.62039477e-12]
 [8.39469032e-12]
 [1.76107393e-11]
 [1.14357482e-11]
 [7.34962698e-12]
 [1.05796882e-11]
 [7.97722912e-12]
 [2.13652915e-10]
 [1.55155958e-11]
 [8.92128472e-12]
 [5.09131869e-11]
 [8.13408455e-12]
 [8.85386816e-12]
 [4.44785632e-11]
 [1.08597029e-11]
 [9.90557809e-12]
 [5.35399607e-11]
 [2.73618662e-11]
 [1.13525352e-11]
 [1.18953345e-11]
 [1.59431184e-11]
 [6.18633061e-11]
 [1.54977316e-11]
 [1.58636160e-11]
 [2.51020992e-11]
 [5.21203601e-11]
 [1.04320337e-10]
 [2.15898913e-11]
 [2.37125902e-10]
 [2.21581451e-11]
 [2.15480619e-10]
 [3.53792690e-10]
 [4.23599766e-11]
 [3.16366655e-11]
 [3.15001671e-11]
 [1.13886289e-10]
 [2.12313167e-10]
 [6.33739658e-11]
 [4.82099138e-10]
 [1.08327319e-10]
 [5.39633789e-11]
 [7.19994953e-10]
 [4.56699206e-10]
 [3.45334178e-10]
 [1.00233224e-10]
 [1.62657027e-10]
 [9.90047044e-10]
 [6.82393031e-10]
 [5.22889620e-10]
 [1.03750886e-09]
 [1.37173384e-09]
 [4.07553991e-10]
 [1.69062453e-09]
 [2.39371217e-10]
 [5.71457437e-10]
 [2.43989651e-09]
 [1.24428889e-09]
 [1.68805003e-09]
 [1.32545863e-09]
 [9.05185038e-10]
 [4.40761072e-09]
 [5.61308333e-10]
 [5.54158719e-10]
 [1.74477977e-09]
 [6.52764287e-10]
 [5.79979564e-10]
 [5.36751887e-09]
 [6.20312646e-09]
 [6.00294592e-10]
 [2.97789970e-09]
 [6.19398710e-09]
 [1.09076670e-09]
 [6.34345854e-10]
 [6.48776144e-10]
 [6.26856289e-10]
 [6.79636680e-10]
 [7.03635650e-10]
 [7.30997152e-10]
 [8.13342671e-10]
 [8.58666649e-09]
 [2.56839772e-09]
 [7.45611395e-09]
 [9.48957024e-10]
 [1.00449018e-08]
 [2.20299334e-09]]
Softplus factor for those samples:
[1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06
 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06 1.e-06]

- 13022 expected decrease violations (out of 73719 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-635.61773682; mean=-283.83003237; max=0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 170 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=10.61012363; max=67.05379486
-- 88 hard violations (out of 111)
-- Stats. of [V_init_mean-1] (>0 is violation): min=-0.99313885; mean=13.95744801; max=59.31596375

- 46 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-38.34283447; mean=342.25518799; max=751.32141113
-- 11 hard violations (out of 22)
-- Stats. of [V_unsafe_mean-1/(1-p)] (<0 is violation): min=-30.59265137; mean=-5.26411390; max=6.63427734
Create dataset plot...

- Skip refinement, as there are still "hard" violations that cannot be fixed with refinement

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 1 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 986
- Init. samples: 13
- Unsafe samples: 16
- Target samples: 9
- Initializing iteration took 1.0879886150360107 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 1): 100%|█████████████████████████████████████████████████████████| 25/25 [00:11<00:00,  2.12it/s]
Number of times the learn.train_step function was compiled: 2

Loss components in last train step:
 - 0. total: 1.6142828
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0078945095
 - 6. expDecrease counterx: 1.6063883
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(5.197486, dtype=float32), Array([1., 1.], dtype=float32)), (Array(2.8039722, dtype=float32), Array([1.        , 0.95679873], dtype=float32)), (Array(9.839895, dtype=float32), Array([0.99999994], dtype=float32)), (Array(5.028569, dtype=float32), Array([1.        , 0.95679873], dtype=float32)), (Array(38.954094, dtype=float32), None), (Array(9.2325115, dtype=float32), None), (Array(34.024075, dtype=float32), None), (Array(27.603884, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2474.1345, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1171.5751, dtype=float32), Array([0.99999994, 0.75860596], dtype=float32)), (Array(3802.4146, dtype=float32), Array([1.], dtype=float32)), (Array(2162.1753, dtype=float32), Array([0.99999994, 0.75860596], dtype=float32)), (Array(19626.09, dtype=float32), None), (Array(2924.7834, dtype=float32), None), (Array(16581.19, dtype=float32), None), (Array(6783.1157, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 5463.961 (L1)
-- Lipschitz coefficient of certificate: 1171.575 (L1)
-- Lipschitz coefficient of policy: 2.804 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.04it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 73309
-- Number of factors below 0.75: 596
-- Number of factors below 0.5: 567
-- Number of factors below 0.25: 531
-- Number of factors below 0.1: 491
-- Number of factors below 0.05: 481
-- Number of factors below 0.01: 434
Most violating states:
[[ 0.215 -0.155  0.01 ]
 [ 0.215 -0.145  0.01 ]
 [ 0.225 -0.135  0.01 ]
 [ 0.205 -0.155  0.01 ]
 [ 0.215 -0.135  0.01 ]
 [ 0.205 -0.145  0.01 ]
 [ 0.215 -0.125  0.01 ]
 [ 0.205 -0.165  0.01 ]
 [ 0.205 -0.135  0.01 ]
 [ 0.215 -0.115  0.01 ]
 [ 0.205 -0.125  0.01 ]
 [ 0.205 -0.115  0.01 ]
 [ 0.215 -0.105  0.01 ]
 [ 0.205 -0.105  0.01 ]
 [ 0.215 -0.095  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.205  0.105  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.005  0.205  0.01 ]
 [-0.015  0.205  0.01 ]
 [-0.025  0.205  0.01 ]
 [-0.205  0.115  0.01 ]
 [-0.215  0.095  0.01 ]
 [-0.035  0.205  0.01 ]
 [ 0.005  0.205  0.01 ]
 [-0.045  0.205  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.055  0.205  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.065  0.205  0.01 ]
 [-0.025  0.215  0.01 ]]
Corresponding V values are:
[[3.11185382e-02]
 [4.66968725e-03]
 [1.25195207e-02]
 [2.31484929e-03]
 [7.50831387e-04]
 [3.41524050e-04]
 [1.36295173e-04]
 [1.81078836e-02]
 [5.26671720e-05]
 [2.38826487e-05]
 [9.94956554e-06]
 [1.85912074e-06]
 [4.67073460e-06]
 [3.39658271e-07]
 [9.62116587e-07]
 [6.60677486e-08]
 [1.50351571e-08]
 [3.60611874e-09]
 [1.02770459e-09]
 [4.06796791e-10]
 [1.91466468e-10]
 [9.21874868e-11]
 [1.79897999e-10]
 [4.50869980e-10]
 [4.74842873e-11]
 [7.15235510e-11]
 [2.47182084e-11]
 [3.15025679e-11]
 [1.29460120e-09]
 [1.52878734e-11]
 [1.26630260e-11]
 [6.87049549e-12]
 [8.84448331e-12]
 [3.67039168e-12]
 [6.92687791e-12]
 [2.10022407e-12]
 [1.17351018e-12]
 [5.81306834e-12]
 [6.72874300e-13]
 [4.97712169e-13]
 [5.44713302e-11]
 [6.37197055e-13]
 [8.91096641e-11]
 [3.40609034e-11]
 [2.11342992e-11]
 [1.33057645e-11]
 [5.14670806e-11]
 [3.36708265e-11]
 [1.51358759e-10]
 [8.72844678e-12]
 [2.20714644e-11]
 [8.15428280e-11]
 [1.48703185e-11]
 [6.25805614e-12]
 [1.20832355e-11]
 [5.19395247e-12]
 [5.23276257e-12]
 [1.20365870e-11]
 [5.52512766e-12]
 [1.26062017e-11]
 [5.84417454e-12]
 [4.18030367e-11]
 [6.24731083e-12]
 [3.40318745e-11]
 [1.30928393e-10]
 [1.29758374e-11]
 [2.26307471e-12]
 [6.79322397e-12]
 [3.26424755e-11]
 [1.37192610e-11]
 [6.20768853e-11]
 [7.42900359e-12]
 [6.04931730e-12]
 [1.48345676e-11]
 [1.02877038e-11]
 [3.20677616e-11]
 [2.55327925e-10]
 [1.68563219e-11]
 [9.53232215e-11]
 [1.53888638e-11]
 [3.22938863e-11]
 [2.06271791e-10]
 [3.57146569e-11]
 [2.40862278e-11]
 [2.58291704e-11]
 [1.45668616e-10]
 [3.74062968e-11]
 [1.08154319e-10]
 [1.19276256e-10]
 [1.39564610e-10]
 [4.23400481e-10]
 [3.29694938e-10]
 [1.69153982e-10]
 [9.59562152e-11]
 [2.06461112e-10]
 [3.85502220e-11]
 [2.37683789e-10]
 [2.20864257e-10]
 [2.69781919e-10]
 [1.98451380e-10]]
[[2.4870114e+00]
 [8.4483188e-01]
 [1.6739053e+00]
 [4.9929351e-01]
 [1.7222513e-01]
 [7.3149614e-02]
 [3.1078082e-02]
 [1.8510375e+00]
 [1.0821611e-02]
 [6.6327103e-03]
 [1.5656175e-03]
 [3.1555918e-04]
 [1.3892114e-03]
 [6.8896981e-05]
 [3.5455782e-04]
 [1.4964158e-05]
 [3.3677020e-06]
 [1.0242047e-06]
 [3.2484840e-07]
 [1.0073283e-07]
 [3.3131094e-08]
 [1.2619837e-08]
 [1.8278773e-07]
 [4.5948090e-07]
 [4.8558313e-09]
 [9.7841088e-08]
 [2.1250490e-09]
 [5.5740735e-08]
 [1.2303285e-06]
 [4.8894591e-08]
 [1.1452983e-09]
 [7.6954776e-10]
 [4.3468759e-08]
 [6.8073680e-10]
 [4.5659252e-08]
 [6.4873157e-10]
 [8.8309732e-10]
 [6.5608013e-08]
 [1.4505512e-09]
 [2.7873635e-09]
 [8.6322804e-10]
 [5.9674572e-09]
 [1.3214501e-09]
 [5.5547195e-10]
 [3.7241588e-10]
 [2.5281724e-10]
 [1.1313811e-09]
 [7.4664708e-10]
 [2.0215842e-09]
 [1.6885549e-10]
 [5.0812810e-10]
 [1.6902925e-09]
 [3.5017744e-10]
 [1.1392344e-10]
 [2.4638014e-10]
 [8.0122749e-11]
 [6.7752415e-11]
 [2.0546839e-10]
 [6.9586226e-11]
 [2.0162114e-10]
 [7.4189391e-11]
 [2.0167279e-09]
 [8.6155638e-11]
 [1.3139904e-09]
 [2.5882161e-09]
 [2.2969447e-10]
 [2.2658522e-08]
 [1.1466923e-10]
 [1.1499234e-09]
 [2.7812919e-10]
 [3.0516540e-09]
 [1.8539947e-10]
 [1.1431672e-07]
 [4.4011988e-10]
 [3.3065783e-10]
 [1.4738607e-09]
 [3.1359679e-09]
 [1.0895815e-09]
 [4.8400288e-09]
 [8.7559182e-10]
 [2.2723257e-09]
 [4.3306119e-09]
 [3.8621799e-09]
 [4.4419348e-09]
 [4.6728368e-09]
 [7.9961309e-09]
 [1.1929549e-08]
 [1.7139430e-09]
 [1.1005028e-09]
 [9.8883923e-10]
 [5.0485918e-09]
 [7.3817961e-09]
 [1.0010240e-09]
 [6.0629572e-09]
 [1.0459713e-09]
 [2.8622029e-08]
 [1.1913717e-09]
 [1.4638178e-08]
 [1.4591841e-09]
 [3.5074514e-09]]
Softplus factor for those samples:
[9.1684186e-01 5.7037044e-01 8.1248665e-01 3.9304066e-01 1.5821034e-01
 7.0538223e-02 3.0600131e-02 8.4292591e-01 1.0763347e-02 6.6107512e-03
 1.5643835e-03 3.1554699e-04 1.3882518e-03 6.8843365e-05 3.5452843e-04
 1.4901161e-05 3.3974648e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.2516975e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06]

- 12627 expected decrease violations (out of 73309 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-673.26434326; mean=-274.76849702; max=0.04484263
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 51 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.16116735; max=21.83819389
-- 0 hard violations (out of 15)

- 14 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-16.74133301; mean=355.53805542; max=800.54113770
-- 0 hard violations (out of 3)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 2 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 999
- Init. samples: 13
- Unsafe samples: 8
- Target samples: 4
- Initializing iteration took 0.8955156803131104 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 2): 100%|█████████████████████████████████████████████████████████| 25/25 [00:11<00:00,  2.14it/s]
Number of times the learn.train_step function was compiled: 3

Loss components in last train step:
 - 0. total: 0.593716
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.005872846
 - 6. expDecrease counterx: 0.5878432
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(5.197486, dtype=float32), Array([1., 1.], dtype=float32)), (Array(2.8039722, dtype=float32), Array([1.        , 0.95679873], dtype=float32)), (Array(9.839895, dtype=float32), Array([0.99999994], dtype=float32)), (Array(5.028569, dtype=float32), Array([1.        , 0.95679873], dtype=float32)), (Array(38.954094, dtype=float32), None), (Array(9.2325115, dtype=float32), None), (Array(34.024075, dtype=float32), None), (Array(27.603884, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2524.2507, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1178.961, dtype=float32), Array([1.      , 0.776746], dtype=float32)), (Array(3878.5298, dtype=float32), Array([1.], dtype=float32)), (Array(2182.94, dtype=float32), Array([1.      , 0.776746], dtype=float32)), (Array(19238.504, dtype=float32), None), (Array(2852.4524, dtype=float32), None), (Array(16822.244, dtype=float32), None), (Array(6657.5273, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 5498.407 (L1)
-- Lipschitz coefficient of certificate: 1178.961 (L1)
-- Lipschitz coefficient of policy: 2.804 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.08it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72782
-- Number of factors below 0.75: 457
-- Number of factors below 0.5: 431
-- Number of factors below 0.25: 393
-- Number of factors below 0.1: 362
-- Number of factors below 0.05: 349
-- Number of factors below 0.01: 300
Most violating states:
[[ 0.215 -0.125  0.01 ]
 [ 0.225 -0.115  0.01 ]
 [ 0.215 -0.135  0.01 ]
 [ 0.215 -0.115  0.01 ]
 [ 0.205 -0.135  0.01 ]
 [ 0.205 -0.125  0.01 ]
 [ 0.225 -0.105  0.01 ]
 [ 0.215 -0.105  0.01 ]
 [ 0.205 -0.115  0.01 ]
 [ 0.215 -0.095  0.01 ]
 [ 0.205 -0.105  0.01 ]
 [ 0.225 -0.085  0.01 ]
 [ 0.225 -0.095  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.225 -0.075  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.205  0.005  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.205 -0.015  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.205  0.105  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.025  0.205  0.01 ]
 [-0.035  0.205  0.01 ]
 [-0.015  0.205  0.01 ]]
Corresponding V values are:
[[1.0767423e-03]
 [2.5979441e-03]
 [7.7019287e-03]
 [1.7483145e-04]
 [6.1311101e-04]
 [8.4223364e-05]
 [4.2214128e-04]
 [2.9407865e-05]
 [1.3074096e-05]
 [4.9366809e-06]
 [2.3937641e-06]
 [1.4986138e-05]
 [8.1037506e-05]
 [9.7278394e-07]
 [2.7896642e-06]
 [4.1241373e-07]
 [1.9350139e-07]
 [6.4487159e-07]
 [7.4419667e-08]
 [3.8997264e-08]
 [1.6378948e-08]
 [1.6822517e-07]
 [9.6018740e-09]
 [4.3078501e-09]
 [2.6986646e-09]
 [1.4932977e-09]
 [5.7368478e-08]
 [1.0235515e-09]
 [6.3064348e-10]
 [3.8885067e-10]
 [2.9404382e-10]
 [1.6588889e-10]
 [1.4406439e-10]
 [8.0294549e-11]
 [7.0786745e-11]
 [1.8905419e-08]
 [3.8937669e-11]
 [3.7469423e-11]
 [2.5247303e-11]
 [1.9587082e-11]
 [1.6858942e-09]
 [3.0834653e-09]
 [1.8775018e-11]
 [9.0316560e-10]
 [1.0369994e-11]
 [1.3421063e-09]
 [4.8213411e-10]
 [7.6492351e-10]
 [4.3341467e-10]
 [5.6453748e-12]
 [2.7097216e-10]
 [2.3712423e-09]
 [1.6796724e-11]
 [2.4747895e-10]
 [5.6575851e-09]
 [1.5155029e-10]
 [3.1832338e-12]
 [1.4458851e-10]
 [8.6708571e-11]
 [8.4522445e-11]
 [1.8316141e-12]
 [5.1037931e-11]
 [6.1870856e-11]
 [1.8904930e-10]
 [2.8252417e-10]
 [1.7379494e-11]
 [3.2868513e-11]
 [1.4810896e-12]
 [5.8812691e-11]
 [2.6136478e-11]
 [1.6093168e-10]
 [5.8627665e-11]
 [4.7298915e-10]
 [2.6821588e-11]
 [1.8672050e-12]
 [2.8248631e-11]
 [5.9343870e-11]
 [2.9574117e-11]
 [7.1056071e-11]
 [3.5019664e-11]
 [1.5638696e-10]
 [4.6047673e-11]
 [5.8277362e-11]
 [8.9824662e-11]
 [7.9575534e-11]
 [1.0339460e-11]
 [2.3612881e-11]
 [8.0024737e-10]
 [1.6588700e-10]
 [4.3414796e-09]
 [1.3027598e-10]
 [1.2999576e-10]
 [2.2644761e-10]
 [4.6288685e-11]
 [1.4096898e-09]
 [1.0915228e-08]
 [2.7759231e-10]
 [4.0390162e-09]
 [5.0705946e-09]
 [3.2870553e-09]]
[[2.71914154e-01]
 [6.74092233e-01]
 [1.20739949e+00]
 [4.00768518e-02]
 [1.26735270e-01]
 [1.83969475e-02]
 [1.60198346e-01]
 [7.00037600e-03]
 [2.51896144e-03]
 [1.38870184e-03]
 [3.66642402e-04]
 [8.76645278e-03]
 [3.39656547e-02]
 [2.64794158e-04]
 [2.58436613e-03]
 [7.42175689e-05]
 [6.58853460e-05]
 [9.00530373e-04]
 [1.53374240e-05]
 [1.86624711e-05]
 [3.12693987e-06]
 [3.07286944e-04]
 [6.72534361e-06]
 [7.69706503e-07]
 [2.38436587e-06]
 [2.09664492e-07]
 [1.01206453e-04]
 [8.53815095e-07]
 [7.68571624e-08]
 [4.45755461e-07]
 [2.85789898e-08]
 [2.36384096e-07]
 [1.14838530e-08]
 [1.43343982e-07]
 [5.96280403e-09]
 [5.06040014e-05]
 [1.22512645e-07]
 [3.08693116e-09]
 [1.02726652e-07]
 [2.35430653e-09]
 [3.33348176e-08]
 [6.40183231e-08]
 [1.06475461e-07]
 [1.88419165e-08]
 [2.01426364e-09]
 [7.00098184e-08]
 [1.10514158e-08]
 [3.46152902e-08]
 [1.81736741e-08]
 [2.30760766e-09]
 [6.38721787e-09]
 [1.56570735e-07]
 [1.42938276e-07]
 [1.03863993e-08]
 [1.28058673e-07]
 [3.71645448e-09]
 [2.89432789e-09]
 [6.03036510e-09]
 [2.23189689e-09]
 [3.46607254e-09]
 [4.46185533e-09]
 [1.34765465e-09]
 [2.02517336e-09]
 [4.69088697e-08]
 [7.51087086e-08]
 [2.34177762e-07]
 [8.20359891e-10]
 [7.57363150e-09]
 [1.53360191e-09]
 [4.94336405e-10]
 [3.53306184e-08]
 [1.67347025e-09]
 [1.43319113e-07]
 [3.59739238e-10]
 [2.61697402e-08]
 [3.79722725e-10]
 [2.58054622e-09]
 [4.96186925e-10]
 [5.54825252e-09]
 [6.68273437e-10]
 [4.85802971e-08]
 [1.05938336e-09]
 [2.82851609e-09]
 [1.81576318e-08]
 [1.25956934e-08]
 [1.82919564e-07]
 [4.47739126e-07]
 [2.87145610e-07]
 [1.13317355e-07]
 [3.45418300e-07]
 [7.68798856e-08]
 [1.01610055e-07]
 [3.16362105e-07]
 [1.37812208e-06]
 [5.82753557e-07]
 [2.56748194e-07]
 [4.42746568e-07]
 [5.90396958e-08]
 [4.07221066e-08]
 [1.42595979e-07]]
Softplus factor for those samples:
[2.3808038e-01 4.9038118e-01 7.0102626e-01 3.9284408e-02 1.1903310e-01
 1.8228710e-02 1.4802516e-01 6.9759488e-03 2.5157928e-03 1.3877153e-03
 3.6650896e-04 8.7282062e-03 3.3395290e-02 2.6476383e-04 2.5809407e-03
 7.4267387e-05 6.5922737e-05 9.0014935e-04 1.5318394e-05 1.8656254e-05
 3.0994415e-06 3.0726194e-04 6.6757202e-06 1.0000000e-06 2.3245811e-06
 1.0000000e-06 1.0120869e-04 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 5.0544739e-05 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.3709068e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06]

- 12692 expected decrease violations (out of 72782 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-680.68835449; mean=-273.53340990; max=0.00659600
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 57 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.21563967; max=22.08762741
-- 0 hard violations (out of 14)

- 7 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-10.90899658; mean=368.32803345; max=815.07531738
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 3 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 1002
- Init. samples: 16
- Unsafe samples: 4
- Target samples: 2
- Initializing iteration took 0.34456896781921387 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 3): 100%|█████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 5

Loss components in last train step:
 - 0. total: 0.3509573
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0037575474
 - 6. expDecrease counterx: 0.34719977
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(2.389841, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1.1144015, dtype=float32), Array([1.       , 0.9999182], dtype=float32)), (Array(4.5956116, dtype=float32), Array([1.], dtype=float32)), (Array(2.2978997, dtype=float32), Array([1.       , 0.9999182], dtype=float32)), (Array(16.436892, dtype=float32), None), (Array(5.821233, dtype=float32), None), (Array(17.735615, dtype=float32), None), (Array(18.679565, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2542.2905, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1176.8876, dtype=float32), Array([0.99999994, 0.7925252 ], dtype=float32)), (Array(3910.2935, dtype=float32), Array([1.], dtype=float32)), (Array(2181.4443, dtype=float32), Array([0.99999994, 0.7925252 ], dtype=float32)), (Array(19045.72, dtype=float32), None), (Array(2879.6545, dtype=float32), None), (Array(16970.357, dtype=float32), None), (Array(6852.534, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 3599.724 (L1)
-- Lipschitz coefficient of certificate: 1176.888 (L1)
-- Lipschitz coefficient of policy: 1.114 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.06it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72493
-- Number of factors below 0.75: 364
-- Number of factors below 0.5: 333
-- Number of factors below 0.25: 305
-- Number of factors below 0.1: 279
-- Number of factors below 0.05: 261
-- Number of factors below 0.01: 222
Most violating states:
[[ 0.205 -0.055  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [ 0.225  0.045  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.045  0.205  0.01 ]
 [-0.035  0.205  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [-0.055  0.205  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.025  0.205  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.065  0.205  0.01 ]
 [ 0.225  0.055  0.01 ]
 [-0.075  0.205  0.01 ]
 [-0.205  0.105  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.085  0.205  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.015  0.205  0.01 ]
 [-0.095  0.205  0.01 ]]
Corresponding V values are:
[[1.85008175e-09]
 [8.50783943e-10]
 [4.17824886e-10]
 [2.08409678e-10]
 [1.10674997e-10]
 [5.79452909e-11]
 [3.08412081e-11]
 [1.67453499e-11]
 [9.72978555e-12]
 [9.58625540e-11]
 [5.68420614e-12]
 [1.94234004e-10]
 [3.54077184e-12]
 [5.40737281e-11]
 [3.45279794e-12]
 [1.52149238e-10]
 [1.05946973e-10]
 [8.16847978e-11]
 [2.44129161e-10]
 [8.34837338e-11]
 [3.42304934e-11]
 [4.87774057e-12]
 [1.00976789e-10]
 [4.12523293e-10]
 [1.68897674e-10]
 [1.35377765e-10]
 [1.68333583e-10]
 [2.13195364e-10]
 [3.03648565e-11]
 [1.69583306e-10]
 [3.80254689e-10]
 [7.81480047e-10]
 [2.04554956e-10]
 [3.59448443e-10]
 [3.16778444e-11]
 [2.29095909e-10]
 [2.80523993e-10]
 [6.58667398e-10]
 [1.49474810e-09]
 [2.52820959e-11]
 [4.25465392e-11]
 [8.23322521e-10]
 [4.45137438e-09]
 [1.19401744e-09]
 [6.22957241e-11]
 [2.87241209e-09]
 [4.40018327e-10]
 [4.08209827e-10]
 [2.21295315e-09]
 [5.32194788e-10]
 [4.97132335e-10]
 [5.56736568e-09]
 [7.35274674e-10]
 [1.17347340e-10]
 [2.09153672e-09]
 [4.21087654e-09]
 [7.60593866e-10]
 [1.35661138e-09]
 [1.13045182e-08]
 [1.09369791e-09]
 [8.08427814e-09]
 [2.65953815e-09]
 [1.24406108e-09]
 [6.60893562e-10]
 [1.56882374e-09]
 [1.27412498e-08]
 [2.27883294e-08]
 [6.66851185e-10]
 [8.47362014e-10]
 [5.58883606e-09]
 [6.69276079e-10]
 [1.09862996e-09]
 [4.71805206e-10]
 [1.56476627e-08]
 [8.16705037e-10]
 [2.06236472e-09]
 [5.18092902e-09]
 [1.28268796e-09]
 [4.49675781e-08]
 [6.24045100e-08]
 [5.37941069e-08]
 [4.68891637e-09]
 [4.25414681e-09]
 [7.78150593e-08]
 [4.71615635e-09]
 [3.06400842e-08]
 [9.87808502e-09]
 [4.48624640e-08]
 [2.28510491e-08]
 [1.04834506e-07]
 [2.20528884e-09]
 [1.47596495e-07]
 [9.08772080e-08]
 [8.22232238e-09]
 [5.33479998e-08]
 [8.73713812e-09]
 [1.97368863e-07]
 [1.97236485e-08]
 [4.30883844e-08]
 [2.51725567e-07]]
[[1.16599203e-07]
 [4.18911341e-08]
 [1.66966423e-08]
 [9.10558828e-09]
 [4.90818142e-09]
 [3.39794393e-09]
 [2.92269764e-09]
 [3.37945827e-09]
 [4.19379598e-09]
 [1.55629138e-07]
 [6.47621734e-09]
 [1.75940542e-07]
 [1.08347065e-08]
 [1.39548050e-07]
 [1.87068814e-08]
 [3.74370313e-09]
 [2.15466356e-09]
 [1.47242762e-09]
 [6.75434508e-09]
 [1.55380309e-09]
 [1.50901954e-07]
 [8.67488907e-08]
 [2.13816920e-09]
 [1.20272645e-08]
 [1.20215073e-08]
 [3.72446629e-09]
 [1.48406176e-08]
 [1.75382624e-08]
 [1.73171884e-07]
 [1.19157679e-08]
 [3.07800320e-07]
 [2.15530189e-08]
 [2.38406859e-08]
 [2.99878522e-08]
 [2.41918485e-07]
 [5.88787721e-08]
 [6.90437574e-08]
 [5.64608555e-08]
 [4.03380582e-08]
 [6.59348188e-07]
 [3.81857063e-07]
 [5.61401691e-07]
 [3.46320746e-07]
 [1.19663923e-07]
 [8.57385714e-07]
 [7.95261883e-08]
 [3.05409912e-07]
 [3.80597328e-07]
 [2.49678266e-07]
 [6.63106505e-07]
 [8.93435526e-07]
 [1.62454796e-07]
 [8.46048351e-07]
 [3.24629127e-06]
 [1.01577416e-06]
 [5.26916494e-07]
 [1.61749824e-06]
 [1.42548663e-06]
 [3.32641378e-07]
 [1.68444899e-06]
 [1.17198761e-06]
 [2.54066526e-06]
 [3.09771895e-06]
 [5.66809786e-06]
 [5.08252879e-06]
 [1.57683769e-06]
 [7.17566422e-07]
 [9.17387842e-06]
 [7.29140538e-06]
 [2.51525989e-06]
 [1.26549194e-05]
 [7.77523837e-06]
 [2.13450785e-05]
 [2.84181101e-06]
 [1.96092096e-05]
 [8.73653062e-06]
 [5.12119914e-06]
 [3.30986659e-05]
 [1.88066781e-06]
 [1.18484184e-06]
 [1.78323660e-06]
 [1.01277628e-05]
 [1.17140553e-05]
 [1.16998649e-06]
 [1.85289518e-05]
 [7.52658934e-06]
 [1.18709822e-05]
 [5.12253746e-06]
 [7.54905341e-06]
 [1.23386531e-06]
 [6.62522943e-05]
 [1.39937310e-06]
 [5.31827618e-06]
 [2.25338754e-05]
 [7.28098894e-06]
 [3.32251693e-05]
 [1.67912265e-06]
 [2.80801796e-05]
 [2.10964427e-05]
 [2.04124672e-06]]
Softplus factor for those samples:
[1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 3.2186508e-06 1.0000000e-06
 1.0000000e-06 1.6689301e-06 1.3709068e-06 1.0000000e-06 1.7285347e-06
 1.1920929e-06 2.5629997e-06 3.0994415e-06 5.6624413e-06 5.1259995e-06
 1.6093254e-06 1.0000000e-06 9.1791153e-06 7.3313713e-06 2.5629997e-06
 1.2636185e-05 7.8082085e-06 2.1338463e-05 2.9206276e-06 1.9609928e-05
 8.7022781e-06 5.1259995e-06 3.3080578e-05 1.8477440e-06 1.1920929e-06
 1.7881393e-06 1.0073185e-05 1.1742115e-05 1.1920929e-06 1.8596649e-05
 7.5101852e-06 1.1861324e-05 5.1259995e-06 7.5101852e-06 1.2516975e-06
 6.6220760e-05 1.3709068e-06 5.3048134e-06 2.2530556e-05 7.3313713e-06
 3.3199787e-05 1.6689301e-06 2.8133392e-05 2.1159649e-05 2.0861626e-06]

- 4640 expected decrease violations (out of 72493 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-522.33129883; mean=-202.34726900; max=0.00000001
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 70 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.38819715; max=21.08152008
-- 0 hard violations (out of 18)

- 9 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-17.27081299; mean=373.65408325; max=818.73901367
-- 0 hard violations (out of 2)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 4 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 989
- Init. samples: 31
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.5684852600097656 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 4): 100%|█████████████████████████████████████████████████████████| 25/25 [00:16<00:00,  1.55it/s]
Number of times the learn.train_step function was compiled: 6

Loss components in last train step:
 - 0. total: 0.5458055
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0054891272
 - 6. expDecrease counterx: 0.5403164
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.7513903, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.33055344, dtype=float32), Array([1.        , 0.99983585], dtype=float32)), (Array(1.5100977, dtype=float32), Array([1.], dtype=float32)), (Array(0.75511074, dtype=float32), Array([1.        , 0.99983585], dtype=float32)), (Array(5.226704, dtype=float32), None), (Array(3.112726, dtype=float32), None), (Array(6.745003, dtype=float32), None), (Array(10.587711, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2548.9111, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1172.1637, dtype=float32), Array([1.      , 0.807878], dtype=float32)), (Array(3945.0432, dtype=float32), Array([1.], dtype=float32)), (Array(2182.1401, dtype=float32), Array([1.      , 0.807878], dtype=float32)), (Array(18962.54, dtype=float32), None), (Array(3029.4597, dtype=float32), None), (Array(17140.033, dtype=float32), None), (Array(7195.585, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2712.417 (L1)
-- Lipschitz coefficient of certificate: 1172.164 (L1)
-- Lipschitz coefficient of policy: 0.331 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.08it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72445
-- Number of factors below 0.75: 299
-- Number of factors below 0.5: 272
-- Number of factors below 0.25: 248
-- Number of factors below 0.1: 222
-- Number of factors below 0.05: 210
-- Number of factors below 0.01: 181
Most violating states:
[[ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.205 -0.045  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.225 -0.025  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.235 -0.005  0.01 ]
 [-0.235 -0.015  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.005  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [-0.235 -0.025  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.225  0.045  0.01 ]
 [-0.235  0.005  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.235 -0.035  0.01 ]
 [-0.205  0.105  0.01 ]
 [ 0.205  0.095  0.01 ]
 [ 0.225  0.055  0.01 ]
 [-0.215 -0.085  0.01 ]]
Corresponding V values are:
[[5.01671094e-10]
 [1.04240627e-09]
 [2.38690984e-10]
 [1.23539901e-10]
 [2.17375895e-09]
 [6.59894361e-11]
 [3.81660502e-11]
 [2.14251561e-10]
 [1.67543687e-10]
 [1.24983759e-10]
 [3.70745379e-10]
 [1.19382546e-10]
 [2.30350704e-11]
 [3.21760396e-10]
 [1.60487207e-10]
 [2.43446097e-10]
 [1.58121710e-11]
 [2.36511588e-10]
 [6.98819391e-10]
 [4.56490179e-10]
 [2.13185206e-10]
 [1.38088881e-11]
 [2.75655443e-10]
 [3.05579367e-10]
 [1.72712712e-11]
 [8.55886417e-10]
 [1.38904221e-09]
 [2.99609330e-11]
 [4.10956574e-10]
 [3.77168907e-10]
 [1.73458314e-09]
 [5.26505728e-09]
 [2.84826540e-09]
 [8.65403721e-11]
 [3.51333673e-09]
 [8.58053906e-10]
 [6.04507888e-10]
 [6.42561948e-10]
 [5.86502047e-09]
 [2.59395755e-10]
 [5.55101243e-10]
 [1.69388378e-10]
 [4.52875515e-10]
 [1.68609918e-10]
 [1.33740696e-09]
 [6.73024247e-10]
 [1.92139971e-10]
 [7.14782100e-09]
 [9.01742125e-10]
 [2.26129948e-10]
 [8.85196860e-10]
 [2.45858245e-09]
 [1.28367255e-08]
 [2.83413071e-10]
 [1.98475325e-09]
 [1.47989532e-08]
 [1.34577771e-08]
 [3.92366417e-10]
 [1.42635304e-09]
 [4.55482407e-09]
 [1.72932735e-09]
 [9.50353574e-10]
 [2.78527086e-08]
 [6.45836495e-10]
 [4.33098402e-09]
 [2.02945771e-09]
 [9.46600132e-09]
 [3.07102930e-08]
 [1.26128041e-09]
 [5.95560081e-08]
 [1.17738006e-08]
 [4.77065676e-09]
 [5.77316683e-09]
 [1.99690149e-08]
 [6.52325554e-08]
 [4.06228082e-08]
 [1.26121890e-07]
 [8.07432343e-09]
 [7.03574266e-09]
 [4.95804020e-09]
 [4.79077222e-09]
 [4.94062302e-09]
 [1.31057956e-08]
 [5.41938627e-09]
 [8.12990919e-09]
 [4.26969180e-08]
 [5.12859728e-08]
 [5.68881386e-09]
 [7.45422302e-09]
 [1.49104636e-07]
 [7.95578625e-09]
 [1.26075914e-08]
 [1.15668826e-08]
 [1.11630403e-08]
 [1.90484624e-08]
 [1.54979034e-08]
 [2.69826302e-07]
 [1.29810562e-08]
 [1.08699156e-08]
 [2.94755012e-08]]
[[3.55593244e-08]
 [6.10797244e-08]
 [3.11009387e-08]
 [2.93650650e-08]
 [1.36621267e-07]
 [3.07013330e-08]
 [3.22773097e-08]
 [5.60125812e-09]
 [3.23280624e-09]
 [2.75467937e-09]
 [9.88170257e-09]
 [2.83927770e-09]
 [4.00919902e-08]
 [1.57880269e-08]
 [3.34044326e-09]
 [1.49181236e-08]
 [5.36718368e-08]
 [1.76144610e-08]
 [1.77963138e-08]
 [2.68825247e-08]
 [5.73198822e-09]
 [8.10110663e-08]
 [1.59517821e-08]
 [2.40164439e-08]
 [1.18662626e-07]
 [4.87379808e-08]
 [3.38964057e-08]
 [1.93996939e-07]
 [6.95600590e-08]
 [7.55699787e-08]
 [8.59901164e-08]
 [2.84298693e-07]
 [6.44000622e-08]
 [7.02544241e-07]
 [1.59716237e-07]
 [5.39256575e-07]
 [5.46344722e-07]
 [2.96009517e-07]
 [1.28489646e-07]
 [1.27757130e-06]
 [7.49794651e-07]
 [1.25346082e-06]
 [1.35079551e-06]
 [1.28002148e-06]
 [8.73404360e-07]
 [4.47157959e-07]
 [1.36321125e-06]
 [3.52999450e-07]
 [1.65394647e-06]
 [1.67100279e-06]
 [1.05957326e-06]
 [1.64020219e-06]
 [2.72584941e-07]
 [2.35591324e-06]
 [2.27128226e-06]
 [7.94585731e-07]
 [8.05697482e-07]
 [3.76971548e-06]
 [1.62800472e-06]
 [3.21785069e-06]
 [3.07078176e-06]
 [3.93087839e-06]
 [5.93698417e-07]
 [6.63705987e-06]
 [4.37416747e-06]
 [3.69502982e-06]
 [6.11314636e-06]
 [1.99048077e-06]
 [2.46267318e-05]
 [1.41027317e-06]
 [8.95913581e-06]
 [1.14489103e-05]
 [9.90595618e-06]
 [1.21879484e-05]
 [5.76344883e-06]
 [3.95641882e-06]
 [3.78794653e-06]
 [5.07523655e-05]
 [4.65169396e-05]
 [6.52966264e-05]
 [7.23557678e-05]
 [6.53824900e-05]
 [3.15585166e-05]
 [6.84307524e-05]
 [6.15521058e-05]
 [2.90739663e-05]
 [1.86373236e-05]
 [8.47424308e-05]
 [6.69354267e-05]
 [1.73297594e-05]
 [1.12738460e-04]
 [8.11701466e-05]
 [1.13222974e-04]
 [8.38308770e-05]
 [5.32636404e-05]
 [9.58935416e-05]
 [1.28708007e-05]
 [9.61217957e-05]
 [1.73765875e-04]
 [7.63329517e-05]]
Softplus factor for those samples:
[9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 1.31130219e-06
 9.99999997e-07 1.25169754e-06 1.31130219e-06 1.31130219e-06
 9.99999997e-07 9.99999997e-07 1.37090683e-06 9.99999997e-07
 1.66893005e-06 1.66893005e-06 1.01327896e-06 1.66893005e-06
 9.99999997e-07 2.32458115e-06 2.26497650e-06 9.99999997e-07
 9.99999997e-07 3.81469727e-06 1.66893005e-06 3.15904617e-06
 3.03983688e-06 3.93390656e-06 9.99999997e-07 6.61611557e-06
 4.35113907e-06 3.75509262e-06 6.07967377e-06 2.02655792e-06
 2.46763229e-05 1.37090683e-06 9.00030136e-06 1.13844872e-05
 9.95397568e-06 1.21593475e-05 5.72204590e-06 3.93390656e-06
 3.81469727e-06 5.07831573e-05 4.64916229e-05 6.52670860e-05
 7.23004341e-05 6.53266907e-05 3.15904617e-05 6.83665276e-05
 6.15715981e-05 2.90870667e-05 1.86562538e-05 8.47578049e-05
 6.69360161e-05 1.73449516e-05 1.12712383e-04 8.11815262e-05
 1.13189220e-04 8.38637352e-05 5.33461571e-05 9.59634781e-05
 1.29342079e-05 9.60826874e-05 1.73807144e-04 7.63535500e-05]

- 4375 expected decrease violations (out of 72445 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-164.96392822; mean=-80.15457507; max=0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 66 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.17196783; max=16.87065887
-- 0 hard violations (out of 15)

- 13 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-16.90765381; mean=370.80541992; max=827.23083496
-- 0 hard violations (out of 2)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 5 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 980
- Init. samples: 40
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.6139707565307617 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 5): 100%|█████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.59it/s]
Number of times the learn.train_step function was compiled: 7

Loss components in last train step:
 - 0. total: 0.60857135
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0039055436
 - 6. expDecrease counterx: 0.6046658
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.30247918, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.13177896, dtype=float32), Array([1.        , 0.99946624], dtype=float32)), (Array(0.5951682, dtype=float32), Array([1.], dtype=float32)), (Array(0.29766354, dtype=float32), Array([1.        , 0.99946624], dtype=float32)), (Array(2.2295587, dtype=float32), None), (Array(2.121548, dtype=float32), None), (Array(3.0120044, dtype=float32), None), (Array(7.362277, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2602.4355, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1197.5133, dtype=float32), Array([1.       , 0.8148047], dtype=float32)), (Array(4012.1157, dtype=float32), Array([1.], dtype=float32)), (Array(2210.77, dtype=float32), Array([1.       , 0.8148047], dtype=float32)), (Array(19164.375, dtype=float32), None), (Array(3346.3848, dtype=float32), None), (Array(17403.48, dtype=float32), None), (Array(8112.9746, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2544.943 (L1)
-- Lipschitz coefficient of certificate: 1197.513 (L1)
-- Lipschitz coefficient of policy: 0.132 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.09it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71627
-- Number of factors below 0.75: 257
-- Number of factors below 0.5: 225
-- Number of factors below 0.25: 210
-- Number of factors below 0.1: 191
-- Number of factors below 0.05: 182
-- Number of factors below 0.01: 151
Most violating states:
[[-0.215 -0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215  0.015  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.225  0.025  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.235 -0.015  0.01 ]
 [-0.235 -0.025  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.235 -0.005  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.235 -0.035  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.235  0.005  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [-0.235 -0.045  0.01 ]
 [ 0.225  0.025  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [-0.235  0.015  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225  0.035  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]]
Corresponding V values are:
[[5.17887178e-10]
 [5.83663895e-10]
 [3.41134537e-10]
 [2.92310870e-10]
 [2.40798076e-10]
 [1.00685860e-09]
 [1.25115718e-09]
 [4.19213886e-10]
 [1.61836336e-10]
 [1.77972789e-10]
 [7.11542991e-10]
 [1.56752195e-10]
 [3.50676072e-10]
 [2.38558978e-10]
 [3.19823862e-10]
 [8.86483942e-11]
 [4.45992993e-10]
 [1.43693690e-09]
 [4.23534541e-10]
 [2.76687517e-09]
 [5.27728729e-11]
 [1.95384087e-09]
 [3.56022295e-11]
 [3.01201043e-11]
 [1.47430490e-09]
 [6.10263284e-10]
 [8.31846314e-10]
 [5.98680050e-10]
 [3.47937582e-11]
 [3.21820104e-09]
 [5.76638147e-11]
 [7.67021446e-10]
 [3.83177357e-09]
 [3.02256264e-09]
 [6.38724229e-09]
 [8.84226581e-10]
 [1.21718122e-10]
 [8.95494678e-10]
 [1.13309140e-09]
 [7.21219973e-09]
 [8.31500824e-09]
 [6.90514534e-10]
 [6.08021189e-09]
 [1.51573563e-08]
 [1.62831881e-09]
 [4.08142853e-10]
 [9.82012693e-10]
 [4.06925604e-10]
 [5.71316827e-10]
 [1.67424687e-08]
 [1.98277816e-09]
 [2.01277350e-09]
 [4.54204285e-10]
 [1.89878850e-08]
 [5.13341702e-10]
 [2.03516759e-09]
 [4.27156310e-09]
 [6.13925688e-10]
 [1.20484573e-08]
 [8.42840631e-10]
 [3.88814740e-08]
 [4.26887787e-08]
 [1.07456550e-08]
 [1.26364019e-09]
 [4.62720484e-09]
 [4.26846825e-09]
 [2.40375257e-08]
 [2.21597340e-09]
 [3.73981521e-08]
 [4.91140284e-09]
 [8.85521985e-08]
 [6.15924511e-09]
 [6.95067071e-09]
 [9.92314710e-08]
 [1.02718580e-08]
 [7.93534216e-09]
 [3.81753580e-08]
 [5.32125348e-08]
 [1.27271385e-08]
 [1.24176927e-08]
 [1.48657469e-08]
 [1.90225833e-07]
 [2.03561132e-08]
 [1.98895318e-08]
 [2.31439131e-07]
 [1.30573582e-07]
 [1.10930403e-08]
 [1.04484119e-08]
 [1.15737677e-08]
 [2.43160940e-08]
 [1.25587505e-08]
 [1.29639389e-07]
 [1.19843975e-08]
 [4.48969644e-08]
 [1.31465541e-08]
 [1.72746901e-08]
 [4.21094455e-07]
 [1.82843092e-08]
 [5.66794576e-08]
 [1.97622384e-07]]
[[3.14053636e-08]
 [8.40941823e-08]
 [2.30416948e-08]
 [8.30686488e-08]
 [6.81224321e-09]
 [5.34592246e-08]
 [8.33816856e-08]
 [1.23006760e-08]
 [4.72996620e-09]
 [3.95128863e-09]
 [2.41882869e-08]
 [8.27118214e-08]
 [1.80787012e-08]
 [4.38340697e-09]
 [6.61199007e-09]
 [8.54109814e-08]
 [2.24604619e-08]
 [4.49110082e-08]
 [1.48943835e-08]
 [1.11775329e-07]
 [1.04354712e-07]
 [1.05234378e-07]
 [1.32619576e-07]
 [1.91025009e-07]
 [8.69697374e-07]
 [5.68774254e-08]
 [7.26139831e-07]
 [4.92123249e-08]
 [2.71565483e-07]
 [8.29060909e-08]
 [3.66815357e-07]
 [5.73702380e-07]
 [2.12769123e-07]
 [1.36356630e-06]
 [1.89279035e-07]
 [1.87184526e-07]
 [5.52928270e-07]
 [2.72215289e-07]
 [7.13181123e-07]
 [1.67785359e-07]
 [4.27059717e-07]
 [1.02453691e-06]
 [2.72445732e-06]
 [5.41520023e-07]
 [8.89733428e-07]
 [3.21121388e-06]
 [3.74010438e-06]
 [3.22390201e-06]
 [3.41181158e-06]
 [3.51441230e-07]
 [1.66173788e-06]
 [3.73480816e-06]
 [3.30838407e-06]
 [8.64411845e-07]
 [3.91155572e-06]
 [2.39694418e-06]
 [4.48776018e-06]
 [5.46544379e-06]
 [6.11529231e-06]
 [7.55271139e-06]
 [8.01090493e-07]
 [2.11402539e-06]
 [6.29940723e-06]
 [1.05336358e-05]
 [4.90629554e-06]
 [5.64619359e-06]
 [1.35118989e-05]
 [1.60606214e-05]
 [2.56438489e-06]
 [1.08569848e-05]
 [2.06152822e-06]
 [6.12041913e-05]
 [4.63951947e-05]
 [6.07338779e-06]
 [7.69672843e-05]
 [2.72866091e-05]
 [1.14664044e-05]
 [3.02269309e-05]
 [2.10489761e-05]
 [5.09926140e-05]
 [2.43578452e-05]
 [6.08247638e-06]
 [1.10772577e-04]
 [4.59349540e-05]
 [1.95250504e-05]
 [1.61424032e-05]
 [1.54638590e-04]
 [1.65393096e-04]
 [1.60462267e-04]
 [1.10809131e-04]
 [1.78269343e-04]
 [7.08618609e-05]
 [1.74090965e-04]
 [2.15578082e-04]
 [1.88435937e-04]
 [2.00514914e-04]
 [2.27511900e-05]
 [1.96607929e-04]
 [1.20330136e-04]
 [3.36002086e-05]]
Softplus factor for those samples:
[9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 1.37090683e-06 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 2.68220901e-06 9.99999997e-07
 9.99999997e-07 3.15904617e-06 3.81469727e-06 3.15904617e-06
 3.45706940e-06 9.99999997e-07 1.66893005e-06 3.75509262e-06
 3.33786011e-06 9.99999997e-07 3.93390656e-06 2.44379044e-06
 4.47034836e-06 5.54323196e-06 6.07967377e-06 7.51018524e-06
 9.99999997e-07 2.14576721e-06 6.25848770e-06 1.04904175e-05
 4.88758087e-06 5.66244125e-06 1.35302544e-05 1.60932541e-05
 2.56299973e-06 1.08480453e-05 2.08616257e-06 6.12139702e-05
 4.64320183e-05 6.07967377e-06 7.69495964e-05 2.72989273e-05
 1.14440918e-05 3.02791595e-05 2.09808350e-05 5.09619713e-05
 2.43782997e-05 6.07967377e-06 1.10805035e-04 4.59551811e-05
 1.95503235e-05 1.61528587e-05 1.54674053e-04 1.65343285e-04
 1.60455704e-04 1.10805035e-04 1.78277493e-04 7.08699226e-05
 1.74045563e-04 2.15590000e-04 1.88350677e-04 2.00450420e-04
 2.27093697e-05 1.96576118e-04 1.20341778e-04 3.35574150e-05]

- 7018 expected decrease violations (out of 71627 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-110.85180664; mean=-53.66348997; max=0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 68 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.12743059; max=16.25953102
-- 0 hard violations (out of 15)

- 8 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-17.04046631; mean=388.49163818; max=860.14636230
-- 0 hard violations (out of 2)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 6 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 986
- Init. samples: 34
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.3227674961090088 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 6): 100%|█████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.71it/s]
Number of times the learn.train_step function was compiled: 8

Loss components in last train step:
 - 0. total: 0.43170205
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0035511488
 - 6. expDecrease counterx: 0.4281509
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.26872286, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11761945, dtype=float32), Array([0.99999994, 0.999048  ], dtype=float32)), (Array(0.49952304, dtype=float32), Array([1.], dtype=float32)), (Array(0.24988046, dtype=float32), Array([0.99999994, 0.999048  ], dtype=float32)), (Array(2.0076451, dtype=float32), None), (Array(2.0279596, dtype=float32), None), (Array(2.6266577, dtype=float32), None), (Array(6.9909096, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2641.3699, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1206.789, dtype=float32), Array([1.       , 0.8139759], dtype=float32)), (Array(4075.1616, dtype=float32), Array([1.], dtype=float32)), (Array(2246.536, dtype=float32), Array([1.       , 0.8139759], dtype=float32)), (Array(19268.686, dtype=float32), None), (Array(3670.3884, dtype=float32), None), (Array(17602.543, dtype=float32), None), (Array(9254.178, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2548.423 (L1)
-- Lipschitz coefficient of certificate: 1206.789 (L1)
-- Lipschitz coefficient of policy: 0.118 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.10it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70591
-- Number of factors below 0.75: 216
-- Number of factors below 0.5: 202
-- Number of factors below 0.25: 190
-- Number of factors below 0.1: 170
-- Number of factors below 0.05: 150
-- Number of factors below 0.01: 129
Most violating states:
[[-0.215 -0.005  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.225  0.025  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.235 -0.025  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.235 -0.015  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.235 -0.035  0.01 ]
 [-0.235 -0.005  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.235  0.005  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.235 -0.045  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.235  0.015  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [-0.205  0.105  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [-0.235  0.025  0.01 ]]
Corresponding V values are:
[[7.72993058e-10]
 [6.03360584e-10]
 [5.16801768e-10]
 [3.45199175e-10]
 [2.38603137e-10]
 [2.45286680e-10]
 [1.39636580e-09]
 [1.05856734e-09]
 [4.95375574e-10]
 [3.38173933e-10]
 [4.72645534e-10]
 [1.00241304e-09]
 [5.35610278e-10]
 [1.97632932e-09]
 [2.13801821e-09]
 [6.49893250e-10]
 [6.62213451e-10]
 [2.81416423e-09]
 [2.99828440e-10]
 [1.82452012e-10]
 [4.74085926e-09]
 [4.17500878e-09]
 [1.25404021e-10]
 [9.41967282e-10]
 [9.74692105e-10]
 [1.10011826e-10]
 [5.50907808e-09]
 [1.20765134e-10]
 [1.49388085e-10]
 [1.14178293e-08]
 [9.49390078e-09]
 [1.30220412e-09]
 [1.41991718e-09]
 [1.59152436e-09]
 [2.37013897e-09]
 [2.71829920e-10]
 [1.09010383e-08]
 [1.87103333e-09]
 [2.03897521e-09]
 [4.33791225e-09]
 [5.66433067e-10]
 [2.28476082e-08]
 [2.33707365e-08]
 [8.81631923e-09]
 [3.61349950e-09]
 [2.85277268e-09]
 [3.01373326e-08]
 [4.38814185e-09]
 [5.25290247e-08]
 [4.74058748e-09]
 [5.51425288e-08]
 [1.79541342e-08]
 [1.92583638e-09]
 [1.55067659e-09]
 [1.77277681e-09]
 [1.65227099e-09]
 [2.41647080e-09]
 [4.25804370e-09]
 [2.26841523e-09]
 [8.62565219e-09]
 [1.18245545e-07]
 [2.94436830e-09]
 [1.15247323e-08]
 [1.13846008e-08]
 [3.62238275e-08]
 [2.23267307e-08]
 [1.32822464e-07]
 [4.13051815e-09]
 [8.92610217e-08]
 [5.81596060e-09]
 [2.25123582e-08]
 [2.53407762e-07]
 [1.86690965e-08]
 [1.07452243e-08]
 [7.32288754e-08]
 [2.80491630e-08]
 [1.81957329e-08]
 [1.00265304e-07]
 [4.11263592e-08]
 [3.15184337e-07]
 [2.96530676e-08]
 [2.55404675e-08]
 [2.66258500e-08]
 [4.64844661e-08]
 [4.23320969e-08]
 [1.59682259e-07]
 [5.84898260e-07]
 [6.64720972e-08]
 [3.91154572e-07]
 [8.27642097e-08]
 [7.51682649e-07]
 [4.29163549e-07]
 [1.66876234e-07]
 [1.95446532e-07]
 [5.98910390e-07]
 [6.26995629e-08]
 [6.09594935e-08]
 [1.45687704e-06]
 [6.46089688e-08]
 [1.88688617e-07]]
[[8.5900780e-08]
 [1.9765187e-08]
 [6.3967917e-08]
 [1.2458688e-08]
 [8.6653102e-09]
 [6.6517600e-09]
 [1.2427508e-07]
 [3.4534771e-08]
 [4.8034746e-08]
 [7.3101005e-09]
 [1.2770057e-08]
 [4.1586321e-07]
 [4.2071389e-07]
 [6.6747539e-08]
 [4.1260176e-07]
 [5.9696802e-08]
 [3.3453290e-08]
 [1.9871946e-07]
 [4.2966974e-07]
 [4.3856267e-07]
 [4.9099361e-07]
 [1.2572296e-07]
 [4.8947044e-07]
 [1.4335711e-07]
 [1.1933764e-07]
 [6.6760288e-07]
 [3.8717198e-07]
 [9.8752082e-07]
 [1.4424961e-06]
 [6.5241528e-07]
 [2.3264229e-07]
 [2.1680005e-06]
 [2.6735404e-06]
 [5.1375321e-07]
 [3.2375449e-06]
 [2.0302371e-06]
 [8.2427641e-07]
 [5.2638416e-07]
 [2.3252728e-06]
 [4.2384240e-06]
 [2.8105922e-06]
 [4.7629234e-07]
 [1.7363851e-06]
 [6.5966110e-06]
 [2.0321083e-06]
 [4.9672640e-06]
 [1.6822032e-06]
 [4.1661488e-06]
 [1.1221473e-06]
 [4.9195646e-06]
 [3.5609964e-06]
 [1.2574090e-05]
 [2.2112563e-05]
 [2.0640951e-05]
 [2.1900973e-05]
 [2.0349473e-05]
 [2.3158398e-05]
 [2.3503220e-05]
 [2.6575459e-05]
 [2.4997085e-05]
 [2.9855032e-06]
 [3.2368051e-05]
 [1.1161728e-05]
 [1.2356102e-05]
 [2.8861799e-05]
 [3.0427938e-05]
 [8.3216437e-06]
 [4.6013873e-05]
 [9.0016320e-06]
 [6.4824344e-05]
 [3.5787292e-05]
 [9.9426688e-06]
 [1.7431189e-04]
 [9.5124917e-05]
 [6.6663168e-05]
 [4.8422302e-05]
 [2.2357046e-04]
 [4.5577799e-05]
 [5.2557541e-05]
 [2.8266482e-05]
 [1.6074101e-04]
 [2.8430484e-04]
 [1.5117440e-04]
 [9.3021816e-05]
 [3.6961882e-04]
 [1.5350069e-04]
 [3.8901770e-05]
 [2.5902825e-04]
 [7.6006014e-05]
 [5.9030671e-04]
 [1.4143188e-04]
 [3.5318016e-04]
 [2.8139818e-04]
 [6.0311035e-04]
 [1.2479126e-04]
 [1.2379537e-03]
 [1.3676949e-03]
 [1.6585950e-04]
 [1.2354379e-03]
 [1.0593629e-03]]
Softplus factor for those samples:
[1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.4305115e-06 1.0000000e-06
 1.0000000e-06 2.1457672e-06 2.6822090e-06 1.0000000e-06 3.1590462e-06
 2.0861626e-06 1.0000000e-06 1.0000000e-06 2.2649765e-06 4.2915344e-06
 2.7418137e-06 1.0000000e-06 1.7285347e-06 6.5565109e-06 2.0861626e-06
 4.8875809e-06 1.6689301e-06 4.2319298e-06 1.1920929e-06 4.8875809e-06
 3.5166740e-06 1.2576580e-05 2.2113323e-05 2.0563602e-05 2.1874905e-05
 2.0384789e-05 2.3126602e-05 2.3484230e-05 2.6583672e-05 2.5033951e-05
 2.9802322e-06 3.2305717e-05 1.1205673e-05 1.2278557e-05 2.8789043e-05
 3.0398369e-05 8.2850456e-06 4.6014786e-05 9.0599060e-06 6.4790249e-05
 3.5762787e-05 9.9539757e-06 1.7428398e-04 9.5129013e-05 6.6637993e-05
 4.8398972e-05 2.2351742e-04 4.5597553e-05 5.2571297e-05 2.8252602e-05
 1.6075373e-04 2.8425455e-04 1.5121698e-04 9.3042850e-05 3.6948919e-04
 1.5348196e-04 3.8862228e-05 2.5904179e-04 7.5995922e-05 5.9008598e-04
 1.4138222e-04 3.5303831e-04 2.8133392e-04 6.0284138e-04 1.2475252e-04
 1.2371540e-03 1.3667941e-03 1.6587973e-04 1.2346506e-03 1.0588169e-03]

- 6587 expected decrease violations (out of 70591 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-116.27429199; mean=-55.53143848; max=0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 80 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.53878492; max=19.08434296
-- 0 hard violations (out of 27)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=22.30474854; mean=417.83956909; max=893.00939941
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 7 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 985
- Init. samples: 35
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.5966796875 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 7): 100%|█████████████████████████████████████████████████████████| 25/25 [00:16<00:00,  1.56it/s]
Number of times the learn.train_step function was compiled: 9

Loss components in last train step:
 - 0. total: 0.47550458
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0032098796
 - 6. expDecrease counterx: 0.4722947
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.25873932, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11312477, dtype=float32), Array([1.0000001 , 0.99992484], dtype=float32)), (Array(0.45813188, dtype=float32), Array([0.99999994], dtype=float32)), (Array(0.22907455, dtype=float32), Array([1.0000001 , 0.99992484], dtype=float32)), (Array(1.9632996, dtype=float32), None), (Array(1.9966539, dtype=float32), None), (Array(2.4972155, dtype=float32), None), (Array(6.8454266, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2609.8164, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1180.4058, dtype=float32), Array([0.99999994, 0.8214989 ], dtype=float32)), (Array(4033.1975, dtype=float32), Array([1.], dtype=float32)), (Array(2214.2192, dtype=float32), Array([0.99999994, 0.8214989 ], dtype=float32)), (Array(18928.662, dtype=float32), None), (Array(4130.866, dtype=float32), None), (Array(17451.312, dtype=float32), None), (Array(10970.759, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2487.668 (L1)
-- Lipschitz coefficient of certificate: 1180.406 (L1)
-- Lipschitz coefficient of policy: 0.113 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.09it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71225
-- Number of factors below 0.75: 201
-- Number of factors below 0.5: 190
-- Number of factors below 0.25: 178
-- Number of factors below 0.1: 152
-- Number of factors below 0.05: 144
-- Number of factors below 0.01: 129
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.025  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.235 -0.035  0.01 ]
 [-0.235 -0.025  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.235 -0.015  0.01 ]
 [-0.235 -0.045  0.01 ]
 [-0.235 -0.005  0.01 ]
 [-0.225 -0.075  0.01 ]
 [-0.235  0.005  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [-0.225  0.065  0.01 ]]
Corresponding V values are:
[[9.41096312e-10]
 [4.93175167e-10]
 [6.03197214e-10]
 [1.52270374e-09]
 [6.03650685e-10]
 [1.35299372e-09]
 [1.02411579e-09]
 [2.10401629e-09]
 [2.59786548e-09]
 [8.51891335e-10]
 [1.12443010e-09]
 [3.60448915e-09]
 [1.25733646e-09]
 [4.84544183e-09]
 [1.48968193e-09]
 [2.79617618e-09]
 [8.52491133e-10]
 [5.86201221e-09]
 [6.79072132e-09]
 [5.11326648e-10]
 [1.68764758e-09]
 [1.02230526e-08]
 [3.59078406e-10]
 [1.95015870e-09]
 [3.26198402e-10]
 [1.28271793e-08]
 [3.76649878e-10]
 [1.29795952e-08]
 [4.71651385e-10]
 [2.24542092e-08]
 [3.20068128e-09]
 [6.65074162e-10]
 [3.97990974e-09]
 [2.59688608e-08]
 [3.01487191e-08]
 [1.30987921e-09]
 [3.20343552e-09]
 [3.93251476e-09]
 [5.26911847e-08]
 [4.39725767e-09]
 [7.08959957e-09]
 [5.57236177e-08]
 [2.76668510e-09]
 [7.86699861e-09]
 [1.23926123e-08]
 [9.33169542e-09]
 [1.21376104e-07]
 [1.18859411e-08]
 [7.96193760e-08]
 [5.93955685e-09]
 [3.58793795e-09]
 [4.01950295e-09]
 [2.29964741e-08]
 [3.75291842e-09]
 [1.05547917e-08]
 [1.24428894e-07]
 [4.43676118e-09]
 [1.64806373e-08]
 [5.31255973e-09]
 [2.23829701e-08]
 [6.39403153e-09]
 [4.39926495e-08]
 [2.61337107e-07]
 [2.47274397e-08]
 [2.88998780e-08]
 [8.53270876e-09]
 [6.30145109e-08]
 [2.94336274e-07]
 [1.22414141e-08]
 [8.37586640e-08]
 [1.76081461e-08]
 [6.25151912e-08]
 [2.76611757e-07]
 [5.74006094e-07]
 [3.40296538e-08]
 [1.75423850e-07]
 [8.96390944e-08]
 [2.98507302e-07]
 [1.20833263e-07]
 [7.07113657e-07]
 [1.28443219e-07]
 [1.15127648e-07]
 [7.63819159e-08]
 [6.78627075e-08]
 [1.34793208e-06]
 [3.93363962e-07]
 [8.27310700e-08]
 [1.59738633e-07]
 [1.10755401e-07]
 [3.78345618e-07]
 [1.75256119e-07]
 [1.23211336e-07]
 [1.29014936e-07]
 [1.19387721e-07]
 [1.38822770e-07]
 [1.18345724e-07]
 [1.70748854e-06]
 [1.25354575e-07]
 [1.56759441e-07]
 [1.02516822e-06]]
[[3.4220037e-08]
 [1.9376131e-08]
 [2.4785049e-08]
 [5.4027009e-08]
 [1.7087867e-08]
 [2.8015705e-07]
 [2.2166600e-07]
 [3.5032224e-07]
 [9.0421274e-08]
 [2.5390817e-08]
 [1.9396143e-07]
 [4.9749724e-07]
 [6.3869898e-08]
 [1.6409427e-07]
 [8.2582176e-07]
 [8.0319029e-07]
 [8.5619439e-07]
 [7.9569895e-07]
 [7.6246630e-07]
 [9.7429449e-07]
 [3.1499502e-07]
 [2.9483604e-07]
 [1.0975210e-06]
 [2.5606718e-07]
 [1.3393404e-06]
 [9.2536169e-07]
 [1.8678430e-06]
 [1.3103950e-06]
 [2.7550398e-06]
 [5.6061674e-07]
 [1.0660511e-06]
 [3.9587399e-06]
 [1.1636592e-06]
 [2.4020517e-06]
 [1.5689491e-06]
 [5.5709916e-06]
 [1.1162781e-05]
 [9.2527625e-06]
 [1.1490200e-06]
 [1.3249848e-05]
 [1.5390437e-05]
 [4.4077342e-06]
 [7.8762514e-06]
 [4.0728669e-06]
 [1.9589081e-05]
 [1.0396440e-05]
 [2.6542327e-06]
 [8.1836870e-06]
 [4.5820766e-06]
 [3.8699072e-05]
 [3.5689678e-05]
 [3.7805872e-05]
 [2.9576169e-05]
 [3.7032110e-05]
 [3.8340324e-05]
 [9.3665367e-06]
 [3.8611739e-05]
 [1.4385241e-05]
 [4.6160538e-05]
 [4.0203351e-05]
 [6.0650815e-05]
 [5.0490336e-05]
 [7.5967846e-06]
 [2.5357600e-05]
 [1.7449245e-05]
 [8.2145722e-05]
 [5.0854305e-05]
 [2.3288647e-05]
 [1.1772155e-04]
 [9.8255710e-05]
 [1.6710113e-04]
 [6.8886402e-05]
 [2.8576063e-05]
 [2.7962467e-05]
 [2.3387893e-04]
 [1.8557883e-04]
 [8.8785935e-05]
 [7.9745507e-05]
 [1.1189340e-04]
 [8.2057944e-05]
 [1.4221940e-04]
 [3.3624019e-04]
 [6.8420556e-04]
 [8.3857490e-04]
 [1.1129692e-04]
 [3.8502345e-04]
 [1.0350416e-03]
 [6.7722728e-04]
 [1.2620866e-03]
 [3.6883145e-04]
 [1.5495793e-03]
 [1.8487163e-03]
 [1.9726381e-03]
 [1.9297770e-03]
 [2.2362263e-03]
 [2.0187723e-03]
 [4.1070301e-04]
 [2.0945745e-03]
 [2.1323331e-03]
 [8.4260752e-04]]
Softplus factor for those samples:
[9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 1.13248825e-06 9.99999997e-07
 1.31130219e-06 9.99999997e-07 1.84774399e-06 1.31130219e-06
 2.74181366e-06 9.99999997e-07 1.01327896e-06 3.93390656e-06
 1.19209290e-06 2.44379044e-06 1.60932541e-06 5.60283661e-06
 1.12056732e-05 9.23871994e-06 1.19209290e-06 1.31726265e-05
 1.53183937e-05 4.41074371e-06 7.86781311e-06 4.05311584e-06
 1.96099281e-05 1.04308128e-05 2.62260437e-06 8.22544098e-06
 4.64916229e-06 3.86834145e-05 3.57031822e-05 3.77893448e-05
 2.95639038e-05 3.70144844e-05 3.83257866e-05 9.41753387e-06
 3.86238098e-05 1.43647194e-05 4.61339951e-05 4.01735306e-05
 6.06775284e-05 5.04851341e-05 7.56978989e-06 2.53319740e-05
 1.74045563e-05 8.21352005e-05 5.08427620e-05 2.33650208e-05
 1.17719173e-04 9.82284546e-05 1.67071819e-04 6.88433647e-05
 2.86102295e-05 2.78949738e-05 2.33888626e-04 1.85608864e-04
 8.87513161e-05 7.96914101e-05 1.11818314e-04 8.20755959e-05
 1.42216682e-04 3.36229801e-04 6.83963299e-04 8.38220119e-04
 1.11281872e-04 3.84986401e-04 1.03449821e-03 6.76989555e-04
 1.26135349e-03 3.68654728e-04 1.54834986e-03 1.84690952e-03
 1.97070837e-03 1.92791224e-03 2.23368406e-03 2.01672316e-03
 4.10616398e-04 2.09236145e-03 2.13003159e-03 8.42213631e-04]

- 6086 expected decrease violations (out of 71225 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-118.01000977; mean=-56.87760076; max=0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 82 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.51347262; max=17.68250275
-- 0 hard violations (out of 28)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=7.16705322; mean=398.80670166; max=862.89392090
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 8 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 985
- Init. samples: 37
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.452862024307251 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 8): 100%|█████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.66it/s]
Number of times the learn.train_step function was compiled: 10

Loss components in last train step:
 - 0. total: 0.43108144
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0029653765
 - 6. expDecrease counterx: 0.42811605
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.25436285, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11223301, dtype=float32), Array([1.        , 0.99977994], dtype=float32)), (Array(0.4327623, dtype=float32), Array([1.], dtype=float32)), (Array(0.21640496, dtype=float32), Array([1.        , 0.99977994], dtype=float32)), (Array(1.9694268, dtype=float32), None), (Array(1.9749144, dtype=float32), None), (Array(2.4483943, dtype=float32), None), (Array(6.7328377, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2672.5513, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1216.003, dtype=float32), Array([1.0000001, 0.821467 ], dtype=float32)), (Array(4108.7783, dtype=float32), Array([1.], dtype=float32)), (Array(2255.7522, dtype=float32), Array([1.0000001, 0.821467 ], dtype=float32)), (Array(19000.492, dtype=float32), None), (Array(4824.6646, dtype=float32), None), (Array(17717.678, dtype=float32), None), (Array(13380.682, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2561.658 (L1)
-- Lipschitz coefficient of certificate: 1216.003 (L1)
-- Lipschitz coefficient of policy: 0.112 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.12it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70039
-- Number of factors below 0.75: 197
-- Number of factors below 0.5: 188
-- Number of factors below 0.25: 164
-- Number of factors below 0.1: 147
-- Number of factors below 0.05: 143
-- Number of factors below 0.01: 126
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.225 -0.015  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.235 -0.035  0.01 ]
 [-0.235 -0.045  0.01 ]
 [-0.235 -0.025  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.235 -0.015  0.01 ]
 [-0.235 -0.005  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225 -0.075  0.01 ]
 [-0.235  0.005  0.01 ]
 [-0.205 -0.105  0.01 ]
 [-0.235 -0.055  0.01 ]
 [-0.205  0.105  0.01 ]
 [-0.235  0.015  0.01 ]
 [-0.215 -0.095  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.215 -0.085  0.01 ]]
Corresponding V values are:
[[1.51441149e-09]
 [7.29099170e-10]
 [1.00190645e-09]
 [7.32338301e-10]
 [2.33782149e-09]
 [3.79015974e-09]
 [1.06341203e-09]
 [2.24597230e-09]
 [3.18520654e-09]
 [1.67844416e-09]
 [1.50048962e-09]
 [1.59458424e-09]
 [5.14093434e-09]
 [6.32283026e-09]
 [2.19232144e-09]
 [8.98816488e-09]
 [1.15857608e-08]
 [2.58212185e-09]
 [1.67881975e-08]
 [2.32398611e-09]
 [4.15623358e-09]
 [1.40087675e-09]
 [2.40758862e-08]
 [7.84506149e-09]
 [1.04105702e-09]
 [4.32078551e-09]
 [1.12290210e-09]
 [1.84212130e-08]
 [4.94814856e-09]
 [1.39428724e-09]
 [3.12348121e-08]
 [1.77314197e-09]
 [5.71101673e-08]
 [2.26287100e-09]
 [5.38956524e-09]
 [5.36367128e-09]
 [6.10626003e-08]
 [6.84134482e-09]
 [4.46720527e-08]
 [9.75920411e-09]
 [1.09124798e-08]
 [3.10495318e-09]
 [1.00172928e-08]
 [1.69386283e-08]
 [1.31492186e-07]
 [5.35786349e-09]
 [1.47479504e-08]
 [1.34908063e-07]
 [2.93684828e-08]
 [1.04344515e-08]
 [1.22315811e-07]
 [2.92855646e-07]
 [5.52308421e-08]
 [3.10814272e-08]
 [3.27125605e-07]
 [3.69637903e-08]
 [4.32119194e-08]
 [1.79983637e-08]
 [1.60187064e-08]
 [1.48353543e-08]
 [1.50391148e-08]
 [1.02654184e-07]
 [1.80497590e-08]
 [2.46439136e-08]
 [2.16833556e-08]
 [4.54194371e-08]
 [2.56240504e-08]
 [6.80108201e-07]
 [7.87003387e-08]
 [1.93558236e-07]
 [3.39976722e-08]
 [1.31534307e-07]
 [7.17621901e-07]
 [1.18522266e-07]
 [5.08091773e-08]
 [5.16328953e-07]
 [1.69053592e-07]
 [3.82670777e-07]
 [7.63024204e-08]
 [1.56696035e-06]
 [3.42834880e-07]
 [1.36519418e-07]
 [5.24321933e-07]
 [9.80318049e-08]
 [1.68951715e-07]
 [1.12004109e-07]
 [1.82656618e-06]
 [9.48898276e-07]
 [1.29682547e-07]
 [1.51473486e-07]
 [3.15459175e-07]
 [5.36290202e-07]
 [2.30737228e-07]
 [6.76568959e-07]
 [5.51837843e-07]
 [4.06520303e-06]
 [3.57813065e-07]
 [9.10760775e-07]
 [2.54445285e-06]
 [3.29138697e-06]]
[[5.07237701e-08]
 [3.30302683e-08]
 [3.93133206e-08]
 [2.91922841e-08]
 [7.37213313e-08]
 [1.19968092e-07]
 [3.41432376e-08]
 [3.98472849e-07]
 [4.92436072e-07]
 [3.51435176e-07]
 [3.53160772e-07]
 [8.32137488e-08]
 [6.29470208e-07]
 [2.13562970e-07]
 [4.64718909e-07]
 [9.33705962e-07]
 [3.87688857e-07]
 [3.15095349e-07]
 [1.45702995e-06]
 [3.98443535e-06]
 [3.92447282e-06]
 [4.10343227e-06]
 [6.87509157e-07]
 [4.22777430e-06]
 [4.43107911e-06]
 [1.16121475e-06]
 [4.84925567e-06]
 [3.98596330e-06]
 [1.55683301e-06]
 [5.59637056e-06]
 [2.65032509e-06]
 [7.42370048e-06]
 [1.24226608e-06]
 [1.06442922e-05]
 [1.96026103e-05]
 [1.72243599e-05]
 [4.92138042e-06]
 [2.21842929e-05]
 [5.51967833e-06]
 [2.49377026e-05]
 [4.90362936e-06]
 [1.57622599e-05]
 [1.50665865e-05]
 [2.68969743e-05]
 [2.71677732e-06]
 [2.33355804e-05]
 [1.03523626e-05]
 [9.00030136e-06]
 [3.78441073e-05]
 [3.43692955e-05]
 [1.44980095e-05]
 [7.36080983e-06]
 [5.52340389e-05]
 [2.63641741e-05]
 [1.76052490e-05]
 [2.43163922e-05]
 [5.89748524e-05]
 [1.41394790e-04]
 [1.32480418e-04]
 [1.35182490e-04]
 [1.31463807e-04]
 [1.00322599e-04]
 [1.35376249e-04]
 [1.47892250e-04]
 [1.51154498e-04]
 [1.46686041e-04]
 [1.94030974e-04]
 [2.18786972e-05]
 [7.41687618e-05]
 [1.80982839e-04]
 [2.46507523e-04]
 [1.55970440e-04]
 [6.08553310e-05]
 [1.06748012e-04]
 [3.38812621e-04]
 [5.38305612e-05]
 [1.43449361e-04]
 [3.33516509e-04]
 [4.65346820e-04]
 [9.19011436e-05]
 [3.04721907e-04]
 [6.30894909e-04]
 [2.27705532e-04]
 [1.35305396e-03]
 [1.21126184e-03]
 [1.53766142e-03]
 [2.76130188e-04]
 [6.32597250e-04]
 [1.74959004e-03]
 [2.04604864e-03]
 [8.58868007e-04]
 [4.29509382e-04]
 [2.29010801e-03]
 [6.44433894e-04]
 [1.64040306e-03]
 [4.41728975e-04]
 [3.19942483e-03]
 [1.08675356e-03]
 [6.12968171e-04]
 [6.06117595e-04]]
Softplus factor for those samples:
[1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.4305115e-06 3.9935112e-06
 3.9339066e-06 4.0531158e-06 1.0000000e-06 4.2319298e-06 4.4107437e-06
 1.1920929e-06 4.8279762e-06 3.9935112e-06 1.6093254e-06 5.6028366e-06
 2.6226044e-06 7.3909760e-06 1.2516975e-06 1.0609627e-05 1.9609928e-05
 1.7285347e-05 4.8875809e-06 2.2172928e-05 5.5432320e-06 2.4914742e-05
 4.8875809e-06 1.5735626e-05 1.5079975e-05 2.6941299e-05 2.6822090e-06
 2.3365021e-05 1.0371208e-05 9.0599060e-06 3.7848949e-05 3.4332275e-05
 1.4483929e-05 7.3909760e-06 5.5253506e-05 2.6404858e-05 1.7523766e-05
 2.4318695e-05 5.9008598e-05 1.4138222e-04 1.3250113e-04 1.3518333e-04
 1.3142824e-04 1.0037422e-04 1.3530254e-04 1.4787912e-04 1.5115738e-04
 1.4662743e-04 1.9395351e-04 2.1815300e-05 7.4207783e-05 1.8095970e-04
 2.4646521e-04 1.5598536e-04 6.0856342e-05 1.0681152e-04 3.3867359e-04
 5.3822994e-05 1.4346838e-04 3.3342838e-04 4.6527386e-04 9.1850758e-05
 3.0469894e-04 6.3061714e-04 2.2768974e-04 1.3521910e-03 1.2105703e-03
 1.5364885e-03 2.7608871e-04 6.3234568e-04 1.7480254e-03 2.0440221e-03
 8.5854530e-04 4.2939186e-04 2.2874475e-03 6.4426661e-04 1.6390681e-03
 4.4161081e-04 3.1943321e-03 1.0861754e-03 6.1273575e-04 6.0588121e-04]

- 5940 expected decrease violations (out of 70039 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-124.49725342; mean=-59.68696324; max=0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 83 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.63483697; max=17.11898041
-- 0 hard violations (out of 29)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=1.47656250; mean=427.29342651; max=943.82189941
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 9 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 983
- Init. samples: 39
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.580167293548584 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 9): 100%|█████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 11

Loss components in last train step:
 - 0. total: 0.6421629
 - 1. init: 0.35301697
 - 2. init counterx: 0.062808394
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002509872
 - 6. expDecrease counterx: 0.22382772
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.23238379, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10330246, dtype=float32), Array([1.       , 0.9973277], dtype=float32)), (Array(0.3889011, dtype=float32), Array([1.], dtype=float32)), (Array(0.1947107, dtype=float32), Array([1.       , 0.9973277], dtype=float32)), (Array(1.8264358, dtype=float32), None), (Array(1.8760114, dtype=float32), None), (Array(2.2947052, dtype=float32), None), (Array(6.3954945, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2625.549, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1184.3798, dtype=float32), Array([0.99999994, 0.8236368 ], dtype=float32)), (Array(4045.5747, dtype=float32), Array([1.], dtype=float32)), (Array(2218.4104, dtype=float32), Array([0.99999994, 0.8236368 ], dtype=float32)), (Array(18506.285, dtype=float32), None), (Array(5152.62, dtype=float32), None), (Array(17539.344, dtype=float32), None), (Array(14692.868, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2484.991 (L1)
-- Lipschitz coefficient of certificate: 1184.380 (L1)
-- Lipschitz coefficient of policy: 0.103 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.15it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70800
-- Number of factors below 0.75: 188
-- Number of factors below 0.5: 172
-- Number of factors below 0.25: 148
-- Number of factors below 0.1: 143
-- Number of factors below 0.05: 133
-- Number of factors below 0.01: 104
Most violating states:
[[-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.205  0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.225 -0.055  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.005  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.235 -0.045  0.01 ]
 [-0.225 -0.075  0.01 ]
 [-0.235 -0.035  0.01 ]
 [-0.235 -0.025  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.235 -0.015  0.01 ]
 [-0.235 -0.005  0.01 ]
 [-0.205  0.105  0.01 ]
 [-0.235  0.005  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [-0.205 -0.105  0.01 ]
 [ 0.225  0.005  0.01 ]
 [-0.235 -0.055  0.01 ]
 [ 0.225 -0.005  0.01 ]]
Corresponding V values are:
[[2.2609037e-09]
 [2.0314679e-09]
 [3.0113474e-09]
 [4.0592347e-09]
 [6.1514966e-09]
 [2.5394968e-09]
 [9.0723544e-09]
 [6.7379395e-09]
 [5.2983014e-09]
 [1.5787545e-08]
 [8.7641769e-09]
 [3.9669503e-09]
 [1.3812702e-08]
 [4.4961381e-09]
 [2.9545408e-08]
 [2.2869406e-08]
 [5.6414002e-09]
 [7.0772508e-09]
 [4.1743178e-08]
 [8.3951832e-09]
 [4.9136144e-09]
 [1.5740159e-08]
 [6.0889654e-08]
 [3.3250029e-09]
 [2.9209424e-09]
 [3.2755661e-08]
 [1.2497244e-08]
 [3.4811320e-09]
 [7.6543799e-08]
 [1.5451121e-08]
 [1.3917258e-07]
 [4.4671009e-09]
 [7.5558454e-08]
 [5.9450991e-09]
 [1.4835473e-07]
 [7.7521118e-09]
 [3.1628275e-07]
 [1.0092355e-08]
 [2.1328262e-08]
 [3.6094786e-08]
 [2.1316833e-08]
 [3.1970200e-07]
 [2.5677966e-08]
 [3.5801534e-08]
 [3.3735610e-08]
 [5.0416272e-08]
 [1.7209574e-08]
 [2.2448222e-07]
 [5.0279528e-08]
 [8.0658154e-08]
 [6.7630316e-07]
 [3.3420317e-08]
 [1.3829843e-07]
 [7.4074137e-07]
 [1.0822629e-07]
 [3.6376772e-08]
 [3.1220221e-08]
 [3.3267046e-08]
 [3.7192930e-08]
 [4.7821747e-08]
 [4.6246399e-08]
 [2.5261656e-07]
 [8.1470510e-08]
 [1.3069928e-07]
 [1.0943625e-07]
 [6.3234367e-08]
 [8.2429288e-08]
 [2.0930190e-07]
 [1.5139187e-06]
 [4.5875842e-07]
 [1.7046591e-06]
 [1.0664924e-07]
 [8.9764694e-07]
 [3.1263730e-07]
 [4.4202599e-07]
 [1.6025345e-07]
 [9.4123016e-07]
 [9.2383448e-07]
 [3.5364706e-06]
 [2.4111003e-07]
 [6.2864115e-07]
 [8.5707916e-07]
 [4.2600860e-07]
 [2.2625052e-06]
 [4.3382897e-06]
 [8.9660739e-07]
 [8.5810643e-07]
 [1.8636509e-06]
 [6.8259430e-07]
 [7.1426535e-07]
 [5.9392082e-06]
 [7.4769605e-07]
 [7.9893437e-07]
 [9.4364977e-06]
 [9.4101296e-07]
 [4.8831334e-06]
 [2.7085662e-06]
 [9.3043752e-07]
 [1.9741544e-06]
 [8.9966267e-07]]
[[1.14720585e-07]
 [1.17318415e-07]
 [1.24564707e-07]
 [1.57864662e-07]
 [2.06914379e-07]
 [1.31024251e-07]
 [3.24718599e-07]
 [2.05642664e-06]
 [1.91521099e-06]
 [5.15128420e-07]
 [2.31188187e-06]
 [2.57072571e-07]
 [2.54458860e-06]
 [1.94778636e-06]
 [8.78282322e-07]
 [3.22937331e-06]
 [2.35990001e-06]
 [1.04263199e-06]
 [4.40211352e-06]
 [7.48325238e-06]
 [7.84808890e-06]
 [7.79660058e-06]
 [1.52233474e-06]
 [8.30079716e-06]
 [9.26629946e-06]
 [8.01405167e-06]
 [4.67911650e-06]
 [1.05477893e-05]
 [6.90601883e-06]
 [5.15890497e-06]
 [2.81654616e-06]
 [1.33093463e-05]
 [1.03113152e-05]
 [1.81635914e-05]
 [1.21916337e-05]
 [2.85665283e-05]
 [6.13925022e-06]
 [4.49701547e-05]
 [1.15699870e-04]
 [1.59453521e-05]
 [1.21281926e-04]
 [2.13640378e-05]
 [1.25935563e-04]
 [1.09730980e-04]
 [1.30343833e-04]
 [1.34092450e-04]
 [6.77716453e-05]
 [2.17847173e-05]
 [3.81088830e-05]
 [1.51601707e-04]
 [1.66526570e-05]
 [1.01137754e-04]
 [1.99051268e-04]
 [4.43991412e-05]
 [1.38468022e-04]
 [2.72874604e-04]
 [2.69308424e-04]
 [2.59830267e-04]
 [2.61157431e-04]
 [2.76244245e-04]
 [2.72009784e-04]
 [2.90524127e-04]
 [2.71141238e-04]
 [8.09530829e-05]
 [1.75263602e-04]
 [2.82782130e-04]
 [3.48189962e-04]
 [2.68037722e-04]
 [5.96258105e-05]
 [4.82366042e-04]
 [1.60636191e-04]
 [4.80344112e-04]
 [1.14727321e-04]
 [2.79953238e-04]
 [3.54606338e-04]
 [7.24187412e-04]
 [3.09505034e-04]
 [8.07768316e-04]
 [2.56066531e-04]
 [1.08938047e-03]
 [5.24800271e-04]
 [9.94597678e-04]
 [1.62394810e-03]
 [1.47627341e-03]
 [7.33096618e-04]
 [2.41171801e-03]
 [9.68641229e-03]
 [1.55277876e-03]
 [1.01597421e-02]
 [1.07994974e-02]
 [9.29810456e-04]
 [1.14675276e-02]
 [1.21772038e-02]
 [1.17972249e-03]
 [1.27372919e-02]
 [1.36778806e-03]
 [2.56179227e-03]
 [9.15849395e-03]
 [1.03520453e-02]
 [9.30271205e-03]]
Softplus factor for those samples:
[9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 2.08616257e-06
 1.84774399e-06 9.99999997e-07 2.26497650e-06 9.99999997e-07
 2.56299973e-06 1.90734863e-06 9.99999997e-07 3.15904617e-06
 2.32458115e-06 1.01327896e-06 4.41074371e-06 7.45058060e-06
 7.86781311e-06 7.80820847e-06 1.60932541e-06 8.28504562e-06
 9.23871994e-06 7.98702240e-06 4.70876694e-06 1.04904175e-05
 6.91413879e-06 5.18560410e-06 2.74181366e-06 1.33514404e-05
 1.03712082e-05 1.81794167e-05 1.21593475e-05 2.86102295e-05
 6.13927841e-06 4.49419022e-05 1.15692616e-04 1.59740448e-05
 1.21295452e-04 2.13384628e-05 1.25944614e-04 1.09672546e-04
 1.30355358e-04 1.34050846e-04 6.77704811e-05 2.17556953e-05
 3.81469727e-05 1.51634216e-04 1.66296959e-05 1.01149082e-04
 1.99079514e-04 4.44054604e-05 1.38521194e-04 2.72870064e-04
 2.69353390e-04 2.59876251e-04 2.61187553e-04 2.76148319e-04
 2.72035599e-04 2.90453434e-04 2.71141529e-04 8.09431076e-05
 1.75237656e-04 2.82824039e-04 3.48091125e-04 2.68042088e-04
 5.96046448e-05 4.82261181e-04 1.60694122e-04 4.80234623e-04
 1.14738941e-04 2.79903412e-04 3.54528427e-04 7.23958015e-04
 3.09467316e-04 8.07404518e-04 2.56061554e-04 1.08879805e-03
 5.24640083e-04 9.94026661e-04 1.62261724e-03 1.47515535e-03
 7.32898712e-04 2.40880251e-03 9.63962078e-03 1.55162811e-03
 1.01083517e-02 1.07414126e-02 9.29355621e-04 1.14020109e-02
 1.21033788e-02 1.17903948e-03 1.26565695e-02 1.36685371e-03
 2.55846977e-03 9.11676884e-03 1.02986693e-02 9.25958157e-03]

- 6071 expected decrease violations (out of 70800 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-122.68426514; mean=-57.98763042; max=0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000000

- 96 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.76971239; max=17.81474876
-- 0 hard violations (out of 42)

- 8 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-16.98516846; mean=407.62606812; max=926.80676270
-- 0 hard violations (out of 2)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 10 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 983
- Init. samples: 39
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.06328511238098145 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 10): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.06it/s]
Number of times the learn.train_step function was compiled: 11

Loss components in last train step:
 - 0. total: 0.26301792
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002302406
 - 6. expDecrease counterx: 0.2607155
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.2245775, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.100817, dtype=float32), Array([1.       , 0.9999016], dtype=float32)), (Array(0.36434323, dtype=float32), Array([1.], dtype=float32)), (Array(0.18218057, dtype=float32), Array([1.       , 0.9999016], dtype=float32)), (Array(1.801783, dtype=float32), None), (Array(1.8438572, dtype=float32), None), (Array(2.2387996, dtype=float32), None), (Array(6.2609653, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2636.8503, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1181.5913, dtype=float32), Array([1.        , 0.81638455], dtype=float32)), (Array(4075.576, dtype=float32), Array([1.], dtype=float32)), (Array(2243.7847, dtype=float32), Array([1.        , 0.81638455], dtype=float32)), (Array(18836.463, dtype=float32), None), (Array(5592.175, dtype=float32), None), (Array(17707.893, dtype=float32), None), (Array(16347.624, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2476.351 (L1)
-- Lipschitz coefficient of certificate: 1181.591 (L1)
-- Lipschitz coefficient of policy: 0.101 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.12it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70311
-- Number of factors below 0.75: 192
-- Number of factors below 0.5: 174
-- Number of factors below 0.25: 151
-- Number of factors below 0.1: 141
-- Number of factors below 0.05: 135
-- Number of factors below 0.01: 98
Most violating states:
[[-0.205 -0.025  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215  0.005  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.205  0.105  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215  0.095  0.01 ]
 [-0.235 -0.045  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.205 -0.105  0.01 ]
 [-0.235 -0.035  0.01 ]
 [-0.235 -0.025  0.01 ]
 [-0.235 -0.015  0.01 ]
 [-0.235 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]
 [-0.235 -0.055  0.01 ]
 [-0.235  0.005  0.01 ]]
Corresponding V values are:
[[2.5272431e-09]
 [3.2339162e-09]
 [2.0403330e-09]
 [4.2026445e-09]
 [6.2004415e-09]
 [2.2246165e-09]
 [8.9817727e-09]
 [3.4408973e-09]
 [1.4663243e-08]
 [7.2293189e-09]
 [9.3935011e-09]
 [1.4046581e-08]
 [5.9712830e-09]
 [2.5146848e-08]
 [5.1602091e-09]
 [2.1874230e-08]
 [6.5566077e-09]
 [5.8602683e-09]
 [4.7414673e-08]
 [3.6889979e-08]
 [1.5870329e-08]
 [8.3864444e-09]
 [4.9708513e-09]
 [3.5734657e-09]
 [1.0006184e-07]
 [6.3843949e-08]
 [3.3921562e-08]
 [3.2756398e-09]
 [1.2099467e-08]
 [3.9909089e-09]
 [1.6393637e-08]
 [5.1495710e-09]
 [1.1019007e-07]
 [2.1635030e-07]
 [7.4632176e-08]
 [6.8556218e-09]
 [8.9962944e-09]
 [2.0980272e-07]
 [1.1666544e-08]
 [3.9811873e-08]
 [4.6291066e-07]
 [1.8912125e-08]
 [4.5686747e-07]
 [5.4446073e-08]
 [2.3146409e-07]
 [3.3183586e-08]
 [5.2434231e-08]
 [3.1682546e-08]
 [3.8981273e-08]
 [3.5087247e-08]
 [5.2560498e-08]
 [7.9131731e-08]
 [3.6642366e-08]
 [1.2309282e-07]
 [9.8656631e-07]
 [3.5409414e-08]
 [3.8903430e-08]
 [3.7882174e-08]
 [4.4525908e-08]
 [1.0173048e-06]
 [4.8295469e-08]
 [1.2521514e-07]
 [2.1065881e-07]
 [5.8665339e-08]
 [1.6370647e-07]
 [8.9626447e-08]
 [9.9816134e-08]
 [7.8017322e-08]
 [3.6439596e-07]
 [2.3625135e-07]
 [1.0136228e-07]
 [2.1811195e-06]
 [1.3108524e-07]
 [1.0207362e-06]
 [3.1730877e-07]
 [6.3054688e-07]
 [5.1538882e-07]
 [2.3588561e-06]
 [1.9000102e-07]
 [1.0972354e-06]
 [6.7222834e-07]
 [1.2410878e-06]
 [2.8344917e-07]
 [8.0625392e-07]
 [5.5184892e-06]
 [5.0467281e-07]
 [3.1716809e-06]
 [2.1601147e-06]
 [9.8637440e-07]
 [6.1604223e-06]
 [1.1798703e-06]
 [7.5290236e-06]
 [2.9103874e-06]
 [1.1266886e-06]
 [1.0980372e-06]
 [1.1054689e-06]
 [1.1103789e-06]
 [1.0749801e-06]
 [2.1502531e-06]
 [1.2123035e-06]]
[[1.6061392e-07]
 [1.6099087e-07]
 [1.7992640e-07]
 [1.8781215e-07]
 [2.2821744e-07]
 [2.1674040e-07]
 [3.2542854e-07]
 [3.7346879e-07]
 [4.7965864e-07]
 [3.2305006e-06]
 [3.1854006e-06]
 [3.2893252e-06]
 [3.3470342e-06]
 [7.7038726e-07]
 [3.6987599e-06]
 [3.8087826e-06]
 [1.2428847e-06]
 [4.6163982e-06]
 [1.2755335e-06]
 [4.9962118e-06]
 [8.9287951e-06]
 [8.0748187e-06]
 [8.7874359e-06]
 [9.9249628e-06]
 [2.0851683e-06]
 [6.8859472e-06]
 [9.3836943e-06]
 [1.1218663e-05]
 [7.4196237e-06]
 [1.3365923e-05]
 [5.3558847e-06]
 [1.7803311e-05]
 [1.0982512e-05]
 [3.8588646e-06]
 [1.3528944e-05]
 [2.4233796e-05]
 [3.6764817e-05]
 [1.8381483e-05]
 [5.7583806e-05]
 [1.7829936e-05]
 [8.8848137e-06]
 [8.5615735e-05]
 [3.0082054e-05]
 [3.8615202e-05]
 [2.9284251e-05]
 [1.8119301e-04]
 [1.7998584e-04]
 [1.8057534e-04]
 [1.8227143e-04]
 [1.8065680e-04]
 [1.8329843e-04]
 [1.8941400e-04]
 [1.2678653e-04]
 [2.4235899e-04]
 [2.5070953e-05]
 [3.2429301e-04]
 [3.3536673e-04]
 [3.0869103e-04]
 [2.9455315e-04]
 [6.5623608e-05]
 [3.4711245e-04]
 [1.8963467e-04]
 [3.0216124e-04]
 [3.0955140e-04]
 [7.5920601e-05]
 [3.4894774e-04]
 [2.2187694e-04]
 [3.3803674e-04]
 [4.7812372e-04]
 [3.5233336e-04]
 [4.4089503e-04]
 [9.3513940e-05]
 [6.5711903e-04]
 [1.5962821e-04]
 [2.9353652e-04]
 [7.5059634e-04]
 [3.4103074e-04]
 [2.5779917e-04]
 [9.9473330e-04]
 [4.6047114e-04]
 [5.0873338e-04]
 [1.1684204e-03]
 [1.4836100e-03]
 [1.1919311e-03]
 [4.3413392e-04]
 [2.2104213e-03]
 [1.9423913e-03]
 [1.3085009e-03]
 [3.2552157e-03]
 [1.1795791e-03]
 [1.3108868e-02]
 [1.3826563e-03]
 [3.4412926e-03]
 [1.3296994e-02]
 [1.3371675e-02]
 [1.3452112e-02]
 [1.3735341e-02]
 [1.1410115e-02]
 [1.2920792e-02]
 [1.4001089e-02]]
Softplus factor for those samples:
[1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06
 1.0000000e-06 1.0000000e-06 1.0000000e-06 1.0000000e-06 3.1590462e-06
 3.1590462e-06 3.3378601e-06 3.3974648e-06 1.0000000e-06 3.7550926e-06
 3.8146973e-06 1.2516975e-06 4.6491623e-06 1.3113022e-06 4.9471855e-06
 9.0003014e-06 8.1062317e-06 8.7618828e-06 9.9539757e-06 2.0861626e-06
 6.9141388e-06 9.4175339e-06 1.1265278e-05 7.3909760e-06 1.3411045e-05
 5.3048134e-06 1.7821789e-05 1.0967255e-05 3.8743019e-06 1.3530254e-05
 2.4259090e-05 3.6835670e-05 1.8358231e-05 5.7518482e-05 1.7821789e-05
 8.8214874e-06 8.5592270e-05 3.0040741e-05 3.8623810e-05 2.9265881e-05
 1.8119812e-04 1.7994642e-04 1.8054247e-04 1.8221140e-04 1.8072128e-04
 1.8334389e-04 1.8942356e-04 1.2683868e-04 2.4241209e-04 2.5093555e-05
 3.2424927e-04 3.3533573e-04 3.0863285e-04 2.9456615e-04 6.5624714e-05
 3.4707785e-04 1.8960238e-04 3.0213594e-04 3.0952692e-04 7.5936317e-05
 3.4886599e-04 2.2178888e-04 3.3801794e-04 4.7802925e-04 3.5232306e-04
 4.4077635e-04 9.3519688e-05 6.5696239e-04 1.5962124e-04 2.9349327e-04
 7.5030327e-04 3.4099817e-04 2.5779009e-04 9.9426508e-04 4.6032667e-04
 5.0854683e-04 1.1677146e-03 1.4824867e-03 1.1911392e-03 4.3404102e-04
 2.2080541e-03 1.9405484e-03 1.3076067e-03 3.2498837e-03 1.1789203e-03
 1.3023317e-02 1.3816953e-03 3.4354329e-03 1.3208985e-02 1.3282657e-02
 1.3362110e-02 1.3641357e-02 1.1345267e-02 1.2837708e-02 1.3903499e-02]

- 5837 expected decrease violations (out of 70311 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-126.75646973; mean=-59.35451500; max=-0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000006

- 95 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-1.00000000; mean=0.74148750; max=16.66477394
-- 0 hard violations (out of 41)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=24.19592285; mean=424.90734863; max=918.94641113
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 11 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 983
- Init. samples: 39
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.06438994407653809 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 11): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.04it/s]
Number of times the learn.train_step function was compiled: 11

Loss components in last train step:
 - 0. total: 0.19819891
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002379167
 - 6. expDecrease counterx: 0.19581975
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22573546, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10291819, dtype=float32), Array([0.99999994, 0.9982147 ], dtype=float32)), (Array(0.35645157, dtype=float32), Array([1.], dtype=float32)), (Array(0.17838503, dtype=float32), Array([0.99999994, 0.9982147 ], dtype=float32)), (Array(1.8534553, dtype=float32), None), (Array(1.839189, dtype=float32), None), (Array(2.2409263, dtype=float32), None), (Array(6.2027764, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2579.949, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1149.5796, dtype=float32), Array([1.0000001, 0.8214936], dtype=float32)), (Array(4008.7234, dtype=float32), Array([1.], dtype=float32)), (Array(2200.7893, dtype=float32), Array([1.0000001, 0.8214936], dtype=float32)), (Array(18427.873, dtype=float32), None), (Array(6050.8335, dtype=float32), None), (Array(17466.797, dtype=float32), None), (Array(18128.379, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2411.556 (L1)
-- Lipschitz coefficient of certificate: 1149.580 (L1)
-- Lipschitz coefficient of policy: 0.103 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.11it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71384
-- Number of factors below 0.75: 175
-- Number of factors below 0.5: 165
-- Number of factors below 0.25: 143
-- Number of factors below 0.1: 138
-- Number of factors below 0.05: 127
-- Number of factors below 0.01: 96
Most violating states:
[[-0.205 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.055  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.225  0.015  0.01 ]
 [-0.205  0.105  0.01 ]
 [-0.205 -0.105  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225  0.035  0.01 ]
 [-0.215 -0.095  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.035  0.01 ]]
Corresponding V values are:
[[9.32475697e-09]
 [1.23913599e-08]
 [7.09340009e-09]
 [1.68457408e-08]
 [5.85183502e-09]
 [5.09803844e-09]
 [2.48988581e-08]
 [6.22925800e-09]
 [3.73861724e-08]
 [6.52491039e-08]
 [1.11218101e-08]
 [2.55337937e-08]
 [2.08699085e-08]
 [3.52114071e-08]
 [1.26878916e-07]
 [5.65832146e-08]
 [1.78369213e-08]
 [5.64432767e-09]
 [6.66726896e-09]
 [9.90988269e-09]
 [1.72047177e-08]
 [3.47412268e-08]
 [1.63291318e-08]
 [5.68937786e-09]
 [9.16084844e-08]
 [6.91027413e-09]
 [1.73957044e-08]
 [2.71690880e-07]
 [8.52738768e-09]
 [7.55684013e-08]
 [2.87770003e-08]
 [1.52145404e-07]
 [2.73393201e-08]
 [1.05038414e-08]
 [1.32053612e-08]
 [2.75909912e-07]
 [5.94874450e-07]
 [2.06898481e-08]
 [1.70720412e-07]
 [6.82734864e-08]
 [5.44349689e-07]
 [3.75755462e-08]
 [1.23722111e-06]
 [1.06952555e-07]
 [1.17514823e-07]
 [1.19121717e-06]
 [6.83099586e-08]
 [6.85607091e-08]
 [7.60361090e-08]
 [5.92039555e-07]
 [7.58731318e-08]
 [9.43154745e-08]
 [2.76723370e-07]
 [1.14774650e-07]
 [1.11640453e-07]
 [1.27997879e-07]
 [8.65556800e-08]
 [1.50218199e-07]
 [1.42625780e-07]
 [1.15962344e-07]
 [2.13652797e-07]
 [1.17709313e-07]
 [2.64668006e-06]
 [1.94261318e-07]
 [3.27482383e-07]
 [2.65982948e-07]
 [1.50521217e-07]
 [2.83508416e-06]
 [3.29096338e-07]
 [5.17114017e-07]
 [2.10827636e-07]
 [6.66361188e-07]
 [9.24725612e-07]
 [7.84004101e-07]
 [2.97203457e-07]
 [8.30361103e-07]
 [9.00210182e-07]
 [6.39010750e-06]
 [4.78255913e-07]
 [1.20750690e-06]
 [1.64865196e-06]
 [3.14163708e-06]
 [9.06966079e-07]
 [7.04545755e-06]
 [3.75899936e-06]
 [3.59215483e-06]
 [3.42250382e-06]
 [6.02040336e-06]
 [1.55293014e-06]
 [1.70854964e-05]
 [4.77714957e-06]
 [1.52460268e-06]
 [1.70396345e-06]
 [1.48096876e-06]
 [1.09942812e-05]
 [1.61672585e-06]
 [2.36309370e-06]
 [6.71471207e-06]
 [1.75518824e-06]
 [2.13161616e-06]]
[[5.41976192e-07]
 [5.85150474e-07]
 [6.05011564e-07]
 [6.91424702e-07]
 [7.27293070e-07]
 [9.33924184e-07]
 [8.75646208e-07]
 [1.34705579e-06]
 [1.32992682e-06]
 [2.00541126e-06]
 [2.92946788e-06]
 [1.22607053e-05]
 [1.20324648e-05]
 [1.30833632e-05]
 [3.11688859e-06]
 [1.36767139e-05]
 [1.25115666e-05]
 [1.75298246e-05]
 [1.61786993e-05]
 [1.58288713e-05]
 [1.87376572e-05]
 [2.10504604e-05]
 [1.40530410e-05]
 [1.89535040e-05]
 [1.67839989e-05]
 [2.12125633e-05]
 [1.90626652e-05]
 [5.31846399e-06]
 [2.88655992e-05]
 [2.34050058e-05]
 [9.69968551e-06]
 [2.24733576e-05]
 [2.63706370e-05]
 [4.28406602e-05]
 [6.15370227e-05]
 [3.21041261e-05]
 [1.03010352e-05]
 [8.67950002e-05]
 [4.35116781e-05]
 [4.51324267e-05]
 [5.32890990e-05]
 [1.20689714e-04]
 [2.63703605e-05]
 [6.10473217e-05]
 [2.13702879e-04]
 [9.01830135e-05]
 [5.21350477e-04]
 [4.80655668e-04]
 [5.64473215e-04]
 [1.13530245e-04]
 [4.39938420e-04]
 [4.83938726e-04]
 [1.14141847e-04]
 [6.21756131e-04]
 [6.06845540e-04]
 [6.33207848e-04]
 [6.10446092e-04]
 [6.46760454e-04]
 [5.99011371e-04]
 [5.88104653e-04]
 [6.52270915e-04]
 [7.08653475e-04]
 [9.57944649e-05]
 [6.03109191e-04]
 [7.42099888e-04]
 [7.75835302e-04]
 [7.04120670e-04]
 [2.47771590e-04]
 [6.40952378e-04]
 [9.71608853e-04]
 [9.82005964e-04]
 [4.07194108e-04]
 [1.24350097e-03]
 [8.27453332e-04]
 [1.38405443e-03]
 [8.52596189e-04]
 [1.08922634e-03]
 [4.19449701e-04]
 [1.93911744e-03]
 [7.01649755e-04]
 [1.96337001e-03]
 [8.88867537e-04]
 [2.66251992e-03]
 [1.05102197e-03]
 [1.47981080e-03]
 [3.25366645e-03]
 [1.87234138e-03]
 [8.96254461e-03]
 [1.83203500e-02]
 [2.04100320e-03]
 [6.73870556e-03]
 [1.75112337e-02]
 [1.89128444e-02]
 [1.77784991e-02]
 [5.74526843e-03]
 [1.93992984e-02]
 [1.85064636e-02]
 [5.25013776e-03]
 [2.10578274e-02]
 [2.30343658e-02]]
Softplus factor for those samples:
[9.99999997e-07 9.99999997e-07 9.99999997e-07 9.99999997e-07
 9.99999997e-07 9.99999997e-07 9.99999997e-07 1.31130219e-06
 1.31130219e-06 2.02655792e-06 2.98023224e-06 1.22189522e-05
 1.20997429e-05 1.30534172e-05 3.09944153e-06 1.36494637e-05
 1.25169754e-05 1.74641609e-05 1.61528587e-05 1.57952309e-05
 1.87158585e-05 2.09808350e-05 1.40070915e-05 1.90138817e-05
 1.68085098e-05 2.12192535e-05 1.90734863e-05 5.30481339e-06
 2.87890434e-05 2.34246254e-05 9.65595245e-06 2.25305557e-05
 2.64048576e-05 4.29153442e-05 6.15715981e-05 3.21269035e-05
 1.03116035e-05 8.68439674e-05 4.35113907e-05 4.51803207e-05
 5.33461571e-05 1.20699406e-04 2.64048576e-05 6.09755516e-05
 2.13742256e-04 9.01222229e-05 5.21183014e-04 4.80592251e-04
 5.64396381e-04 1.13487244e-04 4.39822674e-04 4.83810902e-04
 1.14202499e-04 6.21497631e-04 6.06656075e-04 6.33001328e-04
 6.10172749e-04 6.46531582e-04 5.98788261e-04 5.87940216e-04
 6.52134418e-04 7.08401203e-04 9.57250595e-05 6.02841377e-04
 7.41779804e-04 7.75516033e-04 7.03930855e-04 2.47776508e-04
 6.40809536e-04 9.71138477e-04 9.81509686e-04 4.07099724e-04
 1.24275684e-03 8.27193260e-04 1.38306618e-03 8.52167606e-04
 1.08867884e-03 4.19378281e-04 1.93732977e-03 7.01367855e-04
 1.96141005e-03 8.88466835e-04 2.65890360e-03 1.05047226e-03
 1.47879124e-03 3.24839354e-03 1.87063217e-03 8.92245770e-03
 1.81536078e-02 2.03895569e-03 6.71607256e-03 1.73588395e-02
 1.87351704e-02 1.76214576e-02 5.72884083e-03 1.92123652e-02
 1.83362365e-02 5.23638725e-03 2.08377242e-02 2.27710605e-02]

- 5560 expected decrease violations (out of 71384 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-127.92602539; mean=-60.31133722; max=-0.00000000
-- Smallest suggested mesh based on expected decrease violations: 0.00000158

- 98 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999988; mean=0.83957404; max=15.75235939
-- 1 hard violations (out of 42)
-- Stats. of [V_init_mean-1] (>0 is violation): min=-0.97954261; mean=0.49655116; max=6.83147860

- 1 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-2.77362061; mean=391.89440918; max=877.16601562
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, as there are still "hard" violations that cannot be fixed with refinement

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 12 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 984
- Init. samples: 40
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.33344459533691406 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 12): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.61it/s]
Number of times the learn.train_step function was compiled: 12

Loss components in last train step:
 - 0. total: 0.4713498
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0029728555
 - 6. expDecrease counterx: 0.46837696
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22281289, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10298218, dtype=float32), Array([1.       , 0.9994835], dtype=float32)), (Array(0.34165412, dtype=float32), Array([1.], dtype=float32)), (Array(0.1708712, dtype=float32), Array([1.       , 0.9994835], dtype=float32)), (Array(1.901013, dtype=float32), None), (Array(1.8305948, dtype=float32), None), (Array(2.235873, dtype=float32), None), (Array(6.12364, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2607.8674, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1159.732, dtype=float32), Array([1.       , 0.8164305], dtype=float32)), (Array(4022.3943, dtype=float32), Array([1.], dtype=float32)), (Array(2214.45, dtype=float32), Array([1.       , 0.8164305], dtype=float32)), (Array(17820.39, dtype=float32), None), (Array(6467.732, dtype=float32), None), (Array(17590.01, dtype=float32), None), (Array(19740.197, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2432.924 (L1)
-- Lipschitz coefficient of certificate: 1159.732 (L1)
-- Lipschitz coefficient of policy: 0.103 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.10it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70878
-- Number of factors below 0.75: 177
-- Number of factors below 0.5: 171
-- Number of factors below 0.25: 148
-- Number of factors below 0.1: 138
-- Number of factors below 0.05: 127
-- Number of factors below 0.01: 97
Most violating states:
[[-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205  0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225 -0.075  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.205  0.105  0.01 ]
 [-0.205 -0.105  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [-0.215 -0.095  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.025  0.01 ]]
Corresponding V values are:
[[1.4346127e-08]
 [1.1643358e-08]
 [1.7941570e-08]
 [1.0085255e-08]
 [2.2385104e-08]
 [9.1996109e-09]
 [3.0761296e-08]
 [4.4721414e-08]
 [8.7827177e-09]
 [7.4603712e-08]
 [1.0431824e-08]
 [3.7679325e-08]
 [4.8967202e-08]
 [7.1819620e-08]
 [1.4720865e-07]
 [5.2480931e-09]
 [3.2219674e-08]
 [7.3245880e-09]
 [1.2084545e-08]
 [2.2819689e-08]
 [4.6149977e-09]
 [2.8862422e-08]
 [4.8243262e-08]
 [1.0880313e-07]
 [4.6433932e-09]
 [1.9461986e-08]
 [3.0260551e-07]
 [5.5462213e-09]
 [2.7656839e-08]
 [1.6317760e-07]
 [7.5862099e-09]
 [1.0431412e-07]
 [3.0551210e-08]
 [2.9114892e-07]
 [1.0665225e-08]
 [6.4007349e-07]
 [1.4729789e-08]
 [4.0489681e-08]
 [5.9422069e-07]
 [6.7104708e-08]
 [2.4728054e-08]
 [3.1883636e-07]
 [6.2974145e-08]
 [1.2907057e-06]
 [4.4789278e-08]
 [1.2720434e-06]
 [5.7898323e-08]
 [5.1526392e-08]
 [6.5077465e-08]
 [5.1333437e-08]
 [1.6252562e-07]
 [6.1081707e-08]
 [1.6484763e-07]
 [7.8385447e-08]
 [8.4258268e-08]
 [1.2717170e-07]
 [2.3842742e-07]
 [1.8612270e-07]
 [2.6698408e-06]
 [3.4733554e-07]
 [1.6651552e-07]
 [1.1845627e-07]
 [1.6192797e-07]
 [5.1447790e-07]
 [2.6995713e-06]
 [3.3274290e-07]
 [1.7260963e-07]
 [4.1733762e-07]
 [8.1680332e-07]
 [1.6541770e-07]
 [2.3550383e-07]
 [1.3672945e-06]
 [3.5947565e-07]
 [1.4488049e-06]
 [7.5201609e-07]
 [2.2991878e-07]
 [1.3484490e-06]
 [5.8722990e-06]
 [3.1847779e-07]
 [5.6586521e-07]
 [3.1960021e-06]
 [5.4892161e-07]
 [6.5647673e-06]
 [1.0350678e-06]
 [1.1312763e-06]
 [2.6339519e-06]
 [8.5114398e-06]
 [1.9387073e-06]
 [1.5032169e-05]
 [3.3558395e-06]
 [9.1446591e-06]
 [1.0712497e-06]
 [4.1518028e-06]
 [9.8815576e-07]
 [1.2527080e-06]
 [1.0701734e-06]
 [1.2554659e-06]
 [1.4693471e-06]
 [1.5976358e-06]
 [1.8498323e-06]]
[[7.10466395e-07]
 [8.49633523e-07]
 [7.29102112e-07]
 [1.11459076e-06]
 [8.20789637e-07]
 [1.59147100e-06]
 [1.01233331e-06]
 [1.40156089e-06]
 [2.50226117e-06]
 [1.96391125e-06]
 [4.53305802e-06]
 [1.40189877e-05]
 [1.33495914e-05]
 [1.24284625e-05]
 [2.66247730e-06]
 [1.27054054e-05]
 [1.54604586e-05]
 [1.17122236e-05]
 [1.24562057e-05]
 [1.35800819e-05]
 [1.44351943e-05]
 [1.81225332e-05]
 [1.47639348e-05]
 [1.28807342e-05]
 [1.75848763e-05]
 [8.58496423e-06]
 [4.39053383e-06]
 [2.38144421e-05]
 [2.30292535e-05]
 [1.59690171e-05]
 [3.34379802e-05]
 [2.03063955e-05]
 [3.47646055e-05]
 [2.00100221e-05]
 [4.70091327e-05]
 [8.75588103e-06]
 [6.49240756e-05]
 [5.49557808e-05]
 [2.70504188e-05]
 [3.52165516e-05]
 [9.07730209e-05]
 [4.50667503e-05]
 [8.74294201e-05]
 [2.10737417e-05]
 [1.25440551e-04]
 [4.47675484e-05]
 [3.36232537e-04]
 [3.36595142e-04]
 [3.64268548e-04]
 [3.69415677e-04]
 [1.60875497e-04]
 [4.42650198e-04]
 [4.96439170e-04]
 [4.13077243e-04]
 [5.02815412e-04]
 [4.82316362e-04]
 [5.91167540e-04]
 [6.89329405e-04]
 [6.41105798e-05]
 [5.55069593e-04]
 [7.67529826e-04]
 [5.82317822e-04]
 [8.62182002e-04]
 [6.48589397e-04]
 [1.35189461e-04]
 [5.18652902e-04]
 [9.58573597e-04]
 [2.49119359e-04]
 [7.42839242e-04]
 [7.22892000e-04]
 [1.07502472e-03]
 [2.55910330e-04]
 [1.23344595e-03]
 [8.84719833e-04]
 [5.14405896e-04]
 [1.01292483e-03]
 [6.39099919e-04]
 [2.74579012e-04]
 [1.40280474e-03]
 [1.48936827e-03]
 [1.28144911e-03]
 [1.94334262e-03]
 [5.74053440e-04]
 [2.15774518e-03]
 [4.24187584e-03]
 [3.53110721e-03]
 [2.21492792e-03]
 [2.87455576e-03]
 [1.43305282e-03]
 [3.29329353e-03]
 [2.04052008e-03]
 [1.40452394e-02]
 [2.97007780e-03]
 [1.39869619e-02]
 [1.39649045e-02]
 [1.33533962e-02]
 [1.31540187e-02]
 [1.39899617e-02]
 [1.39979739e-02]
 [1.41349249e-02]]
Softplus factor for those samples:
[9.99999997e-07 9.99999997e-07 9.99999997e-07 1.19209290e-06
 9.99999997e-07 1.60932541e-06 9.99999997e-07 1.37090683e-06
 2.50339508e-06 2.02655792e-06 4.47034836e-06 1.40070915e-05
 1.34110451e-05 1.24573708e-05 2.62260437e-06 1.26957893e-05
 1.54972076e-05 1.17421150e-05 1.25169754e-05 1.35302544e-05
 1.44243240e-05 1.81794167e-05 1.47819519e-05 1.29342079e-05
 1.75237656e-05 8.64267349e-06 4.35113907e-06 2.38418579e-05
 2.30073929e-05 1.59740448e-05 3.34382057e-05 2.03251839e-05
 3.47495079e-05 2.00271606e-05 4.69684601e-05 8.76188278e-06
 6.49094582e-05 5.48958778e-05 2.70009041e-05 3.52263451e-05
 9.07778740e-05 4.51207161e-05 8.74400139e-05 2.10404396e-05
 1.25467777e-04 4.47630882e-05 3.36229801e-04 3.36468220e-04
 3.64184380e-04 3.69369984e-04 1.60872936e-04 4.42504883e-04
 4.96327877e-04 4.12940979e-04 5.02705574e-04 4.82261181e-04
 5.90980053e-04 6.89148903e-04 6.40749931e-05 5.54919243e-04
 7.67230988e-04 5.82158566e-04 8.61883163e-04 6.48379326e-04
 1.35183334e-04 5.18500805e-04 9.58085060e-04 2.49087811e-04
 7.42554665e-04 7.22646713e-04 1.07443333e-03 2.55942345e-04
 1.23274326e-03 8.84234905e-04 5.14209270e-04 1.01232529e-03
 6.38842583e-04 2.74598598e-04 1.40178204e-03 1.48832798e-03
 1.28060579e-03 1.94144249e-03 5.73933125e-04 2.15548277e-03
 4.23282385e-03 3.52483988e-03 2.21240520e-03 2.87038088e-03
 1.43206120e-03 3.28785181e-03 2.03847885e-03 1.39470696e-02
 2.96562910e-03 1.38896108e-02 1.38678551e-02 1.32646561e-02
 1.30678415e-02 1.38925314e-02 1.39004588e-02 1.40355229e-02]

- 5495 expected decrease violations (out of 70878 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-132.56536865; mean=-61.71244997; max=-0.00000001
-- Smallest suggested mesh based on expected decrease violations: 0.00000287

- 98 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999982; mean=0.72922444; max=15.23992920
-- 0 hard violations (out of 42)

- 2 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-4.90881348; mean=409.34106445; max=932.88049316
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 13 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 981
- Init. samples: 43
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.5848305225372314 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 13): 100%|████████████████████████████████████████████████████████| 25/25 [00:16<00:00,  1.52it/s]
Number of times the learn.train_step function was compiled: 13

Loss components in last train step:
 - 0. total: 0.57552594
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0023876172
 - 6. expDecrease counterx: 0.5731383
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.21151793, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.09841788, dtype=float32), Array([1.        , 0.99774283], dtype=float32)), (Array(0.31936803, dtype=float32), Array([1.], dtype=float32)), (Array(0.15986444, dtype=float32), Array([1.        , 0.99774283], dtype=float32)), (Array(1.862327, dtype=float32), None), (Array(1.7736142, dtype=float32), None), (Array(2.1781974, dtype=float32), None), (Array(5.9082336, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2606.9646, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1154.482, dtype=float32), Array([1.0000001 , 0.81306845], dtype=float32)), (Array(4037.0352, dtype=float32), Array([1.], dtype=float32)), (Array(2226.6318, dtype=float32), Array([1.0000001 , 0.81306845], dtype=float32)), (Array(18195.936, dtype=float32), None), (Array(6977.622, dtype=float32), None), (Array(17642.268, dtype=float32), None), (Array(21569.67, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2416.905 (L1)
-- Lipschitz coefficient of certificate: 1154.482 (L1)
-- Lipschitz coefficient of policy: 0.098 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.12it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70530
-- Number of factors below 0.75: 174
-- Number of factors below 0.5: 167
-- Number of factors below 0.25: 143
-- Number of factors below 0.1: 124
-- Number of factors below 0.05: 119
-- Number of factors below 0.01: 93
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.025  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.005  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.225  0.005  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.225  0.035  0.01 ]
 [-0.225  0.075  0.01 ]]
Corresponding V values are:
[[2.2947445e-08]
 [1.8413695e-08]
 [1.4950453e-08]
 [2.8878830e-08]
 [1.2826666e-08]
 [4.1049635e-08]
 [1.1820490e-08]
 [6.2696337e-08]
 [8.6455980e-09]
 [1.4563070e-08]
 [5.5473111e-09]
 [2.8400754e-08]
 [1.2079406e-08]
 [1.0521351e-07]
 [4.1846073e-09]
 [5.9120605e-08]
 [1.9824360e-07]
 [4.2680939e-09]
 [1.8635797e-08]
 [5.5882712e-09]
 [9.7677933e-08]
 [6.6542249e-08]
 [5.1089241e-08]
 [4.2808473e-08]
 [1.2303592e-07]
 [4.3098791e-07]
 [7.6565811e-09]
 [1.5016877e-07]
 [4.0699042e-08]
 [1.0795060e-08]
 [2.2949249e-07]
 [4.1548173e-08]
 [4.2931209e-08]
 [1.5012148e-08]
 [3.9395147e-07]
 [9.0368439e-07]
 [2.6872373e-08]
 [5.0146689e-08]
 [3.3403441e-07]
 [8.0062148e-07]
 [4.0751633e-08]
 [4.8742070e-08]
 [7.2684507e-08]
 [5.0388202e-08]
 [3.4844817e-08]
 [6.8231039e-08]
 [4.4129212e-08]
 [1.8286124e-06]
 [1.3211110e-07]
 [6.0973449e-08]
 [1.7539675e-07]
 [1.5769675e-07]
 [1.8028225e-06]
 [1.2836644e-07]
 [8.4893038e-08]
 [3.4771932e-07]
 [1.1991902e-07]
 [1.6700297e-07]
 [3.9598499e-06]
 [4.4989895e-07]
 [1.4245488e-06]
 [2.3614592e-07]
 [4.0166171e-07]
 [4.4136232e-06]
 [3.3876992e-07]
 [1.3035323e-06]
 [5.6161207e-07]
 [3.2931013e-07]
 [3.3400320e-07]
 [8.0656383e-07]
 [3.3216079e-07]
 [3.8227722e-07]
 [1.1887693e-06]
 [5.0389468e-07]
 [6.0686074e-07]
 [2.1606977e-06]
 [1.3104025e-06]
 [7.9657588e-07]
 [1.2621358e-06]
 [2.1825260e-06]
 [9.8337905e-06]
 [1.1491713e-06]
 [1.2678178e-06]
 [5.2363389e-06]
 [8.1805757e-07]
 [7.0858260e-07]
 [8.9960088e-07]
 [1.0739820e-06]
 [7.7266156e-07]
 [1.1463344e-05]
 [1.0608322e-06]
 [2.5026693e-06]
 [8.2537354e-06]
 [1.3260109e-06]
 [1.4291073e-06]
 [1.8712038e-06]
 [2.9115699e-06]
 [1.0305948e-05]
 [2.6367593e-06]
 [1.7040893e-05]]
[[1.31263380e-06]
 [1.35378480e-06]
 [1.62593483e-06]
 [1.38952566e-06]
 [2.31871354e-06]
 [1.57888428e-06]
 [3.44797877e-06]
 [2.08266420e-06]
 [8.33884224e-06]
 [8.78431001e-06]
 [1.02940230e-05]
 [8.67558083e-06]
 [5.51399125e-06]
 [2.98131204e-06]
 [1.28273859e-05]
 [9.69538451e-06]
 [4.26016913e-06]
 [1.67270318e-05]
 [1.00550451e-05]
 [2.37210097e-05]
 [3.14483768e-05]
 [3.42049825e-05]
 [3.63242034e-05]
 [4.08770102e-05]
 [1.71209249e-05]
 [6.66761935e-06]
 [3.34055985e-05]
 [3.16080950e-05]
 [4.79236696e-05]
 [4.70985215e-05]
 [3.74840602e-05]
 [2.64507325e-05]
 [5.90257696e-05]
 [6.54968171e-05]
 [4.71431013e-05]
 [1.32928935e-05]
 [9.16255740e-05]
 [7.90893391e-05]
 [4.72494066e-05]
 [5.64984002e-05]
 [2.76073057e-04]
 [1.29708991e-04]
 [1.27739564e-04]
 [2.55656661e-04]
 [2.92843208e-04]
 [2.73265701e-04]
 [3.15005425e-04]
 [3.80347083e-05]
 [3.04300833e-04]
 [3.66286724e-04]
 [1.13939248e-04]
 [2.02968658e-04]
 [9.60725811e-05]
 [3.69053800e-04]
 [4.19474527e-04]
 [3.26779351e-04]
 [5.19025722e-04]
 [7.27888022e-04]
 [1.63016331e-04]
 [3.97486583e-04]
 [2.57225067e-04]
 [1.02979015e-03]
 [1.61379692e-03]
 [3.17806407e-04]
 [1.83856126e-03]
 [5.85249218e-04]
 [1.41819043e-03]
 [2.09003873e-03]
 [1.43232371e-03]
 [1.59804954e-03]
 [2.33529694e-03]
 [2.60058837e-03]
 [1.79627794e-03]
 [2.94812513e-03]
 [1.99658121e-03]
 [1.98587100e-03]
 [1.14574621e-03]
 [3.32045532e-03]
 [2.03892472e-03]
 [1.67348492e-03]
 [8.20144138e-04]
 [3.76169523e-03]
 [3.96604463e-03]
 [2.38428311e-03]
 [1.08143976e-02]
 [1.14306156e-02]
 [1.15152206e-02]
 [1.00282207e-02]
 [1.15891676e-02]
 [1.37734564e-03]
 [1.15917996e-02]
 [5.23063075e-03]
 [1.95530383e-03]
 [1.16316052e-02]
 [1.00873755e-02]
 [1.17467428e-02]
 [1.03681022e-02]
 [3.00147058e-03]
 [1.36008887e-02]
 [4.38377075e-03]]
Softplus factor for those samples:
[1.31130219e-06 1.31130219e-06 1.66893005e-06 1.37090683e-06
 2.26497650e-06 1.60932541e-06 3.45706940e-06 2.08616257e-06
 8.34465027e-06 8.76188278e-06 1.03116035e-05 8.70227814e-06
 5.54323196e-06 2.98023224e-06 1.28746033e-05 9.65595245e-06
 4.29153442e-06 1.66893005e-05 1.00135803e-05 2.37822533e-05
 3.14116478e-05 3.42130661e-05 3.63588333e-05 4.08887863e-05
 1.70469284e-05 6.61611557e-06 3.34382057e-05 3.16500664e-05
 4.79221344e-05 4.70280647e-05 3.74317169e-05 2.64644623e-05
 5.90682030e-05 6.55055046e-05 4.70876694e-05 1.33514404e-05
 9.16719437e-05 7.90953636e-05 4.72664833e-05 5.65052032e-05
 2.76029110e-04 1.29640102e-04 1.27732754e-04 2.55644321e-04
 2.92837620e-04 2.73287296e-04 3.15010548e-04 3.79681587e-05
 3.04281712e-04 3.66210938e-04 1.13904476e-04 2.02953815e-04
 9.60826874e-05 3.68952751e-04 4.19378281e-04 3.26812267e-04
 5.18918037e-04 7.27713108e-04 1.63018703e-04 3.97324562e-04
 2.57253647e-04 1.02925301e-03 1.61248446e-03 3.17752361e-04
 1.83683634e-03 5.85019588e-04 1.41721964e-03 2.08789110e-03
 1.43128633e-03 1.59680843e-03 2.33256817e-03 2.59727240e-03
 1.79469585e-03 2.94381380e-03 1.99466944e-03 1.98388100e-03
 1.14512444e-03 3.31485271e-03 2.03680992e-03 1.67202950e-03
 8.19861889e-04 3.75461578e-03 3.95816565e-03 2.38144398e-03
 1.07561350e-02 1.13655329e-02 1.14491582e-02 9.97817516e-03
 1.15222335e-02 1.37639046e-03 1.15249157e-02 5.21701574e-03
 1.95342302e-03 1.15641952e-02 1.00367069e-02 1.16780400e-02
 1.03145838e-02 2.99698114e-03 1.35089159e-02 4.37420607e-03]

- 5495 expected decrease violations (out of 70530 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-133.01391602; mean=-61.43296690; max=-0.00000002
-- Smallest suggested mesh based on expected decrease violations: 0.00000274

- 97 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999976; mean=0.84195167; max=16.93201065
-- 0 hard violations (out of 42)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=18.05895996; mean=419.33950806; max=919.74243164
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 14 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 982
- Init. samples: 42
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.6156826019287109 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 14): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.56it/s]
Number of times the learn.train_step function was compiled: 14

Loss components in last train step:
 - 0. total: 0.4973972
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.003002832
 - 6. expDecrease counterx: 0.4943944
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.21304554, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10017584, dtype=float32), Array([1.       , 0.9997798], dtype=float32)), (Array(0.31447455, dtype=float32), Array([1.], dtype=float32)), (Array(0.15725459, dtype=float32), Array([1.       , 0.9997798], dtype=float32)), (Array(1.9256035, dtype=float32), None), (Array(1.7898746, dtype=float32), None), (Array(2.196855, dtype=float32), None), (Array(5.920374, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2622.436, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1165.0469, dtype=float32), Array([1.0000001 , 0.81054974], dtype=float32)), (Array(4045.6052, dtype=float32), Array([1.], dtype=float32)), (Array(2234.4624, dtype=float32), Array([1.0000001 , 0.81054974], dtype=float32)), (Array(17601.176, dtype=float32), None), (Array(7578.5513, dtype=float32), None), (Array(17737.564, dtype=float32), None), (Array(23812.967, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2440.968 (L1)
-- Lipschitz coefficient of certificate: 1165.047 (L1)
-- Lipschitz coefficient of policy: 0.100 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.18it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70336
-- Number of factors below 0.75: 179
-- Number of factors below 0.5: 171
-- Number of factors below 0.25: 164
-- Number of factors below 0.1: 129
-- Number of factors below 0.05: 121
-- Number of factors below 0.01: 107
Most violating states:
[[-0.205 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.015  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.025  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.225 -0.065  0.01 ]]
Corresponding V values are:
[[1.9582258e-08]
 [2.4369955e-08]
 [1.6121849e-08]
 [3.0909920e-08]
 [1.3779730e-08]
 [4.3120117e-08]
 [1.2443774e-08]
 [6.6201835e-08]
 [1.2163632e-08]
 [1.2434616e-08]
 [7.4541520e-09]
 [2.3219979e-08]
 [5.1200910e-09]
 [3.9492316e-09]
 [1.0620772e-07]
 [4.8137927e-08]
 [3.5851948e-09]
 [1.6512889e-08]
 [1.9570540e-07]
 [4.1014632e-09]
 [1.0152172e-07]
 [7.2172675e-08]
 [5.6158630e-08]
 [5.4869935e-09]
 [1.0166143e-07]
 [4.6814751e-08]
 [1.5927968e-07]
 [4.1425770e-07]
 [7.5468822e-09]
 [4.2564626e-08]
 [3.3922532e-08]
 [1.0253516e-08]
 [2.4510021e-07]
 [4.3438593e-08]
 [1.7010958e-08]
 [4.0484673e-07]
 [8.8941698e-07]
 [2.7802483e-07]
 [4.9387697e-08]
 [3.0287044e-08]
 [7.8957385e-07]
 [3.8551018e-08]
 [3.3252075e-08]
 [6.8270225e-08]
 [4.6019295e-08]
 [3.2664261e-08]
 [8.2267348e-08]
 [4.2519591e-08]
 [5.8180721e-08]
 [1.4116580e-07]
 [1.8711736e-06]
 [9.9416553e-08]
 [5.7840591e-08]
 [1.7736420e-06]
 [1.2810693e-07]
 [8.0350439e-08]
 [2.4947835e-07]
 [1.1105811e-07]
 [1.1050430e-06]
 [1.5348968e-07]
 [3.7950338e-06]
 [3.5742903e-07]
 [4.2872321e-06]
 [1.0213799e-06]
 [2.0925081e-07]
 [4.0189198e-07]
 [5.6766783e-07]
 [3.3774378e-07]
 [3.2033222e-07]
 [3.5623219e-07]
 [8.1243257e-07]
 [6.1538958e-07]
 [3.1369993e-07]
 [1.2265691e-06]
 [3.5748525e-07]
 [4.8198899e-07]
 [2.0051282e-06]
 [1.0771495e-06]
 [7.2244643e-07]
 [7.5658903e-07]
 [8.8791385e-06]
 [1.6675658e-06]
 [4.6237342e-06]
 [1.1924390e-06]
 [1.0285682e-05]
 [5.5422487e-07]
 [6.2489454e-07]
 [6.1079214e-07]
 [7.2537847e-07]
 [6.5122758e-06]
 [7.9053149e-07]
 [8.8439282e-07]
 [9.9938632e-07]
 [1.1755697e-06]
 [2.1051733e-06]
 [3.9752881e-06]
 [1.2544199e-06]
 [1.6396267e-06]
 [7.5710291e-06]
 [1.9609188e-06]]
[[1.21072515e-06]
 [1.18616902e-06]
 [1.45232980e-06]
 [1.31979880e-06]
 [1.98878433e-06]
 [1.52913435e-06]
 [2.92941468e-06]
 [1.91788331e-06]
 [4.65576113e-06]
 [8.09730591e-06]
 [7.50688287e-06]
 [8.87469378e-06]
 [7.47676131e-06]
 [8.82410859e-06]
 [2.75798402e-06]
 [9.47332319e-06]
 [1.14613322e-05]
 [8.51299046e-06]
 [4.02165597e-06]
 [1.60333948e-05]
 [2.81030061e-05]
 [2.94673537e-05]
 [3.06706534e-05]
 [2.21014107e-05]
 [1.30872941e-05]
 [3.48624817e-05]
 [2.66523384e-05]
 [6.11079167e-06]
 [3.05885696e-05]
 [3.98931916e-05]
 [1.92563093e-05]
 [4.15587056e-05]
 [3.09669340e-05]
 [5.04889831e-05]
 [5.72189638e-05]
 [3.70263879e-05]
 [1.14187824e-05]
 [2.93603407e-05]
 [7.07901345e-05]
 [7.79473194e-05]
 [4.70027262e-05]
 [1.90841398e-04]
 [2.01466901e-04]
 [1.11309979e-04]
 [2.05274788e-04]
 [2.21064940e-04]
 [1.57939503e-04]
 [2.52121390e-04]
 [2.46713986e-04]
 [8.65829425e-05]
 [2.71117551e-05]
 [2.84652313e-04]
 [2.83711241e-04]
 [6.70946902e-05]
 [1.74550238e-04]
 [3.38607206e-04]
 [2.98961153e-04]
 [4.50039050e-04]
 [1.72388100e-04]
 [6.21930987e-04]
 [1.00759615e-04]
 [3.13957367e-04]
 [1.78357412e-04]
 [3.77387594e-04]
 [8.47776013e-04]
 [1.53444696e-03]
 [1.32150517e-03]
 [1.70429400e-03]
 [1.89137296e-03]
 [1.15718402e-03]
 [1.42654637e-03]
 [9.05088964e-04]
 [2.08203960e-03]
 [1.60373969e-03]
 [2.28775316e-03]
 [2.50615575e-03]
 [1.77363621e-03]
 [9.10386676e-04]
 [1.57600641e-03]
 [2.84339394e-03]
 [5.28355595e-04]
 [1.23057258e-03]
 [1.89385423e-03]
 [3.36505845e-03]
 [8.05695599e-04]
 [7.71770580e-03]
 [7.78193725e-03]
 [7.42097804e-03]
 [7.74729857e-03]
 [1.24588178e-03]
 [6.88181771e-03]
 [7.72786699e-03]
 [7.24475132e-03]
 [7.67857907e-03]
 [4.64068074e-03]
 [6.39749458e-03]
 [7.84889981e-03]
 [8.40789080e-03]
 [2.01986055e-03]
 [9.21351835e-03]]
Softplus factor for those samples:
[1.25169754e-06 1.19209290e-06 1.43051147e-06 1.31130219e-06
 2.02655792e-06 1.60932541e-06 2.98023224e-06 1.84774399e-06
 4.70876694e-06 8.16583633e-06 7.45058060e-06 8.82148743e-06
 7.45058060e-06 8.76188278e-06 2.74181366e-06 9.47713852e-06
 1.14440918e-05 8.58306885e-06 3.99351120e-06 1.60336494e-05
 2.81333923e-05 2.95042992e-05 3.06963921e-05 2.21133232e-05
 1.30534172e-05 3.48091125e-05 2.66432762e-05 6.07967377e-06
 3.05175781e-05 3.99351120e-05 1.91926956e-05 4.16040421e-05
 3.09348106e-05 5.04851341e-05 5.72800636e-05 3.70144844e-05
 1.13844872e-05 2.93850899e-05 7.08103180e-05 7.79032707e-05
 4.69684601e-05 1.90854073e-04 2.01404095e-04 1.11281872e-04
 2.05218792e-04 2.21133232e-04 1.57892704e-04 2.52127647e-04
 2.46763229e-04 8.65459442e-05 2.70605087e-05 2.84671783e-04
 2.83718109e-04 6.70552254e-05 1.74582005e-04 3.38554382e-04
 2.98976898e-04 4.49895859e-04 1.72436237e-04 6.21736050e-04
 1.00791454e-04 3.13878059e-04 1.78337097e-04 3.77297401e-04
 8.47399235e-04 1.53321028e-03 1.32060051e-03 1.70284510e-03
 1.88964605e-03 1.15650892e-03 1.42556429e-03 9.04619694e-04
 2.07984447e-03 1.60247087e-03 2.28518248e-03 2.50297785e-03
 1.77210569e-03 9.09924507e-04 1.57481432e-03 2.83944607e-03
 5.28156757e-04 1.22982264e-03 1.89203024e-03 3.35937738e-03
 8.05437565e-04 7.68804550e-03 7.75176287e-03 7.39341974e-03
 7.71737099e-03 1.24508142e-03 6.85822964e-03 7.69805908e-03
 7.21859932e-03 7.64924288e-03 4.62985039e-03 6.37698174e-03
 7.81816244e-03 8.37266445e-03 2.01779604e-03 9.17124748e-03]

- 5370 expected decrease violations (out of 70336 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-136.43524170; mean=-62.82099166; max=-0.00000002
-- Smallest suggested mesh based on expected decrease violations: 0.00000288

- 97 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999976; mean=0.64478958; max=17.34881592
-- 0 hard violations (out of 42)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=6.20458984; mean=424.04815674; max=948.16748047
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 15 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 981
- Init. samples: 43
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.0896451473236084 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 15): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.02it/s]
Number of times the learn.train_step function was compiled: 14

Loss components in last train step:
 - 0. total: 0.40855125
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0030120169
 - 6. expDecrease counterx: 0.4055392
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.21126352, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10019968, dtype=float32), Array([1.       , 0.9988642], dtype=float32)), (Array(0.30869108, dtype=float32), Array([1.], dtype=float32)), (Array(0.15443325, dtype=float32), Array([1.       , 0.9988642], dtype=float32)), (Array(1.9392518, dtype=float32), None), (Array(1.7809489, dtype=float32), None), (Array(2.191975, dtype=float32), None), (Array(5.871856, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2611.0613, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1158.6698, dtype=float32), Array([1.       , 0.8094249], dtype=float32)), (Array(4063.9468, dtype=float32), Array([1.], dtype=float32)), (Array(2245.9878, dtype=float32), Array([1.       , 0.8094249], dtype=float32)), (Array(18020.906, dtype=float32), None), (Array(8010.6045, dtype=float32), None), (Array(17820.688, dtype=float32), None), (Array(25372.95, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2427.633 (L1)
-- Lipschitz coefficient of certificate: 1158.670 (L1)
-- Lipschitz coefficient of policy: 0.100 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.13it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70045
-- Number of factors below 0.75: 174
-- Number of factors below 0.5: 167
-- Number of factors below 0.25: 145
-- Number of factors below 0.1: 129
-- Number of factors below 0.05: 118
-- Number of factors below 0.01: 96
Most violating states:
[[-0.205 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.055  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [-0.215 -0.095  0.01 ]
 [ 0.225 -0.055  0.01 ]]
Corresponding V values are:
[[1.93001117e-08]
 [2.50025565e-08]
 [1.53543791e-08]
 [1.26749340e-08]
 [3.29215197e-08]
 [1.09952145e-08]
 [4.83396079e-08]
 [1.03573186e-08]
 [7.81650797e-08]
 [1.18936292e-08]
 [1.29268159e-07]
 [7.15865411e-09]
 [1.08954463e-08]
 [3.60214045e-08]
 [1.85819164e-08]
 [5.41702994e-09]
 [2.38893335e-07]
 [5.09528775e-09]
 [7.66418253e-08]
 [7.48328688e-08]
 [1.08911095e-07]
 [5.55666411e-08]
 [5.95122573e-09]
 [2.64647397e-08]
 [4.34360210e-08]
 [3.81367862e-08]
 [1.76528786e-07]
 [7.65745778e-09]
 [4.74908944e-07]
 [3.75438809e-08]
 [1.02301136e-08]
 [2.81828136e-07]
 [1.64496015e-07]
 [1.38000882e-08]
 [4.09501624e-08]
 [2.25625225e-08]
 [4.78306958e-07]
 [9.70335918e-07]
 [5.40650404e-08]
 [1.09504313e-07]
 [3.88392252e-08]
 [9.10891060e-07]
 [8.33474942e-08]
 [5.06477988e-07]
 [5.99910663e-08]
 [1.14961757e-07]
 [2.13723638e-06]
 [4.97924262e-08]
 [4.88392224e-08]
 [7.46456976e-08]
 [1.87693729e-06]
 [6.34714468e-08]
 [8.63838210e-08]
 [9.47265235e-08]
 [2.24162818e-07]
 [1.95403288e-07]
 [1.17317519e-07]
 [1.57102463e-07]
 [4.42022429e-06]
 [5.41042027e-07]
 [2.11747476e-07]
 [4.70378654e-06]
 [4.18498985e-07]
 [3.58181438e-07]
 [6.01499323e-07]
 [3.23059595e-07]
 [2.85295499e-07]
 [3.07161628e-07]
 [1.06364337e-06]
 [3.24402293e-07]
 [8.91975446e-07]
 [3.82720430e-07]
 [8.01344925e-07]
 [4.81350980e-07]
 [8.86283260e-07]
 [1.39658528e-06]
 [5.70479017e-07]
 [2.78230709e-06]
 [2.35938705e-06]
 [2.36609753e-06]
 [8.52983305e-07]
 [9.28088127e-07]
 [1.07964488e-05]
 [5.10051359e-06]
 [1.44132594e-06]
 [1.16084730e-05]
 [3.24522034e-06]
 [5.77033461e-06]
 [1.22448978e-06]
 [1.39404779e-06]
 [1.09545897e-06]
 [1.01351463e-06]
 [1.38824873e-06]
 [1.04174535e-06]
 [1.53520741e-05]
 [1.76081983e-06]
 [2.40559575e-06]
 [1.91532240e-06]
 [6.41785891e-06]
 [2.48319338e-06]]
[[1.2273987e-06]
 [1.2831393e-06]
 [1.3300511e-06]
 [1.7378562e-06]
 [1.4639245e-06]
 [2.4429194e-06]
 [1.7154520e-06]
 [3.6845436e-06]
 [2.2081520e-06]
 [6.4281803e-06]
 [3.2899936e-06]
 [1.3659117e-05]
 [1.3055108e-05]
 [1.6674650e-05]
 [1.4436021e-05]
 [1.6261223e-05]
 [4.9537484e-06]
 [1.8916126e-05]
 [1.8259547e-05]
 [3.3428289e-05]
 [3.3015855e-05]
 [3.3252400e-05]
 [2.4928715e-05]
 [1.1096540e-05]
 [3.5422891e-05]
 [3.8667713e-05]
 [3.1782016e-05]
 [3.3303433e-05]
 [7.9189331e-06]
 [4.4444980e-05]
 [4.4628330e-05]
 [3.7360438e-05]
 [3.0688352e-05]
 [6.0201801e-05]
 [5.4016251e-05]
 [8.0802834e-05]
 [4.6926183e-05]
 [1.4925805e-05]
 [8.0375918e-05]
 [5.5223401e-05]
 [1.0665644e-04]
 [6.4541586e-05]
 [1.2022667e-04]
 [9.3872222e-05]
 [4.2105271e-04]
 [1.9012681e-04]
 [3.2696749e-05]
 [4.3415563e-04]
 [4.2315741e-04]
 [4.0615338e-04]
 [1.0086720e-04]
 [4.4885007e-04]
 [4.9993937e-04]
 [5.0732878e-04]
 [2.0551983e-04]
 [5.8835535e-04]
 [5.5586582e-04]
 [6.8513246e-04]
 [1.2534286e-04]
 [6.1981747e-04]
 [9.2333235e-04]
 [2.3471430e-04]
 [1.6415241e-03]
 [1.7297096e-03]
 [1.4835011e-03]
 [1.8346632e-03]
 [1.2438433e-03]
 [1.9312005e-03]
 [6.3405541e-04]
 [2.0237349e-03]
 [1.6035524e-03]
 [2.1215111e-03]
 [6.0819479e-04]
 [1.6628230e-03]
 [1.1101757e-03]
 [1.8449858e-03]
 [2.2414625e-03]
 [5.7706900e-04]
 [1.1350582e-03]
 [2.0902308e-03]
 [2.4766771e-03]
 [2.1896372e-03]
 [7.4407819e-04]
 [2.5007168e-03]
 [2.9037099e-03]
 [9.5482363e-04]
 [4.2828699e-03]
 [8.1777927e-03]
 [1.5570099e-02]
 [1.5127594e-02]
 [1.6335659e-02]
 [1.6725931e-02]
 [1.6223434e-02]
 [1.7100748e-02]
 [3.4158682e-03]
 [1.4872709e-02]
 [1.5312858e-02]
 [1.5777539e-02]
 [5.9805983e-03]
 [1.7194862e-02]]
Softplus factor for those samples:
[1.2516975e-06 1.3113022e-06 1.3113022e-06 1.7285347e-06 1.4305115e-06
 2.5033951e-06 1.7285347e-06 3.6358833e-06 2.2053719e-06 6.4373016e-06
 3.3378601e-06 1.3589859e-05 1.3053417e-05 1.6629696e-05 1.4424324e-05
 1.6212463e-05 4.8875809e-06 1.8954277e-05 1.8239021e-05 3.3438206e-05
 3.3020973e-05 3.3199787e-05 2.4914742e-05 1.1146069e-05 3.5345554e-05
 3.8683414e-05 3.1769276e-05 3.3378601e-05 7.8678131e-06 4.4405460e-05
 4.4643879e-05 3.7372112e-05 3.0755997e-05 6.0141087e-05 5.4001808e-05
 8.0823898e-05 4.6908855e-05 1.4901161e-05 8.0406666e-05 5.5193901e-05
 1.0663271e-04 6.4492226e-05 1.2028217e-04 9.3877316e-05 4.2098761e-04
 1.9007921e-04 3.2663345e-05 4.3410063e-04 4.2301416e-04 4.0602684e-04
 1.0085106e-04 4.4882298e-04 4.9978495e-04 5.0717592e-04 2.0551682e-04
 5.8823824e-04 5.5575371e-04 6.8485737e-04 1.2528896e-04 6.1964989e-04
 9.2285872e-04 2.3472309e-04 1.6402602e-03 1.7282367e-03 1.4823675e-03
 1.8330216e-03 1.2431145e-03 1.9292831e-03 6.3389540e-04 2.0216703e-03
 1.6022325e-03 2.1192431e-03 6.0796738e-04 1.6614795e-03 1.1095405e-03
 1.8432736e-03 2.2389293e-03 5.7691336e-04 1.1343956e-03 2.0880103e-03
 2.4736524e-03 2.1872520e-03 7.4380636e-04 2.4976134e-03 2.8994679e-03
 9.5438957e-04 4.2737722e-03 8.1444979e-03 1.5449524e-02 1.5013814e-02
 1.6203046e-02 1.6586900e-02 1.6092539e-02 1.6955316e-02 3.4099817e-03
 1.4762700e-02 1.5196264e-02 1.5653670e-02 5.9627295e-03 1.7047882e-02]

- 5197 expected decrease violations (out of 70045 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-138.57354736; mean=-63.47197759; max=-0.00000001
-- Smallest suggested mesh based on expected decrease violations: 0.00000275

- 98 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999982; mean=0.82574850; max=15.66970062
-- 0 hard violations (out of 42)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=26.70678711; mean=430.51965332; max=921.50280762
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 16 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 979
- Init. samples: 45
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.5741920471191406 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 16): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.61it/s]
Number of times the learn.train_step function was compiled: 15

Loss components in last train step:
 - 0. total: 0.24196683
 - 1. init: 0.061913252
 - 2. init counterx: 0.00027566453
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0018786258
 - 6. expDecrease counterx: 0.17789929
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22091222, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10587806, dtype=float32), Array([1.        , 0.99885696], dtype=float32)), (Array(0.3168178, dtype=float32), Array([1.], dtype=float32)), (Array(0.1584995, dtype=float32), Array([1.        , 0.99885696], dtype=float32)), (Array(2.0598767, dtype=float32), None), (Array(1.8196886, dtype=float32), None), (Array(2.2570417, dtype=float32), None), (Array(5.9545164, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2531.538, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1112.6053, dtype=float32), Array([1.        , 0.81466275], dtype=float32)), (Array(3957.622, dtype=float32), Array([1.], dtype=float32)), (Array(2180.913, dtype=float32), Array([1.        , 0.81466275], dtype=float32)), (Array(17541.955, dtype=float32), None), (Array(8458.4, dtype=float32), None), (Array(17486.4, dtype=float32), None), (Array(27145.352, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2337.121 (L1)
-- Lipschitz coefficient of certificate: 1112.605 (L1)
-- Lipschitz coefficient of policy: 0.106 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.09it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71827
-- Number of factors below 0.75: 173
-- Number of factors below 0.5: 164
-- Number of factors below 0.25: 131
-- Number of factors below 0.1: 120
-- Number of factors below 0.05: 112
-- Number of factors below 0.01: 86
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225  0.005  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.075  0.01 ]
 [-0.225 -0.075  0.01 ]]
Corresponding V values are:
[[5.8503090e-08]
 [4.5875481e-08]
 [7.6465298e-08]
 [1.0422005e-07]
 [3.6841740e-08]
 [3.1102303e-08]
 [1.6621898e-07]
 [2.9618871e-08]
 [2.6237197e-07]
 [6.6750339e-08]
 [3.5773411e-08]
 [2.2972756e-08]
 [3.2187920e-08]
 [4.5205365e-07]
 [1.7803680e-08]
 [1.3756600e-07]
 [1.7109489e-08]
 [4.2319421e-08]
 [8.6268824e-07]
 [2.0647983e-08]
 [2.9167586e-07]
 [2.6970655e-08]
 [7.5561772e-08]
 [2.3128050e-07]
 [1.7265474e-07]
 [3.5662376e-07]
 [1.3122171e-07]
 [1.1692525e-07]
 [3.6145561e-08]
 [1.7025600e-06]
 [5.5823887e-07]
 [1.1810670e-07]
 [4.7944496e-08]
 [9.0316314e-07]
 [6.5835536e-08]
 [1.2986112e-07]
 [8.1568237e-07]
 [1.1362544e-07]
 [1.5784161e-06]
 [1.6278965e-07]
 [3.6305382e-06]
 [1.5545100e-07]
 [1.9583572e-07]
 [2.5205347e-07]
 [3.5647585e-07]
 [3.3413221e-07]
 [1.9460695e-07]
 [3.2050089e-06]
 [1.3932303e-07]
 [1.6098288e-07]
 [2.0409772e-07]
 [7.8577210e-07]
 [4.1970003e-07]
 [2.7459740e-07]
 [3.9140087e-07]
 [7.7177692e-06]
 [3.7422211e-07]
 [3.3778017e-06]
 [7.5277808e-07]
 [7.8741778e-06]
 [5.0418208e-07]
 [2.4426213e-06]
 [6.7912691e-07]
 [9.0531211e-07]
 [3.1381037e-06]
 [1.2821143e-06]
 [1.6922290e-06]
 [1.3272280e-06]
 [1.2189137e-06]
 [1.1801910e-06]
 [1.2203827e-06]
 [1.3874309e-06]
 [2.2601996e-06]
 [3.0493297e-06]
 [1.8575294e-06]
 [2.2141364e-06]
 [3.7412246e-06]
 [3.1490581e-06]
 [2.6973937e-06]
 [2.0105303e-05]
 [1.9754942e-05]
 [4.8738607e-06]
 [1.4932981e-05]
 [3.9089418e-06]
 [9.0450458e-06]
 [3.7920092e-06]
 [2.5246782e-06]
 [2.2032589e-06]
 [2.2404024e-06]
 [2.9469809e-06]
 [2.8981758e-06]
 [6.5303493e-06]
 [2.2290134e-05]
 [3.3505503e-06]
 [5.3418366e-06]
 [4.0236278e-06]
 [2.6145441e-05]
 [5.1272636e-06]
 [1.6298127e-05]
 [1.1166082e-05]]
[[4.6824825e-06]
 [4.8269890e-06]
 [4.8511843e-06]
 [5.2825030e-06]
 [6.0959546e-06]
 [8.5347601e-06]
 [5.6492804e-06]
 [1.2214956e-05]
 [7.7870000e-06]
 [3.0330102e-05]
 [3.2585158e-05]
 [3.7832269e-05]
 [1.8369617e-05]
 [1.1417367e-05]
 [4.5431814e-05]
 [2.8523244e-05]
 [5.5209075e-05]
 [3.0721440e-05]
 [1.7131981e-05]
 [7.0881797e-05]
 [3.7578120e-05]
 [9.5967640e-05]
 [6.3324791e-05]
 [1.3741254e-04]
 [1.3386222e-04]
 [1.3161096e-04]
 [1.3622902e-04]
 [1.4534127e-04]
 [1.2927802e-04]
 [2.9073661e-05]
 [1.4509796e-04]
 [1.5535855e-04]
 [1.7147472e-04]
 [1.7091884e-04]
 [2.3113354e-04]
 [1.7999597e-04]
 [8.7688190e-05]
 [3.0886353e-04]
 [2.1474283e-04]
 [2.3918154e-04]
 [6.5647459e-05]
 [7.4251113e-04]
 [7.1556616e-04]
 [3.4698666e-04]
 [2.6549728e-04]
 [6.9128664e-04]
 [4.3228301e-04]
 [2.9495030e-04]
 [8.4416685e-04]
 [9.6235791e-04]
 [1.0787121e-03]
 [7.2855095e-04]
 [5.0515553e-04]
 [1.1981506e-03]
 [1.0704091e-03]
 [2.8621673e-04]
 [1.4389621e-03]
 [4.3328572e-04]
 [8.6000271e-04]
 [5.0682545e-04]
 [1.8017493e-03]
 [1.0229145e-03]
 [2.4261761e-03]
 [3.2329164e-03]
 [3.0413449e-03]
 [4.3369234e-03]
 [5.6487122e-03]
 [6.0278536e-03]
 [6.3049430e-03]
 [6.4984760e-03]
 [6.6631427e-03]
 [6.8383664e-03]
 [5.6608496e-03]
 [5.2592042e-03]
 [7.0295157e-03]
 [5.7949307e-03]
 [2.5555573e-03]
 [6.5934458e-03]
 [7.4894922e-03]
 [1.7103466e-03]
 [1.9795701e-03]
 [7.5915186e-03]
 [3.3321062e-03]
 [8.2095210e-03]
 [8.6548571e-03]
 [1.0103159e-02]
 [2.5042443e-02]
 [2.5398254e-02]
 [2.5478486e-02]
 [2.4069877e-02]
 [2.4487961e-02]
 [1.0510478e-02]
 [4.7073141e-03]
 [2.4102923e-02]
 [2.1215871e-02]
 [2.4973748e-02]
 [1.0462249e-02]
 [2.8201085e-02]
 [2.0937441e-02]
 [1.5560740e-02]]
Softplus factor for those samples:
[4.7087669e-06 4.8279762e-06 4.8279762e-06 5.2452087e-06 6.0796738e-06
 8.5830688e-06 5.6624413e-06 1.2218952e-05 7.8082085e-06 3.0338764e-05
 3.2603741e-05 3.7848949e-05 1.8358231e-05 1.1384487e-05 4.5478344e-05
 2.8550625e-05 5.5193901e-05 3.0755997e-05 1.7106533e-05 7.0869923e-05
 3.7550926e-05 9.5963478e-05 6.3359737e-05 1.3738871e-04 1.3387203e-04
 1.3160706e-04 1.3619661e-04 1.4531612e-04 1.2922287e-04 2.9087067e-05
 1.4513731e-04 1.5532970e-04 1.7142296e-04 1.7088652e-04 2.3114681e-04
 1.8000603e-04 8.7738037e-05 3.0887127e-04 2.1475554e-04 2.3913383e-04
 6.5624714e-05 7.4219704e-04 7.1531534e-04 3.4689903e-04 2.6547909e-04
 6.9099665e-04 4.3213367e-04 2.9498339e-04 8.4382296e-04 9.6189976e-04
 1.0781884e-03 7.2830915e-04 5.0503016e-04 1.1974573e-03 1.0699034e-03
 2.8616190e-04 1.4379621e-03 4.3320656e-04 8.5973740e-04 5.0669909e-04
 1.8000603e-03 1.0223389e-03 2.4232268e-03 3.2277107e-03 3.0366778e-03
 4.3275356e-03 5.6327581e-03 6.0096979e-03 6.2850714e-03 6.4774156e-03
 6.6409707e-03 6.8150163e-03 5.6448579e-03 5.2453279e-03 7.0048571e-03
 5.7781935e-03 2.5522709e-03 6.5718293e-03 7.4614882e-03 1.7089248e-03
 1.9776821e-03 7.5627565e-03 3.3265352e-03 8.1759691e-03 8.6175799e-03
 1.0052264e-02 2.4731457e-02 2.5078475e-02 2.5156617e-02 2.3782492e-02
 2.4190605e-02 1.0455489e-02 4.6962500e-03 2.3814797e-02 2.0992339e-02
 2.4664521e-02 1.0407805e-02 2.7807176e-02 2.0719826e-02 1.5440226e-02]

- 4907 expected decrease violations (out of 71827 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-140.26074219; mean=-64.38646365; max=-0.00000006
-- Smallest suggested mesh based on expected decrease violations: 0.00000324

- 99 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999934; mean=0.82492381; max=14.22196770
-- 0 hard violations (out of 43)

- 8 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-17.79052734; mean=380.10089111; max=853.51293945
-- 0 hard violations (out of 2)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 17 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 976
- Init. samples: 46
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.5936803817749023 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 17): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.59it/s]
Number of times the learn.train_step function was compiled: 16

Loss components in last train step:
 - 0. total: 0.50773454
 - 1. init: 0.16662097
 - 2. init counterx: 0.014364623
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0031057624
 - 6. expDecrease counterx: 0.32364318
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.21141584, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10161413, dtype=float32), Array([1.       , 0.9991477], dtype=float32)), (Array(0.29972798, dtype=float32), Array([1.], dtype=float32)), (Array(0.14992791, dtype=float32), Array([1.       , 0.9991477], dtype=float32)), (Array(2.0055656, dtype=float32), None), (Array(1.7728896, dtype=float32), None), (Array(2.1909552, dtype=float32), None), (Array(5.7845206, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2596.1375, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1140.2548, dtype=float32), Array([1.        , 0.81302285], dtype=float32)), (Array(4019.929, dtype=float32), Array([1.], dtype=float32)), (Array(2217.252, dtype=float32), Array([1.        , 0.81302285], dtype=float32)), (Array(16861.441, dtype=float32), None), (Array(8994.593, dtype=float32), None), (Array(17693.793, dtype=float32), None), (Array(29154.889, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2390.582 (L1)
-- Lipschitz coefficient of certificate: 1140.255 (L1)
-- Lipschitz coefficient of policy: 0.102 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.14it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70685
-- Number of factors below 0.75: 170
-- Number of factors below 0.5: 154
-- Number of factors below 0.25: 140
-- Number of factors below 0.1: 117
-- Number of factors below 0.05: 113
-- Number of factors below 0.01: 89
Most violating states:
[[-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.055  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.065  0.01 ]]
Corresponding V values are:
[[5.21875876e-08]
 [4.30635723e-08]
 [6.79036205e-08]
 [8.97509835e-08]
 [3.72955071e-08]
 [1.22056775e-07]
 [3.35143469e-08]
 [1.84052055e-07]
 [3.41393296e-08]
 [3.21365235e-07]
 [5.96071573e-07]
 [4.00130773e-08]
 [1.80385996e-07]
 [1.44234491e-07]
 [2.53847759e-07]
 [1.99706154e-08]
 [4.39960033e-08]
 [2.67414819e-08]
 [8.62205383e-08]
 [1.19645776e-07]
 [1.83184472e-08]
 [3.89712852e-07]
 [1.82223800e-07]
 [2.00970582e-08]
 [1.03497015e-07]
 [7.34689465e-08]
 [1.14344300e-06]
 [6.48661796e-07]
 [2.51083137e-08]
 [1.04463254e-07]
 [3.19526627e-08]
 [1.14322825e-06]
 [4.15323399e-07]
 [4.05104608e-08]
 [2.34528534e-06]
 [5.21739558e-08]
 [1.27658112e-07]
 [7.91259964e-08]
 [2.19525327e-06]
 [1.70902538e-07]
 [1.29755662e-07]
 [1.19815002e-06]
 [5.11502958e-06]
 [3.26623393e-07]
 [2.93507981e-07]
 [4.46596414e-06]
 [2.97641407e-07]
 [2.33066885e-07]
 [2.92279765e-07]
 [2.08797502e-07]
 [4.99238638e-07]
 [2.04715661e-07]
 [2.15882849e-07]
 [2.52531549e-07]
 [6.10547545e-07]
 [3.26877682e-07]
 [1.18800756e-06]
 [4.24835292e-07]
 [1.11023166e-06]
 [6.64814308e-07]
 [7.99498366e-07]
 [6.03030060e-07]
 [1.78552375e-06]
 [5.85406610e-07]
 [1.10194087e-05]
 [5.43943884e-07]
 [1.06307079e-05]
 [7.16080251e-07]
 [2.89732452e-06]
 [5.44969907e-06]
 [7.02110867e-07]
 [1.01616070e-06]
 [5.38785253e-06]
 [9.01442149e-07]
 [3.95663392e-06]
 [2.01464877e-06]
 [3.20130061e-06]
 [1.41866769e-06]
 [1.58085800e-06]
 [1.21565954e-05]
 [2.76843525e-06]
 [2.72183684e-06]
 [4.04339971e-06]
 [2.80388376e-05]
 [2.91617416e-05]
 [4.82591167e-06]
 [2.37532695e-05]
 [1.18008174e-05]
 [3.48547655e-06]
 [3.83285396e-06]
 [3.16285514e-06]
 [3.45929984e-05]
 [3.42089857e-06]
 [4.20755077e-06]
 [8.43020462e-06]
 [4.48245146e-06]
 [4.62486332e-06]
 [5.03189767e-06]
 [5.62017112e-06]
 [8.09434914e-06]]
[[2.68242547e-06]
 [3.20808249e-06]
 [2.45463320e-06]
 [2.73007504e-06]
 [4.23932124e-06]
 [3.37632014e-06]
 [6.45653427e-06]
 [4.38032885e-06]
 [1.12258977e-05]
 [6.12765689e-06]
 [9.27564452e-06]
 [1.95372522e-05]
 [4.52328240e-05]
 [4.76456007e-05]
 [4.55264526e-05]
 [6.33421223e-05]
 [5.27338125e-05]
 [5.66046438e-05]
 [4.88926780e-05]
 [5.25937903e-05]
 [6.85776831e-05]
 [4.49681393e-05]
 [4.72812353e-05]
 [7.43782730e-05]
 [6.25835964e-05]
 [4.98361987e-05]
 [1.63704226e-05]
 [4.81235329e-05]
 [8.63003661e-05]
 [8.87121350e-05]
 [1.10814726e-04]
 [6.47224224e-05]
 [6.23982560e-05]
 [1.40492135e-04]
 [3.25834480e-05]
 [1.80937641e-04]
 [1.33699054e-04]
 [2.31499464e-04]
 [9.48397865e-05]
 [2.09566715e-04]
 [2.94120371e-04]
 [1.42505043e-04]
 [7.94237130e-05]
 [2.53768027e-04]
 [3.68465699e-04]
 [1.83652897e-04]
 [5.39122266e-04]
 [1.08825124e-03]
 [1.04513788e-03]
 [1.16728514e-03]
 [1.10934942e-03]
 [1.28778187e-03]
 [1.38542615e-03]
 [1.50845724e-03]
 [6.52968418e-04]
 [1.61884876e-03]
 [1.18706271e-03]
 [1.74408907e-03]
 [2.01308634e-03]
 [2.26600235e-03]
 [2.15038261e-03]
 [2.37544556e-03]
 [1.90945051e-03]
 [2.48308387e-03]
 [3.59900325e-04]
 [1.89340941e-03]
 [5.58000873e-04]
 [2.61098589e-03]
 [2.16588425e-03]
 [7.47083977e-04]
 [2.43216311e-03]
 [2.87132198e-03]
 [2.45238561e-03]
 [3.12158489e-03]
 [1.63181277e-03]
 [3.13648488e-03]
 [2.72357813e-03]
 [3.99963278e-03]
 [3.42957699e-03]
 [3.29301925e-03]
 [4.84650536e-03]
 [5.04313968e-03]
 [3.32150818e-03]
 [2.71660951e-03]
 [2.48760777e-03]
 [7.34484894e-03]
 [5.51144918e-03]
 [1.88307967e-02]
 [3.23963426e-02]
 [3.04734074e-02]
 [3.40894796e-02]
 [6.31075632e-03]
 [3.48906852e-02]
 [2.86326949e-02]
 [1.29947346e-02]
 [3.42955589e-02]
 [2.93367021e-02]
 [3.18779126e-02]
 [3.47710364e-02]
 [3.27366926e-02]]
Softplus factor for those samples:
[2.68220901e-06 3.15904617e-06 2.50339508e-06 2.68220901e-06
 4.29153442e-06 3.39746475e-06 6.49690628e-06 4.35113907e-06
 1.12652779e-05 6.13927841e-06 9.23871994e-06 1.95503235e-05
 4.52399254e-05 4.76837158e-05 4.55379486e-05 6.33597374e-05
 5.26905060e-05 5.65648079e-05 4.88162041e-05 5.25712967e-05
 6.86049461e-05 4.49419022e-05 4.73260880e-05 7.43865967e-05
 6.25848770e-05 4.98890877e-05 1.63912773e-05 4.81605530e-05
 8.63671303e-05 8.86917114e-05 1.10805035e-04 6.47306442e-05
 6.24656677e-05 1.40488148e-04 3.26037407e-05 1.80900097e-04
 1.33752823e-04 2.31564045e-04 9.48309898e-05 2.09569931e-04
 2.94148922e-04 1.42514706e-04 7.94529915e-05 2.53796577e-04
 3.68416309e-04 1.83582306e-04 5.38945198e-04 1.08772516e-03
 1.04451180e-03 1.16670132e-03 1.10870600e-03 1.28698349e-03
 1.38437748e-03 1.50740147e-03 6.52730465e-04 1.61761045e-03
 1.18637085e-03 1.74260139e-03 2.01106071e-03 2.26342678e-03
 2.14815140e-03 2.37268209e-03 1.90758705e-03 2.47997046e-03
 3.59833241e-04 1.89161301e-03 5.57899475e-04 2.60764360e-03
 2.16346979e-03 7.46786594e-04 2.42918730e-03 2.86722183e-03
 2.44939327e-03 3.11672688e-03 1.63042545e-03 3.13156843e-03
 2.71987915e-03 3.99172306e-03 3.42375040e-03 3.28755379e-03
 4.83471155e-03 5.03045321e-03 3.31598520e-03 2.71296501e-03
 2.48456001e-03 7.31796026e-03 5.49626350e-03 1.86545253e-02
 3.18772197e-02 3.00137401e-02 3.35149169e-02 6.29091263e-03
 3.42890024e-02 2.82266140e-02 1.29106045e-02 3.37141752e-02
 2.89105773e-02 3.13751698e-02 3.41734886e-02 3.22067142e-02]

- 5027 expected decrease violations (out of 70685 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-141.32843018; mean=-64.34551233; max=-0.00000004
-- Smallest suggested mesh based on expected decrease violations: 0.00000328

- 100 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999946; mean=0.81599510; max=18.08403778
-- 0 hard violations (out of 43)

- 1 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-2.13281250; mean=410.94836426; max=930.19067383
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 18 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 974
- Init. samples: 48
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.6172480583190918 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 18): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 17

Loss components in last train step:
 - 0. total: 0.3747681
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002913072
 - 6. expDecrease counterx: 0.37185505
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.20892617, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10053813, dtype=float32), Array([1.        , 0.99860275], dtype=float32)), (Array(0.29275298, dtype=float32), Array([1.], dtype=float32)), (Array(0.14647883, dtype=float32), Array([1.        , 0.99860275], dtype=float32)), (Array(1.9992617, dtype=float32), None), (Array(1.747961, dtype=float32), None), (Array(2.167442, dtype=float32), None), (Array(5.6828465, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2572.3525, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1128.1598, dtype=float32), Array([0.99999994, 0.8087082 ], dtype=float32)), (Array(4015.8174, dtype=float32), Array([1.], dtype=float32)), (Array(2220.2683, dtype=float32), Array([0.99999994, 0.8087082 ], dtype=float32)), (Array(17082.014, dtype=float32), None), (Array(9489.841, dtype=float32), None), (Array(17746.154, dtype=float32), None), (Array(31007.146, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2364.072 (L1)
-- Lipschitz coefficient of certificate: 1128.160 (L1)
-- Lipschitz coefficient of policy: 0.101 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.13it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70692
-- Number of factors below 0.75: 172
-- Number of factors below 0.5: 163
-- Number of factors below 0.25: 136
-- Number of factors below 0.1: 117
-- Number of factors below 0.05: 113
-- Number of factors below 0.01: 87
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225 -0.075  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [-0.225 -0.075  0.01 ]]
Corresponding V values are:
[[7.63501689e-08]
 [5.90884781e-08]
 [1.01689352e-07]
 [4.67763677e-08]
 [4.00144522e-08]
 [1.39395610e-07]
 [3.77529155e-08]
 [2.26608222e-07]
 [3.84591175e-07]
 [4.05430782e-08]
 [2.23712320e-08]
 [6.75204248e-08]
 [3.54949528e-08]
 [1.77852844e-08]
 [6.95512483e-07]
 [1.43661623e-07]
 [1.74838188e-08]
 [5.13628180e-08]
 [1.99682919e-08]
 [3.01377469e-07]
 [2.16479492e-07]
 [4.76315051e-07]
 [1.63795804e-07]
 [1.37906216e-06]
 [2.38707631e-08]
 [1.34298702e-07]
 [3.06134552e-07]
 [3.08293728e-08]
 [1.24069260e-07]
 [1.09210006e-07]
 [7.80478445e-07]
 [3.98191631e-08]
 [1.29728932e-07]
 [5.17075414e-08]
 [1.32710397e-06]
 [2.75300431e-06]
 [7.97228665e-08]
 [7.88217335e-07]
 [1.51998918e-07]
 [2.46314335e-06]
 [1.31195691e-07]
 [2.33275017e-07]
 [5.93575442e-06]
 [3.50586276e-07]
 [2.18888246e-07]
 [1.89757827e-07]
 [4.69832855e-07]
 [1.68968640e-07]
 [8.07348044e-07]
 [4.43566449e-07]
 [5.11267399e-06]
 [1.78834128e-07]
 [5.44554268e-07]
 [1.95820235e-07]
 [2.43320414e-07]
 [3.23591507e-06]
 [3.14268277e-07]
 [4.12865091e-07]
 [2.42738292e-06]
 [9.50864035e-07]
 [5.38945017e-07]
 [6.98539679e-07]
 [1.35151076e-05]
 [1.28582124e-05]
 [1.47064088e-06]
 [1.15951502e-06]
 [1.07009998e-06]
 [8.94749519e-07]
 [2.28289173e-06]
 [1.00094201e-06]
 [9.97305051e-07]
 [3.63364188e-06]
 [1.44234616e-06]
 [1.13709882e-06]
 [1.55325597e-06]
 [1.15719185e-05]
 [6.55173289e-06]
 [2.33678361e-06]
 [5.19028026e-06]
 [2.83956228e-06]
 [3.40424890e-06]
 [3.55521433e-06]
 [1.48222261e-05]
 [1.84353430e-05]
 [2.76566448e-06]
 [2.61853870e-06]
 [7.01026420e-06]
 [2.77096819e-06]
 [3.78099935e-06]
 [6.16945317e-06]
 [3.10777932e-06]
 [3.69620357e-05]
 [3.44228829e-06]
 [3.77591350e-05]
 [1.04597984e-05]
 [3.82569624e-06]
 [4.15353725e-06]
 [4.58803243e-06]
 [5.44932527e-06]
 [1.20302157e-05]]
[[4.05912078e-06]
 [4.06877871e-06]
 [4.21864797e-06]
 [4.97338851e-06]
 [6.96433926e-06]
 [4.83143776e-06]
 [1.00257639e-05]
 [5.99994064e-06]
 [8.41758447e-06]
 [1.57198974e-05]
 [4.99443449e-05]
 [4.11160108e-05]
 [4.45633887e-05]
 [5.59782275e-05]
 [1.26537016e-05]
 [3.52323041e-05]
 [6.22300868e-05]
 [2.87471976e-05]
 [6.83560793e-05]
 [9.41990074e-05]
 [9.83100690e-05]
 [9.00725645e-05]
 [1.04167288e-04]
 [2.08549591e-05]
 [8.26834512e-05]
 [1.13771057e-04]
 [4.12084919e-05]
 [1.07623069e-04]
 [1.27827429e-04]
 [7.68297759e-05]
 [9.31644827e-05]
 [1.39003707e-04]
 [1.53299989e-04]
 [1.80500268e-04]
 [1.20982055e-04]
 [4.02233745e-05]
 [2.29503494e-04]
 [7.88004036e-05]
 [2.11251696e-04]
 [1.71224383e-04]
 [2.92224780e-04]
 [3.17580387e-04]
 [1.07236025e-04]
 [6.80135039e-04]
 [8.11485283e-04]
 [9.17223340e-04]
 [6.83880469e-04]
 [1.02684624e-03]
 [6.15354162e-04]
 [4.82886913e-04]
 [3.03769484e-04]
 [1.13481423e-03]
 [3.97718599e-04]
 [1.24763988e-03]
 [1.36750331e-03]
 [2.86015682e-04]
 [1.46882748e-03]
 [1.60472107e-03]
 [7.51906889e-04]
 [8.55642546e-04]
 [1.87975133e-03]
 [2.43571377e-03]
 [5.72250457e-04]
 [8.34309787e-04]
 [3.93294450e-03]
 [4.28418256e-03]
 [4.58214525e-03]
 [3.11880093e-03]
 [3.73864360e-03]
 [4.88578156e-03]
 [5.16766822e-03]
 [4.24683793e-03]
 [4.00686823e-03]
 [5.50098624e-03]
 [6.16185972e-03]
 [1.97202573e-03]
 [4.69766557e-03]
 [6.84699276e-03]
 [3.96397291e-03]
 [5.14491508e-03]
 [4.11558105e-03]
 [7.98985269e-03]
 [6.03845436e-03]
 [2.49919412e-03]
 [2.18782108e-02]
 [2.14370918e-02]
 [5.17405244e-03]
 [2.07215305e-02]
 [2.06341911e-02]
 [1.07705574e-02]
 [2.04607658e-02]
 [3.68629140e-03]
 [2.20480412e-02]
 [4.13072621e-03]
 [1.81010887e-02]
 [2.43831463e-02]
 [2.64058970e-02]
 [2.91282944e-02]
 [3.20306607e-02]
 [1.63680315e-02]]
Softplus factor for those samples:
[3.99351120e-06 4.05311584e-06 4.23192978e-06 4.94718552e-06
 6.97374344e-06 4.82797623e-06 1.00135803e-05 6.02006912e-06
 8.34465027e-06 1.56760216e-05 4.99486923e-05 4.11868095e-05
 4.46438789e-05 5.60283661e-05 1.26361847e-05 3.52263451e-05
 6.22272491e-05 2.87294388e-05 6.83069229e-05 9.42349434e-05
 9.82880592e-05 9.00626183e-05 1.04188919e-04 2.08616257e-05
 8.26716423e-05 1.13785267e-04 4.12464142e-05 1.07645988e-04
 1.27792358e-04 7.68303871e-05 9.31024551e-05 1.38998032e-04
 1.53362751e-04 1.80482864e-04 1.20937824e-04 4.02927399e-05
 2.29477882e-04 7.87377357e-05 2.11238861e-04 1.71244144e-04
 2.92181969e-04 3.17633152e-04 1.07288361e-04 6.79969788e-04
 8.11159611e-04 9.16779041e-04 6.83605671e-04 1.02627277e-03
 6.15179539e-04 4.82797623e-04 3.03745270e-04 1.13421679e-03
 3.97622585e-04 1.24680996e-03 1.36649609e-03 2.85983086e-04
 1.46770477e-03 1.60342455e-03 7.51614571e-04 8.55267048e-04
 1.87802315e-03 2.43270397e-03 5.72025776e-04 8.33928585e-04
 3.92520428e-03 4.27508354e-03 4.57173586e-03 3.11386585e-03
 3.73166800e-03 4.87387180e-03 5.15437126e-03 4.23783064e-03
 3.99875641e-03 5.48583269e-03 6.14297390e-03 1.97005272e-03
 4.68671322e-03 6.82365894e-03 3.95619869e-03 5.13166189e-03
 4.10711765e-03 7.95805454e-03 6.02030754e-03 2.49600410e-03
 2.16405988e-02 2.12090015e-02 5.16062975e-03 2.05082893e-02
 2.04228163e-02 1.07128024e-02 2.02528834e-02 3.67957354e-03
 2.18067169e-02 4.12225723e-03 1.79382563e-02 2.40883231e-02
 2.60602236e-02 2.87082195e-02 3.15231085e-02 1.62348151e-02]

- 4958 expected decrease violations (out of 70692 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-140.73797607; mean=-64.26229821; max=-0.00000004
-- Smallest suggested mesh based on expected decrease violations: 0.00000336

- 100 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999934; mean=0.83535695; max=17.56902504
-- 0 hard violations (out of 43)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=19.06341553; mean=412.57473755; max=906.02807617
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 19 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 974
- Init. samples: 48
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.06743931770324707 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 19): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.06it/s]
Number of times the learn.train_step function was compiled: 17

Loss components in last train step:
 - 0. total: 0.38177302
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0018056864
 - 6. expDecrease counterx: 0.37996733
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.21120766, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.1016343, dtype=float32), Array([1.       , 0.9998477], dtype=float32)), (Array(0.29171315, dtype=float32), Array([1.], dtype=float32)), (Array(0.1458677, dtype=float32), Array([1.       , 0.9998477], dtype=float32)), (Array(2.0094635, dtype=float32), None), (Array(1.7338667, dtype=float32), None), (Array(2.1578076, dtype=float32), None), (Array(5.619004, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2581.3125, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1135.7133, dtype=float32), Array([0.99999994, 0.805642  ], dtype=float32)), (Array(4025.7322, dtype=float32), Array([1.], dtype=float32)), (Array(2229.5293, dtype=float32), Array([0.99999994, 0.805642  ], dtype=float32)), (Array(16706.105, dtype=float32), None), (Array(10059.307, dtype=float32), None), (Array(17835.072, dtype=float32), None), (Array(33168.355, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2381.083 (L1)
-- Lipschitz coefficient of certificate: 1135.713 (L1)
-- Lipschitz coefficient of policy: 0.102 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.11it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70668
-- Number of factors below 0.75: 170
-- Number of factors below 0.5: 162
-- Number of factors below 0.25: 139
-- Number of factors below 0.1: 116
-- Number of factors below 0.05: 113
-- Number of factors below 0.01: 88
Most violating states:
[[-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.015  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.075  0.01 ]]
Corresponding V values are:
[[8.88364013e-08]
 [7.15532664e-08]
 [1.15379564e-07]
 [6.25425045e-08]
 [1.52497378e-07]
 [2.10127695e-07]
 [5.69701477e-08]
 [3.37284462e-07]
 [5.79200389e-07]
 [5.77351145e-08]
 [1.05832112e-06]
 [3.04461523e-08]
 [2.41424249e-08]
 [4.85681575e-08]
 [9.25777357e-08]
 [2.28500472e-08]
 [6.79808494e-08]
 [1.91798264e-07]
 [4.45802669e-07]
 [2.48006060e-08]
 [3.26867081e-07]
 [2.46648966e-07]
 [6.56276143e-07]
 [2.94347675e-08]
 [1.98857848e-07]
 [2.03218383e-06]
 [3.67994630e-08]
 [1.69711370e-07]
 [1.05082347e-06]
 [1.04003803e-07]
 [4.17880443e-07]
 [4.70175223e-08]
 [1.63347622e-07]
 [1.83833424e-06]
 [6.02301071e-08]
 [9.25420736e-08]
 [4.11441260e-06]
 [1.97774526e-07]
 [3.58963780e-06]
 [1.11521183e-06]
 [1.50540728e-07]
 [2.95144957e-07]
 [4.42144909e-07]
 [5.70568261e-07]
 [8.51405366e-06]
 [2.57286928e-07]
 [3.13687366e-07]
 [5.12865199e-07]
 [2.28683902e-07]
 [7.38271638e-06]
 [2.22594281e-07]
 [5.30694763e-07]
 [2.35407725e-07]
 [1.17845445e-06]
 [2.85901507e-07]
 [3.70686479e-07]
 [4.80257370e-07]
 [4.83364511e-06]
 [1.01599790e-06]
 [6.17770979e-07]
 [1.76323806e-06]
 [1.31460695e-06]
 [3.47876858e-06]
 [1.12724308e-06]
 [2.71010595e-06]
 [7.85962413e-07]
 [1.11034194e-06]
 [1.84735145e-05]
 [1.76501326e-05]
 [4.27582381e-06]
 [1.13227156e-06]
 [1.00675982e-06]
 [1.27427381e-06]
 [4.18158152e-06]
 [1.57903480e-06]
 [7.75111675e-06]
 [1.67536689e-06]
 [2.43430986e-06]
 [3.30112243e-06]
 [1.80200605e-05]
 [4.42693954e-06]
 [1.75462974e-05]
 [3.79196581e-06]
 [4.23958818e-06]
 [7.33153274e-06]
 [4.63029864e-05]
 [3.36716244e-06]
 [3.93620485e-06]
 [3.30947591e-06]
 [3.65511391e-06]
 [6.31285457e-06]
 [4.05225501e-06]
 [3.06790207e-05]
 [5.07073746e-05]
 [4.44525813e-06]
 [4.84233306e-06]
 [5.26301301e-06]
 [5.39632238e-05]
 [6.11479072e-06]
 [1.70457533e-05]]
[[4.61128093e-06]
 [5.24566576e-06]
 [4.61013815e-06]
 [6.84420320e-06]
 [4.89783861e-06]
 [5.74816795e-06]
 [9.52090795e-06]
 [7.02677653e-06]
 [9.59840963e-06]
 [1.65349029e-05]
 [1.41349374e-05]
 [6.23630476e-05]
 [6.90445668e-05]
 [5.77699357e-05]
 [5.26791264e-05]
 [7.58990282e-05]
 [3.19678984e-05]
 [4.84095581e-05]
 [7.30234460e-05]
 [8.09063058e-05]
 [7.46262303e-05]
 [8.05283635e-05]
 [6.98552249e-05]
 [9.68857203e-05]
 [9.83895952e-05]
 [2.38674838e-05]
 [1.23784761e-04]
 [1.21116660e-04]
 [7.26570215e-05]
 [6.71945163e-05]
 [6.22078878e-05]
 [1.58153664e-04]
 [1.49750631e-04]
 [9.41341714e-05]
 [2.02591982e-04]
 [2.56501808e-04]
 [4.83001750e-05]
 [2.03475996e-04]
 [1.33515845e-04]
 [1.23737904e-04]
 [3.23340151e-04]
 [3.00923130e-04]
 [3.17476864e-04]
 [7.71414372e-04]
 [1.25285151e-04]
 [1.09093764e-03]
 [1.00185815e-03]
 [9.55562049e-04]
 [1.22077635e-03]
 [2.39433008e-04]
 [1.34635624e-03]
 [4.64973855e-04]
 [1.44685630e-03]
 [9.06191824e-04]
 [1.56144646e-03]
 [1.68377138e-03]
 [1.81470730e-03]
 [5.05252567e-04]
 [9.08350863e-04]
 [2.07601348e-03]
 [2.91594374e-03]
 [3.06694163e-03]
 [1.21130864e-03]
 [3.16355843e-03]
 [2.77460180e-03]
 [2.64047412e-03]
 [3.24924872e-03]
 [6.41302031e-04]
 [7.40050396e-04]
 [3.22688278e-03]
 [3.53240012e-03]
 [3.38099967e-03]
 [3.88457975e-03]
 [3.39835533e-03]
 [4.21145698e-03]
 [3.69469076e-03]
 [4.79415292e-03]
 [5.96562168e-03]
 [5.54123381e-03]
 [4.55576554e-03]
 [3.22614843e-03]
 [3.35464161e-03]
 [7.49819260e-03]
 [4.97642532e-03]
 [1.01623405e-02]
 [4.03124187e-03]
 [2.73314863e-02]
 [2.70978268e-02]
 [2.68550664e-02]
 [2.66034976e-02]
 [2.48102024e-02]
 [2.71468982e-02]
 [4.71323216e-03]
 [4.72746650e-03]
 [2.73625273e-02]
 [2.93325130e-02]
 [3.18406373e-02]
 [7.28372391e-03]
 [3.45636383e-02]
 [2.41405964e-02]]
Softplus factor for those samples:
[4.64916229e-06 5.24520874e-06 4.64916229e-06 6.85453415e-06
 4.88758087e-06 5.72204590e-06 9.53674316e-06 7.03334808e-06
 9.59634781e-06 1.65104866e-05 1.41859055e-05 6.22868538e-05
 6.90817833e-05 5.77569008e-05 5.26309013e-05 7.59363174e-05
 3.20076942e-05 4.83393669e-05 7.30156898e-05 8.08835030e-05
 7.46846199e-05 8.05258751e-05 6.99162483e-05 9.69171524e-05
 9.83476639e-05 2.39014626e-05 1.23798847e-04 1.21176243e-04
 7.26580620e-05 6.72340393e-05 6.21676445e-05 1.58190727e-04
 1.49667263e-04 9.41753387e-05 2.02596188e-04 2.56478786e-04
 4.82797623e-05 2.03430653e-04 1.33514404e-04 1.23798847e-04
 3.23355198e-04 3.00884247e-04 3.17394733e-04 7.71164894e-04
 1.25229359e-04 1.09040737e-03 1.00135803e-03 9.55045223e-04
 1.22004747e-03 2.39431858e-04 1.34551525e-03 4.64916229e-04
 1.44582987e-03 9.05811787e-04 1.56021118e-03 1.68234110e-03
 1.81305408e-03 5.05089760e-04 9.07957554e-04 2.07388401e-03
 2.91162729e-03 3.06224823e-03 1.21057034e-03 3.15850973e-03
 2.77078152e-03 2.63702869e-03 3.24398279e-03 6.41047955e-04
 7.39812851e-04 3.22163105e-03 3.52615118e-03 3.37529182e-03
 3.87704372e-03 3.39263678e-03 4.20260429e-03 3.68785858e-03
 4.78267670e-03 5.94788790e-03 5.52594662e-03 4.54545021e-03
 3.22091579e-03 3.34900618e-03 7.47013092e-03 4.96399403e-03
 1.01109147e-02 4.02313471e-03 2.69613862e-02 2.67339945e-02
 2.64976621e-02 2.62527466e-02 2.45049596e-02 2.67817378e-02
 4.70221043e-03 4.71627712e-03 2.69915462e-02 2.89064646e-02
 3.13390493e-02 7.25722313e-03 3.39731574e-02 2.38516331e-02]

- 4999 expected decrease violations (out of 70668 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-142.53350830; mean=-64.77021403; max=-0.00000008
-- Smallest suggested mesh based on expected decrease violations: 0.00000344

- 99 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999923; mean=0.75339133; max=15.02707481
-- 0 hard violations (out of 42)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=5.78106689; mean=411.72402954; max=918.19848633
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 20 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 973
- Init. samples: 49
- Unsafe samples: 2
- Target samples: 0
- Initializing iteration took 0.5551586151123047 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 20): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.61it/s]
Number of times the learn.train_step function was compiled: 18

Loss components in last train step:
 - 0. total: 0.6964513
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0026832973
 - 6. expDecrease counterx: 0.693768
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.21281253, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10256645, dtype=float32), Array([1.       , 0.9997521], dtype=float32)), (Array(0.28932324, dtype=float32), Array([1.], dtype=float32)), (Array(0.14467955, dtype=float32), Array([1.       , 0.9997521], dtype=float32)), (Array(2.0207744, dtype=float32), None), (Array(1.7440889, dtype=float32), None), (Array(2.1274133, dtype=float32), None), (Array(5.626199, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2542.3953, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1117.2445, dtype=float32), Array([1.        , 0.79973996], dtype=float32)), (Array(4005.8835, dtype=float32), Array([1.], dtype=float32)), (Array(2225.8125, dtype=float32), Array([1.        , 0.79973996], dtype=float32)), (Array(16899.135, dtype=float32), None), (Array(10548.275, dtype=float32), None), (Array(17836.562, dtype=float32), None), (Array(35017.88, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2343.351 (L1)
-- Lipschitz coefficient of certificate: 1117.245 (L1)
-- Lipschitz coefficient of policy: 0.103 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:03<00:00,  1.06s/it]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71106
-- Number of factors below 0.75: 173
-- Number of factors below 0.5: 153
-- Number of factors below 0.25: 141
-- Number of factors below 0.1: 120
-- Number of factors below 0.05: 113
-- Number of factors below 0.01: 89
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.225 -0.015  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.025  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.225  0.025  0.01 ]]
Corresponding V values are:
[[9.2027740e-08]
 [7.0504157e-08]
 [1.2097371e-07]
 [5.6779655e-08]
 [1.6786122e-07]
 [4.8283312e-08]
 [2.4811047e-07]
 [4.5317069e-08]
 [4.1266236e-07]
 [4.8315460e-08]
 [7.1961824e-07]
 [3.3793290e-07]
 [1.3448928e-06]
 [6.0129103e-08]
 [4.7163306e-07]
 [2.5149643e-07]
 [3.2099084e-08]
 [4.1340591e-08]
 [3.0571258e-08]
 [6.4597884e-08]
 [1.9258493e-07]
 [1.1893374e-07]
 [7.3507988e-07]
 [3.1344566e-08]
 [1.5384258e-07]
 [1.4012228e-07]
 [2.4403781e-07]
 [3.6588730e-08]
 [1.0478213e-07]
 [1.2159854e-06]
 [4.3687447e-08]
 [2.5360248e-06]
 [1.4342548e-07]
 [5.4460614e-08]
 [5.3049490e-07]
 [6.8425884e-08]
 [2.1913900e-06]
 [1.7435688e-07]
 [9.6942578e-08]
 [5.1984639e-06]
 [1.5453514e-07]
 [2.7936943e-07]
 [4.2454226e-06]
 [1.4008418e-06]
 [4.8052124e-07]
 [3.6877188e-07]
 [5.1053115e-07]
 [3.3014217e-07]
 [3.7758616e-07]
 [2.9957846e-07]
 [9.6029780e-06]
 [4.8450067e-07]
 [1.0532621e-05]
 [3.1831257e-07]
 [3.5239034e-07]
 [8.2507313e-07]
 [9.4699527e-07]
 [4.4192819e-07]
 [5.6075578e-07]
 [1.0549322e-06]
 [1.8108040e-06]
 [1.2836938e-06]
 [9.9798433e-07]
 [2.8618852e-06]
 [1.8884353e-06]
 [7.1134980e-07]
 [9.9438194e-07]
 [6.5939439e-06]
 [1.0580658e-06]
 [8.9036752e-07]
 [4.7825647e-06]
 [1.2424034e-06]
 [1.1068191e-06]
 [4.1669791e-06]
 [2.6248642e-06]
 [1.6003853e-06]
 [9.4139004e-06]
 [1.6115058e-06]
 [5.5208570e-06]
 [2.3036946e-06]
 [2.4042454e-05]
 [2.8061061e-06]
 [3.4826123e-06]
 [4.9167688e-06]
 [2.7088263e-05]
 [2.4365652e-05]
 [6.3883404e-06]
 [3.0438185e-05]
 [1.4844578e-05]
 [1.2144288e-05]
 [6.1445799e-06]
 [5.3284652e-06]
 [5.2701148e-06]
 [6.1412529e-06]
 [5.3590934e-06]
 [5.7936209e-06]
 [7.8808116e-06]
 [6.5874196e-06]
 [4.6957073e-05]
 [7.1955587e-06]]
[[4.49215804e-06]
 [4.59236617e-06]
 [4.51977166e-06]
 [5.33896446e-06]
 [4.93920516e-06]
 [7.09692449e-06]
 [6.17224850e-06]
 [9.91510569e-06]
 [7.63757271e-06]
 [1.63026034e-05]
 [1.06940679e-05]
 [7.09345404e-05]
 [1.62916931e-05]
 [3.03916022e-05]
 [6.98638178e-05]
 [7.44222561e-05]
 [9.22133258e-05]
 [8.28790726e-05]
 [9.88536340e-05]
 [8.19469860e-05]
 [8.19638590e-05]
 [7.97107641e-05]
 [6.86992353e-05]
 [1.05962492e-04]
 [9.85118386e-05]
 [1.20177836e-04]
 [8.45218674e-05]
 [1.16443480e-04]
 [6.54547403e-05]
 [7.70189654e-05]
 [1.43790385e-04]
 [2.97167389e-05]
 [1.46396778e-04]
 [1.79245413e-04]
 [1.19319564e-04]
 [2.25203898e-04]
 [1.00123427e-04]
 [1.90922379e-04]
 [2.79793923e-04]
 [6.78619326e-05]
 [3.46449640e-04]
 [2.73551414e-04]
 [1.56269962e-04]
 [2.28740115e-04]
 [3.00567248e-04]
 [5.17867506e-04]
 [4.13340807e-04]
 [1.88655232e-03]
 [1.79737795e-03]
 [1.92469801e-03]
 [3.44732834e-04]
 [1.75108435e-03]
 [2.90190510e-04]
 [1.92857021e-03]
 [2.03421293e-03]
 [1.71617290e-03]
 [7.64121185e-04]
 [2.12399731e-03]
 [2.24335375e-03]
 [2.65817577e-03]
 [2.48670764e-03]
 [2.58703064e-03]
 [2.76882993e-03]
 [2.42258632e-03]
 [1.74350908e-03]
 [2.39527668e-03]
 [2.82485993e-03]
 [9.39957565e-04]
 [3.02428915e-03]
 [2.92643113e-03]
 [2.71534221e-03]
 [3.41944094e-03]
 [3.63656529e-03]
 [2.90931319e-03]
 [2.78093759e-03]
 [4.15787334e-03]
 [3.17642721e-03]
 [4.48194239e-03]
 [2.32172804e-03]
 [5.15746418e-03]
 [1.58642652e-03]
 [5.53291896e-03]
 [6.34040032e-03]
 [3.21633532e-03]
 [1.96075859e-03]
 [4.32670675e-03]
 [8.09902139e-03]
 [5.90408593e-03]
 [1.72481406e-02]
 [1.16709834e-02]
 [4.21144180e-02]
 [4.32726853e-02]
 [4.45256457e-02]
 [4.43772674e-02]
 [4.48076017e-02]
 [4.50588129e-02]
 [3.88705842e-02]
 [4.42108549e-02]
 [8.53313692e-03]
 [4.43692394e-02]]
Softplus factor for those samples:
[4.47034836e-06 4.64916229e-06 4.47034836e-06 5.30481339e-06
 4.88758087e-06 7.03334808e-06 6.13927841e-06 9.95397568e-06
 7.68899918e-06 1.63912773e-05 1.07288361e-05 7.09295273e-05
 1.62124634e-05 3.03983688e-05 6.99162483e-05 7.43865967e-05
 9.22083855e-05 8.29100609e-05 9.88245010e-05 8.20159912e-05
 8.20159912e-05 7.96914101e-05 6.86645508e-05 1.05977058e-04
 9.85264778e-05 1.20103359e-04 8.44597816e-05 1.16467476e-04
 6.55055046e-05 7.70092010e-05 1.43826008e-04 2.96831131e-05
 1.46389008e-04 1.79171562e-04 1.19268894e-04 2.25186348e-04
 1.00076199e-04 1.90913677e-04 2.79843807e-04 6.78300858e-05
 3.46362591e-04 2.73525715e-04 1.56223774e-04 2.28703022e-04
 3.00467014e-04 5.17725945e-04 4.13239002e-04 1.88487768e-03
 1.79570913e-03 1.92278624e-03 3.44634056e-04 1.74957514e-03
 2.90215015e-04 1.92672014e-03 2.03210115e-03 1.71458721e-03
 7.63833523e-04 2.12174654e-03 2.24089622e-03 2.65467167e-03
 2.48366594e-03 2.58374214e-03 2.76499987e-03 2.41965055e-03
 1.74194574e-03 2.39241123e-03 2.82084942e-03 9.39488411e-04
 3.01975012e-03 2.92223692e-03 2.71165371e-03 3.41355801e-03
 3.62992287e-03 2.90507078e-03 2.77709961e-03 4.14925814e-03
 3.17138433e-03 4.47189808e-03 2.31903791e-03 5.14417887e-03
 1.58512592e-03 5.51766157e-03 6.32035732e-03 3.21114063e-03
 1.95878744e-03 4.31740284e-03 8.06629658e-03 5.88667393e-03
 1.71002150e-02 1.16031170e-02 4.12399769e-02 4.23497558e-02
 4.35489416e-02 4.34069633e-02 4.38185930e-02 4.40587997e-02
 3.81247997e-02 4.32477593e-02 8.49682093e-03 4.33993340e-02]

- 4865 expected decrease violations (out of 71106 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-144.02075195; mean=-64.93074378; max=-0.00000004
-- Smallest suggested mesh based on expected decrease violations: 0.00000334

- 97 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999928; mean=0.65420151; max=13.44212627
-- 0 hard violations (out of 41)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=6.78674316; mean=401.25421143; max=874.38159180
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 21 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 975
- Init. samples: 49
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.33468174934387207 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 21): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 19

Loss components in last train step:
 - 0. total: 0.5554252
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002574277
 - 6. expDecrease counterx: 0.55285096
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22074507, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10648794, dtype=float32), Array([1.       , 0.9984442], dtype=float32)), (Array(0.29593918, dtype=float32), Array([1.], dtype=float32)), (Array(0.14808477, dtype=float32), Array([1.       , 0.9984442], dtype=float32)), (Array(2.102308, dtype=float32), None), (Array(1.7662394, dtype=float32), None), (Array(2.1644719, dtype=float32), None), (Array(5.661323, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2567.167, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1126.7074, dtype=float32), Array([1.       , 0.7959079], dtype=float32)), (Array(4024.1133, dtype=float32), Array([0.99999994], dtype=float32)), (Array(2240.7124, dtype=float32), Array([1.       , 0.7959079], dtype=float32)), (Array(16230.659, dtype=float32), None), (Array(10914.287, dtype=float32), None), (Array(17940.08, dtype=float32), None), (Array(36508.61, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2367.396 (L1)
-- Lipschitz coefficient of certificate: 1126.707 (L1)
-- Lipschitz coefficient of policy: 0.106 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.08it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70843
-- Number of factors below 0.75: 172
-- Number of factors below 0.5: 148
-- Number of factors below 0.25: 140
-- Number of factors below 0.1: 118
-- Number of factors below 0.05: 97
-- Number of factors below 0.01: 86
Most violating states:
[[-0.205 -0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.005  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225 -0.025  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.035  0.01 ]]
Corresponding V values are:
[[9.76233636e-08]
 [1.25739518e-07]
 [8.01471742e-08]
 [1.64924998e-07]
 [6.85486725e-08]
 [2.27949243e-07]
 [3.33253581e-07]
 [6.37035811e-08]
 [5.09614665e-07]
 [6.67593767e-08]
 [9.29719022e-07]
 [8.19997794e-08]
 [1.75996365e-06]
 [4.72703874e-07]
 [3.59028547e-07]
 [4.90889569e-08]
 [4.70884238e-08]
 [5.92855827e-08]
 [6.63052163e-07]
 [2.75652411e-07]
 [9.03376574e-08]
 [1.65032617e-07]
 [2.17905594e-07]
 [4.72282018e-08]
 [9.74423642e-07]
 [1.23795999e-07]
 [1.95588228e-07]
 [5.44721424e-08]
 [3.31660033e-07]
 [3.36114999e-06]
 [1.61201149e-06]
 [6.58719586e-08]
 [2.03413336e-07]
 [8.10851120e-08]
 [2.93431049e-06]
 [9.83265522e-08]
 [7.20107039e-07]
 [2.45912190e-07]
 [1.38790341e-07]
 [6.70521013e-06]
 [2.17841375e-07]
 [3.92715094e-07]
 [5.71484179e-06]
 [5.39222128e-07]
 [1.89934644e-06]
 [5.05986520e-07]
 [7.05865148e-07]
 [1.35491900e-05]
 [1.23852415e-05]
 [5.06873732e-07]
 [5.80518190e-07]
 [4.54012564e-07]
 [4.69273573e-07]
 [7.42124428e-07]
 [5.29275042e-07]
 [1.29844045e-06]
 [6.60809917e-07]
 [1.25772135e-06]
 [8.22664106e-07]
 [1.02851936e-06]
 [2.78954985e-06]
 [1.69643033e-06]
 [2.01418970e-06]
 [3.92482889e-06]
 [2.64295477e-06]
 [1.53618680e-06]
 [1.24756355e-06]
 [1.45712727e-06]
 [8.99359293e-06]
 [4.81205143e-06]
 [1.57553757e-06]
 [6.51566779e-06]
 [1.53421615e-06]
 [1.82242331e-06]
 [3.58291049e-06]
 [2.24072937e-06]
 [2.25088343e-06]
 [1.25187516e-05]
 [3.03708566e-05]
 [8.03224702e-06]
 [3.20740310e-06]
 [5.36887410e-06]
 [3.41331324e-05]
 [3.71393048e-06]
 [4.99668840e-06]
 [3.18677849e-05]
 [9.15437158e-06]
 [1.97431509e-05]
 [4.05728752e-05]
 [1.71299725e-05]
 [7.92329865e-06]
 [9.06791593e-06]
 [8.64430422e-06]
 [8.12024973e-06]
 [7.42617885e-06]
 [7.52206142e-06]
 [9.20923776e-06]
 [1.18293929e-05]
 [1.00635443e-05]
 [1.24598409e-05]]
[[6.04848128e-06]
 [5.98033557e-06]
 [6.76498212e-06]
 [6.09141625e-06]
 [8.84509609e-06]
 [6.89109083e-06]
 [8.55049166e-06]
 [1.29388700e-05]
 [1.12844591e-05]
 [2.10478520e-05]
 [1.44550468e-05]
 [3.91475442e-05]
 [2.15101281e-05]
 [1.14862625e-04]
 [1.17547221e-04]
 [1.37937561e-04]
 [1.44202320e-04]
 [1.28963657e-04]
 [1.16292562e-04]
 [1.20983328e-04]
 [1.26938598e-04]
 [1.21741723e-04]
 [1.36460978e-04]
 [1.53046713e-04]
 [1.19721204e-04]
 [8.18306216e-05]
 [1.64010518e-04]
 [1.70749394e-04]
 [1.33190682e-04]
 [3.84165251e-05]
 [1.17531083e-04]
 [2.09997015e-04]
 [1.96309702e-04]
 [2.58489890e-04]
 [1.38006129e-04]
 [3.13445285e-04]
 [1.90372099e-04]
 [2.43144183e-04]
 [3.83070204e-04]
 [8.50930010e-05]
 [4.67178412e-04]
 [3.45579436e-04]
 [2.01421964e-04]
 [3.73866205e-04]
 [3.90912872e-04]
 [8.04718875e-04]
 [5.40690206e-04]
 [3.37189238e-04]
 [4.29169595e-04]
 [2.68374989e-03]
 [2.58421944e-03]
 [2.68268446e-03]
 [2.70212349e-03]
 [2.56658066e-03]
 [2.82411231e-03]
 [1.00245606e-03]
 [2.93627381e-03]
 [2.54981942e-03]
 [3.04420921e-03]
 [3.27386032e-03]
 [2.66847061e-03]
 [4.70681256e-03]
 [4.63368744e-03]
 [4.38770233e-03]
 [4.52082278e-03]
 [4.83721914e-03]
 [3.96971405e-03]
 [4.89833346e-03]
 [1.63408450e-03]
 [3.72046861e-03]
 [5.00322087e-03]
 [4.21843445e-03]
 [4.87961294e-03]
 [5.31471055e-03]
 [4.11306508e-03]
 [5.93813695e-03]
 [5.80276316e-03]
 [4.61364817e-03]
 [1.89858756e-03]
 [3.63550778e-03]
 [7.06789782e-03]
 [3.49179865e-03]
 [2.19232356e-03]
 [7.22385757e-03]
 [8.55802093e-03]
 [5.84100047e-03]
 [1.04414364e-02]
 [2.57036798e-02]
 [1.00647174e-02]
 [1.51835158e-02]
 [5.86647838e-02]
 [5.68372682e-02]
 [5.78092411e-02]
 [5.84538095e-02]
 [5.94821759e-02]
 [5.89483827e-02]
 [5.72174937e-02]
 [5.26290350e-02]
 [5.62719405e-02]
 [5.62908910e-02]]
Softplus factor for those samples:
[6.07967377e-06 6.02006912e-06 6.79492950e-06 6.07967377e-06
 8.82148743e-06 6.91413879e-06 8.58306885e-06 1.29938126e-05
 1.12652779e-05 2.09808350e-05 1.44243240e-05 3.91602516e-05
 2.14576721e-05 1.14858150e-04 1.17480755e-04 1.37865543e-04
 1.44243240e-04 1.28984451e-04 1.16348267e-04 1.20937824e-04
 1.26957893e-04 1.21712685e-04 1.36494637e-04 1.53005123e-04
 1.19686127e-04 8.17775726e-05 1.63972378e-04 1.70767307e-04
 1.33156776e-04 3.83853912e-05 1.17480755e-04 2.09987164e-04
 1.96337700e-04 2.58505344e-04 1.37925148e-04 3.13401222e-04
 1.90377235e-04 2.43067741e-04 3.82959843e-04 8.51154327e-05
 4.67121601e-04 3.45468521e-04 2.01344490e-04 3.73780727e-04
 3.90768051e-04 8.04364681e-04 5.40554523e-04 3.37123871e-04
 4.29034233e-04 2.68012285e-03 2.58088112e-03 2.67910957e-03
 2.69842148e-03 2.56323814e-03 2.82007456e-03 1.00189447e-03
 2.93189287e-03 2.54660845e-03 3.03959846e-03 3.26848030e-03
 2.66492367e-03 4.69577312e-03 4.62287664e-03 4.37808037e-03
 4.51064110e-03 4.82559204e-03 3.96186113e-03 4.88638878e-03
 1.63280964e-03 3.71348858e-03 4.99069691e-03 4.20945883e-03
 4.86779213e-03 5.30058146e-03 4.10461426e-03 5.92058897e-03
 5.78594208e-03 4.60296869e-03 1.89673901e-03 3.62890959e-03
 7.04294443e-03 3.48573923e-03 2.18993425e-03 7.19779730e-03
 8.52143764e-03 5.82396984e-03 1.03871822e-02 2.53760815e-02
 1.00142956e-02 1.50687695e-02 5.69771528e-02 5.52522540e-02
 5.61699867e-02 5.67781925e-02 5.77476621e-02 5.72445989e-02
 5.56113124e-02 5.12681007e-02 5.47180176e-02 5.47358990e-02]

- 4745 expected decrease violations (out of 70843 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-146.38964844; mean=-65.94832820; max=-0.00000008
-- Smallest suggested mesh based on expected decrease violations: 0.00000405

- 99 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999905; mean=0.80422133; max=15.88015366
-- 0 hard violations (out of 43)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=9.44799805; mean=408.61727905; max=906.87780762
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 22 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 974
- Init. samples: 50
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.3106715679168701 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 22): 100%|████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.68it/s]
Number of times the learn.train_step function was compiled: 20

Loss components in last train step:
 - 0. total: 0.31431538
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0029676154
 - 6. expDecrease counterx: 0.31134775
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22804603, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10935506, dtype=float32), Array([1.       , 0.9986344], dtype=float32)), (Array(0.29978502, dtype=float32), Array([1.], dtype=float32)), (Array(0.14999492, dtype=float32), Array([1.       , 0.9986344], dtype=float32)), (Array(2.1577318, dtype=float32), None), (Array(1.7951609, dtype=float32), None), (Array(2.1773863, dtype=float32), None), (Array(5.7265596, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2545.285, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1115.7535, dtype=float32), Array([1.      , 0.794719], dtype=float32)), (Array(4021.768, dtype=float32), Array([1.], dtype=float32)), (Array(2240.8904, dtype=float32), Array([1.      , 0.794719], dtype=float32)), (Array(16534.32, dtype=float32), None), (Array(11319.133, dtype=float32), None), (Array(17975.354, dtype=float32), None), (Array(38016.19, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2347.420 (L1)
-- Lipschitz coefficient of certificate: 1115.754 (L1)
-- Lipschitz coefficient of policy: 0.109 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.08it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70889
-- Number of factors below 0.75: 170
-- Number of factors below 0.5: 148
-- Number of factors below 0.25: 122
-- Number of factors below 0.1: 114
-- Number of factors below 0.05: 110
-- Number of factors below 0.01: 72
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.075  0.01 ]]
Corresponding V values are:
[[1.78978297e-07]
 [1.36636899e-07]
 [2.39912737e-07]
 [1.10723924e-07]
 [3.33984730e-07]
 [9.30766646e-08]
 [5.00824683e-07]
 [9.00864450e-08]
 [7.78494382e-07]
 [1.33120841e-06]
 [1.00300880e-07]
 [4.47718556e-08]
 [4.19353441e-08]
 [5.66258613e-08]
 [9.01318202e-08]
 [1.77976787e-07]
 [4.09510221e-08]
 [2.61648415e-06]
 [4.53456863e-08]
 [1.24772669e-07]
 [3.94010840e-07]
 [5.22750554e-08]
 [6.18857001e-08]
 [7.62009051e-08]
 [1.92785791e-07]
 [5.05270964e-06]
 [5.15746819e-07]
 [9.85757538e-07]
 [3.82104787e-07]
 [6.96490872e-07]
 [3.10360292e-07]
 [1.46445495e-06]
 [1.13358205e-07]
 [3.00128647e-07]
 [9.44247461e-07]
 [2.30106207e-06]
 [3.20441302e-07]
 [1.81443454e-07]
 [4.12122199e-06]
 [4.02438531e-07]
 [9.66396328e-06]
 [7.10887264e-07]
 [3.07902201e-06]
 [8.55831104e-07]
 [6.72644546e-07]
 [8.52820267e-06]
 [4.29150475e-07]
 [4.87683053e-07]
 [3.78195921e-07]
 [6.08421885e-07]
 [3.67155536e-07]
 [4.22052125e-07]
 [1.16679848e-06]
 [1.16846218e-06]
 [5.24845234e-07]
 [6.43170949e-07]
 [2.06448694e-05]
 [7.94013829e-07]
 [3.03878892e-06]
 [2.03869627e-06]
 [9.71683335e-07]
 [1.93486994e-05]
 [1.19254480e-06]
 [1.84171392e-06]
 [6.94060918e-06]
 [1.09365028e-05]
 [3.94501421e-06]
 [1.79065828e-05]
 [3.03072284e-06]
 [3.21206221e-06]
 [3.47739501e-06]
 [2.98935493e-06]
 [3.98441625e-06]
 [3.24717985e-06]
 [4.71313069e-06]
 [3.81515201e-06]
 [6.28155385e-06]
 [9.86326359e-06]
 [7.55216433e-06]
 [5.20917320e-06]
 [6.00350677e-06]
 [4.87762954e-05]
 [1.99944188e-05]
 [7.84418989e-06]
 [5.35344043e-05]
 [1.36854815e-05]
 [5.53882164e-05]
 [6.05066225e-06]
 [5.61741126e-06]
 [6.45950286e-06]
 [6.03628223e-06]
 [7.13606414e-06]
 [6.88958607e-06]
 [7.27288307e-06]
 [7.96241511e-06]
 [8.79845356e-06]
 [9.86414852e-06]
 [1.77705733e-05]
 [7.14775015e-05]
 [2.44323383e-05]]
[[1.19561009e-05]
 [1.18977969e-05]
 [1.28928523e-05]
 [1.31209354e-05]
 [1.45042459e-05]
 [1.69385748e-05]
 [1.65786405e-05]
 [2.38767279e-05]
 [2.06543991e-05]
 [2.79876804e-05]
 [3.72756658e-05]
 [1.15673392e-04]
 [1.22039288e-04]
 [1.11624504e-04]
 [1.14254020e-04]
 [1.03607752e-04]
 [1.28428816e-04]
 [3.89293091e-05]
 [1.44590085e-04]
 [6.50604270e-05]
 [1.01226520e-04]
 [1.76541944e-04]
 [2.12370840e-04]
 [2.61489331e-04]
 [1.18553413e-04]
 [6.62040475e-05]
 [3.03928507e-04]
 [3.35159566e-04]
 [3.07351700e-04]
 [3.21905100e-04]
 [3.13366996e-04]
 [3.42885032e-04]
 [3.16137128e-04]
 [3.19369050e-04]
 [1.65668869e-04]
 [3.46999441e-04]
 [3.44868575e-04]
 [3.82594735e-04]
 [3.72091396e-04]
 [4.01485100e-04]
 [1.52890643e-04]
 [1.05001510e-03]
 [5.08517842e-04]
 [5.19603665e-04]
 [5.44861367e-04]
 [4.80596325e-04]
 [2.14567594e-03]
 [2.09002686e-03]
 [2.18008272e-03]
 [2.20330805e-03]
 [2.29818630e-03]
 [2.38932576e-03]
 [2.14000093e-03]
 [8.14613362e-04]
 [2.46809213e-03]
 [2.51250132e-03]
 [6.72081194e-04]
 [2.72137439e-03]
 [2.04208470e-03]
 [1.44522532e-03]
 [3.32929986e-03]
 [9.44735366e-04]
 [4.08449909e-03]
 [4.92025632e-03]
 [4.67519974e-03]
 [3.72768613e-03]
 [7.06305029e-03]
 [2.85296887e-03]
 [1.16768535e-02]
 [1.18625425e-02]
 [1.20083494e-02]
 [1.15295984e-02]
 [1.19986366e-02]
 [1.12717338e-02]
 [1.19413156e-02]
 [1.15147782e-02]
 [1.21049136e-02]
 [1.18053127e-02]
 [4.57652891e-03]
 [1.18420981e-02]
 [7.08854198e-03]
 [3.64613067e-03]
 [1.10808210e-02]
 [1.22884056e-02]
 [4.44861362e-03]
 [1.40233636e-02]
 [1.36110634e-02]
 [4.81303446e-02]
 [4.87192795e-02]
 [4.75370102e-02]
 [4.85046767e-02]
 [4.76960987e-02]
 [4.66258042e-02]
 [4.56613600e-02]
 [4.58193794e-02]
 [4.55373786e-02]
 [4.71302643e-02]
 [4.36576717e-02]
 [1.53662954e-02]
 [1.95367355e-02]]
Softplus factor for those samples:
[1.20401382e-05 1.18613243e-05 1.29342079e-05 1.31130219e-05
 1.44839287e-05 1.69277191e-05 1.65700912e-05 2.39014626e-05
 2.06828117e-05 2.79545784e-05 3.73125076e-05 1.15633011e-04
 1.22070312e-04 1.11639500e-04 1.14262104e-04 1.03592873e-04
 1.28388405e-04 3.89814377e-05 1.44600868e-04 6.50882721e-05
 1.01268291e-04 1.76548958e-04 2.12430954e-04 2.61545181e-04
 1.18553638e-04 6.61611557e-05 3.03864479e-04 3.35097313e-04
 3.07321548e-04 3.21924686e-04 3.13341618e-04 3.42845917e-04
 3.16083431e-04 3.19361687e-04 1.65641308e-04 3.46899033e-04
 3.44753265e-04 3.82483006e-04 3.71992588e-04 4.01437283e-04
 1.52945518e-04 1.04951859e-03 5.08427620e-04 5.19454479e-04
 5.44667244e-04 4.80532646e-04 2.14338303e-03 2.08789110e-03
 2.17771530e-03 2.20084190e-03 2.29561329e-03 2.38656998e-03
 2.13772058e-03 8.14259052e-04 2.46506929e-03 2.50935555e-03
 6.71863556e-04 2.71773338e-03 2.03996897e-03 1.44416094e-03
 3.32379341e-03 9.44256783e-04 4.07612324e-03 4.90814447e-03
 4.66430187e-03 3.72076035e-03 7.03811646e-03 2.84898281e-03
 1.16090178e-02 1.17925406e-02 1.19366050e-02 1.14633441e-02
 1.19269490e-02 1.12084150e-02 1.18702650e-02 1.14487410e-02
 1.20319128e-02 1.17359757e-02 4.56613302e-03 1.17722154e-02
 7.06350803e-03 3.63945961e-03 1.10196471e-02 1.22132301e-02
 4.43869829e-03 1.39254332e-02 1.35188699e-02 4.69905138e-02
 4.75515723e-02 4.64247465e-02 4.73470688e-02 4.65764999e-02
 4.55555916e-02 4.46345806e-02 4.47855592e-02 4.45161462e-02
 4.60368991e-02 4.27184105e-02 1.52488351e-02 1.93470716e-02]

- 4541 expected decrease violations (out of 70889 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-148.76104736; mean=-67.00089975; max=-0.00000011
-- Smallest suggested mesh based on expected decrease violations: 0.00000374

- 102 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999845; mean=0.89120352; max=15.42772293
-- 0 hard violations (out of 45)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=9.63281250; mean=406.56448364; max=873.33142090
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 23 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 974
- Init. samples: 50
- Unsafe samples: 0
- Target samples: 0
- Initializing iteration took 0.06490421295166016 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 23): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.07it/s]
Number of times the learn.train_step function was compiled: 20

Loss components in last train step:
 - 0. total: 0.5345361
 - 1. init: 0.09145033
 - 2. init counterx: 0.00053158257
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0024486694
 - 6. expDecrease counterx: 0.44010556
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.2232967, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.1063782, dtype=float32), Array([1.        , 0.99907523], dtype=float32)), (Array(0.2897578, dtype=float32), Array([1.], dtype=float32)), (Array(0.14494592, dtype=float32), Array([1.        , 0.99907523], dtype=float32)), (Array(2.1061487, dtype=float32), None), (Array(1.7579582, dtype=float32), None), (Array(2.1201985, dtype=float32), None), (Array(5.5944014, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2567.4714, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1126.168, dtype=float32), Array([1.       , 0.7896963], dtype=float32)), (Array(4036.1655, dtype=float32), Array([1.], dtype=float32)), (Array(2255.2239, dtype=float32), Array([1.       , 0.7896963], dtype=float32)), (Array(16152.734, dtype=float32), None), (Array(11754.754, dtype=float32), None), (Array(18052.973, dtype=float32), None), (Array(39702.164, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2366.146 (L1)
-- Lipschitz coefficient of certificate: 1126.168 (L1)
-- Lipschitz coefficient of policy: 0.106 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.11it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 70814
-- Number of factors below 0.75: 168
-- Number of factors below 0.5: 144
-- Number of factors below 0.25: 122
-- Number of factors below 0.1: 112
-- Number of factors below 0.05: 94
-- Number of factors below 0.01: 77
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.205 -0.095  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.215  0.085  0.01 ]]
Corresponding V values are:
[[2.54508279e-07]
 [1.96252643e-07]
 [3.44422915e-07]
 [1.57620505e-07]
 [4.75401066e-07]
 [1.36344809e-07]
 [6.87957822e-07]
 [1.28034628e-07]
 [1.06391610e-06]
 [1.81757207e-06]
 [1.36760875e-07]
 [3.55607926e-06]
 [1.66046931e-07]
 [6.69949259e-07]
 [9.31999693e-07]
 [5.16589068e-07]
 [1.13173712e-07]
 [1.00021573e-07]
 [1.34351217e-06]
 [1.41705328e-07]
 [2.33409878e-07]
 [4.24371649e-07]
 [9.78332508e-08]
 [4.97894007e-07]
 [2.42305447e-07]
 [1.00186156e-07]
 [2.00788554e-06]
 [3.87670383e-07]
 [1.15420065e-07]
 [6.93967559e-06]
 [3.14867384e-06]
 [1.37514718e-07]
 [4.20390222e-07]
 [1.15913804e-06]
 [1.67440732e-07]
 [2.03387145e-07]
 [5.76167986e-06]
 [5.32634203e-07]
 [2.83627628e-07]
 [1.01167893e-06]
 [1.34562169e-05]
 [4.37293068e-07]
 [8.25375366e-07]
 [3.38680456e-06]
 [1.16890242e-05]
 [1.49813582e-06]
 [1.39342831e-06]
 [1.02557794e-06]
 [9.17660657e-07]
 [1.16763897e-06]
 [1.69264229e-06]
 [8.77940636e-07]
 [2.79593478e-05]
 [2.43597015e-06]
 [9.86859959e-07]
 [2.61684909e-05]
 [3.76435560e-06]
 [1.10427084e-06]
 [1.35383380e-06]
 [1.65681502e-06]
 [1.68821152e-05]
 [2.03786249e-06]
 [8.16141164e-06]
 [2.76733454e-06]
 [2.75240563e-06]
 [3.09328493e-06]
 [3.10170367e-06]
 [3.55061979e-06]
 [2.47801950e-06]
 [1.13543347e-05]
 [4.25352755e-06]
 [4.13255293e-06]
 [5.57455769e-06]
 [7.99812369e-06]
 [2.97086785e-06]
 [1.28254051e-05]
 [5.90945092e-06]
 [4.30877162e-06]
 [9.00299619e-06]
 [2.63209895e-05]
 [6.43957537e-05]
 [9.67072992e-06]
 [7.88081161e-06]
 [1.06130419e-05]
 [6.06786998e-05]
 [7.54658467e-05]
 [1.70436724e-05]
 [7.08882872e-05]
 [3.03209636e-05]
 [1.27224657e-05]
 [1.20338418e-05]
 [1.25949364e-05]
 [1.45541289e-05]
 [1.34743495e-05]
 [1.43692132e-05]
 [2.10016951e-05]
 [1.60562886e-05]
 [1.28430285e-04]
 [1.80219686e-05]
 [5.59247674e-05]]
[[1.10173914e-05]
 [1.13856604e-05]
 [1.19685583e-05]
 [1.37888974e-05]
 [1.37861507e-05]
 [1.75710138e-05]
 [1.75245095e-05]
 [2.54296210e-05]
 [2.40089121e-05]
 [3.33957869e-05]
 [4.14434180e-05]
 [4.69163388e-05]
 [7.26249637e-05]
 [2.39946807e-04]
 [2.52466620e-04]
 [2.33620609e-04]
 [2.40633264e-04]
 [2.60309404e-04]
 [2.68827833e-04]
 [2.50759302e-04]
 [2.40693626e-04]
 [2.30599471e-04]
 [2.93729128e-04]
 [2.15199761e-04]
 [1.38989781e-04]
 [3.26012494e-04]
 [2.87859235e-04]
 [2.48903292e-04]
 [3.57835961e-04]
 [8.21347494e-05]
 [3.13583703e-04]
 [4.32717236e-04]
 [2.97303515e-04]
 [2.47801829e-04]
 [5.26860531e-04]
 [6.39931532e-04]
 [3.58395628e-04]
 [4.01185476e-04]
 [7.69248407e-04]
 [6.13078941e-04]
 [1.92186242e-04]
 [9.21964296e-04]
 [5.70915872e-04]
 [4.60153387e-04]
 [4.88470076e-04]
 [2.01800908e-03]
 [9.49279696e-04]
 [3.92945344e-03]
 [4.26394120e-03]
 [3.89108527e-03]
 [4.01397189e-03]
 [4.55341069e-03]
 [8.72970035e-04]
 [1.70316163e-03]
 [4.71093412e-03]
 [1.04326964e-03]
 [3.75261833e-03]
 [4.92087891e-03]
 [5.40754991e-03]
 [5.92496246e-03]
 [2.05840124e-03]
 [6.52527576e-03]
 [5.81495417e-03]
 [8.63374397e-03]
 [8.39540735e-03]
 [8.85227881e-03]
 [8.20275955e-03]
 [9.01315361e-03]
 [7.76901795e-03]
 [4.19302518e-03]
 [9.56058502e-03]
 [8.33597593e-03]
 [1.01212449e-02]
 [1.05038350e-02]
 [9.30701289e-03]
 [1.03642568e-02]
 [9.01135709e-03]
 [1.11636985e-02]
 [5.41889714e-03]
 [1.02560446e-02]
 [4.74456884e-03]
 [1.08303707e-02]
 [1.33931637e-02]
 [1.15275765e-02]
 [1.20342802e-02]
 [5.91564272e-03]
 [1.46501176e-02]
 [1.37362909e-02]
 [2.28029862e-02]
 [7.89945573e-02]
 [8.03553611e-02]
 [8.08842555e-02]
 [7.77172819e-02]
 [7.95144364e-02]
 [7.73988739e-02]
 [7.69345537e-02]
 [8.02622736e-02]
 [1.87278725e-02]
 [8.36980790e-02]
 [6.03775643e-02]]
Softplus factor for those samples:
[1.09672546e-05 1.13844872e-05 1.20401382e-05 1.38282776e-05
 1.38282776e-05 1.75237656e-05 1.74641609e-05 2.53915787e-05
 2.39610672e-05 3.34382057e-05 4.14252281e-05 4.69088554e-05
 7.25984573e-05 2.39908695e-04 2.52485275e-04 2.33530998e-04
 2.40683556e-04 2.60293484e-04 2.68757343e-04 2.50756741e-04
 2.40743160e-04 2.30550766e-04 2.93731689e-04 2.15172768e-04
 1.38998032e-04 3.25977802e-04 2.87830830e-04 2.48908997e-04
 3.57747078e-04 8.21352005e-05 3.13520432e-04 4.32550907e-04
 2.97307968e-04 2.47776508e-04 5.26726246e-04 6.39677048e-04
 3.58223915e-04 4.01079655e-04 7.68959522e-04 6.12795353e-04
 1.92165375e-04 9.21547413e-04 5.70714474e-04 4.60088253e-04
 4.88400459e-04 2.01594830e-03 9.48846340e-04 3.92168760e-03
 4.25487757e-03 3.88348103e-03 4.00596857e-03 4.54312563e-03
 8.72492790e-04 1.70177221e-03 4.69982624e-03 1.04272366e-03
 3.74555588e-03 4.90885973e-03 5.39296865e-03 5.90741634e-03
 2.05630064e-03 6.50411844e-03 5.79810143e-03 8.59659910e-03
 8.36026669e-03 8.81320238e-03 8.16917419e-03 8.97270441e-03
 7.73888826e-03 4.18424606e-03 9.51498747e-03 8.30131769e-03
 1.00702047e-02 1.04488134e-02 9.26387310e-03 1.03107691e-02
 8.97091627e-03 1.11016035e-02 5.40423393e-03 1.02035403e-02
 4.73338366e-03 1.07719898e-02 1.33038759e-02 1.14614964e-02
 1.19621158e-02 5.89817762e-03 1.45434141e-02 1.36424303e-02
 2.25449204e-02 7.59549737e-02 7.72116184e-02 7.76995420e-02
 7.47740865e-02 7.64352679e-02 7.44794607e-02 7.40494728e-02
 7.71256685e-02 1.85536146e-02 8.02910328e-02 5.85909486e-02]

- 4711 expected decrease violations (out of 70814 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-147.44262695; mean=-66.09387744; max=-0.00000011
-- Smallest suggested mesh based on expected decrease violations: 0.00000416

- 111 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999815; mean=0.87789589; max=13.88591576
-- 0 hard violations (out of 52)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=13.59948730; mean=408.19882202; max=899.56896973
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 24 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 972
- Init. samples: 50
- Unsafe samples: 0
- Target samples: 2
- Initializing iteration took 0.0647287368774414 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 24): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.62it/s]
Number of times the learn.train_step function was compiled: 21

Loss components in last train step:
 - 0. total: 0.38623974
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.001966347
 - 6. expDecrease counterx: 0.38427338
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22503825, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10681616, dtype=float32), Array([1.        , 0.99884367], dtype=float32)), (Array(0.28929362, dtype=float32), Array([1.], dtype=float32)), (Array(0.14473048, dtype=float32), Array([1.        , 0.99884367], dtype=float32)), (Array(2.1211917, dtype=float32), None), (Array(1.7336574, dtype=float32), None), (Array(2.1267486, dtype=float32), None), (Array(5.499837, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2473.5664, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1073.2302, dtype=float32), Array([1.        , 0.79595435], dtype=float32)), (Array(3922.3809, dtype=float32), Array([1.], dtype=float32)), (Array(2184.009, dtype=float32), Array([1.        , 0.79595435], dtype=float32)), (Array(15240.462, dtype=float32), None), (Array(12009.026, dtype=float32), None), (Array(17674.783, dtype=float32), None), (Array(40940.54, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2255.367 (L1)
-- Lipschitz coefficient of certificate: 1073.230 (L1)
-- Lipschitz coefficient of policy: 0.107 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.07it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72633
-- Number of factors below 0.75: 168
-- Number of factors below 0.5: 150
-- Number of factors below 0.25: 120
-- Number of factors below 0.1: 114
-- Number of factors below 0.05: 96
-- Number of factors below 0.01: 72
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.025  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225  0.025  0.01 ]
 [-0.225 -0.075  0.01 ]]
Corresponding V values are:
[[3.4646843e-07]
 [2.6016119e-07]
 [4.7024258e-07]
 [2.1242850e-07]
 [6.7189887e-07]
 [1.7620249e-07]
 [1.0127147e-06]
 [1.5669409e-06]
 [1.6861628e-07]
 [2.6609084e-06]
 [1.8398292e-07]
 [4.9124146e-06]
 [1.1238073e-07]
 [1.2968478e-07]
 [1.0859289e-07]
 [1.8504258e-07]
 [3.4343108e-07]
 [2.2465571e-07]
 [1.1077272e-07]
 [7.3834480e-07]
 [1.2070520e-07]
 [1.3718190e-07]
 [1.8271829e-06]
 [3.2576855e-07]
 [1.2710090e-06]
 [9.2711770e-07]
 [6.9224421e-07]
 [1.6254330e-07]
 [2.7348597e-06]
 [5.5643068e-07]
 [9.3129966e-06]
 [1.9500378e-07]
 [5.3398446e-07]
 [1.6901985e-06]
 [4.2789975e-06]
 [2.5756901e-07]
 [5.6469861e-07]
 [3.8901808e-07]
 [7.4215345e-06]
 [6.8223244e-07]
 [1.1067422e-06]
 [1.3331293e-06]
 [1.0678236e-06]
 [1.7454855e-05]
 [5.2964460e-06]
 [1.5745012e-05]
 [1.0531570e-06]
 [9.1509133e-07]
 [1.2482050e-06]
 [1.7891801e-06]
 [2.1377111e-06]
 [8.3052186e-07]
 [8.5417344e-07]
 [9.8901751e-07]
 [1.2053245e-06]
 [1.4672468e-06]
 [5.1157317e-06]
 [3.0648778e-06]
 [1.7788612e-06]
 [3.7850532e-05]
 [2.1256114e-06]
 [3.4151075e-05]
 [2.5502734e-06]
 [3.5111318e-06]
 [9.4591314e-06]
 [1.5665766e-05]
 [5.7234101e-06]
 [2.7445780e-05]
 [4.7046969e-06]
 [4.9600167e-06]
 [4.5498236e-06]
 [5.4251927e-06]
 [4.7799522e-06]
 [1.0527550e-05]
 [7.5491116e-06]
 [6.1634191e-06]
 [7.7663308e-06]
 [5.5519827e-06]
 [1.6668593e-05]
 [7.4978320e-06]
 [1.1803801e-05]
 [1.1178953e-05]
 [3.6871206e-05]
 [8.9495748e-05]
 [1.8966721e-05]
 [1.1210534e-05]
 [1.0660753e-04]
 [3.5601028e-05]
 [1.0117954e-05]
 [1.0710112e-05]
 [1.1431345e-05]
 [1.3322578e-05]
 [9.0467183e-05]
 [1.2185124e-05]
 [2.4588902e-05]
 [1.2869561e-05]
 [1.3516797e-05]
 [1.0509082e-04]
 [1.5464469e-05]
 [3.3201759e-05]]
[[1.91306135e-05]
 [1.92027983e-05]
 [2.05652268e-05]
 [2.12415544e-05]
 [2.29752877e-05]
 [2.70431192e-05]
 [2.70861183e-05]
 [3.49075926e-05]
 [3.62844221e-05]
 [4.79843111e-05]
 [5.35114341e-05]
 [6.99284064e-05]
 [2.27444034e-04]
 [2.14955900e-04]
 [2.38479421e-04]
 [2.13089574e-04]
 [1.94285356e-04]
 [9.15321289e-05]
 [2.50100682e-04]
 [1.77349313e-04]
 [2.85384769e-04]
 [3.40723724e-04]
 [4.47754137e-04]
 [1.81763928e-04]
 [4.33202076e-04]
 [4.24411846e-04]
 [4.20538709e-04]
 [4.08552558e-04]
 [4.46410297e-04]
 [4.15529794e-04]
 [1.22820362e-04]
 [4.90121776e-04]
 [4.25080041e-04]
 [2.44626979e-04]
 [4.79898765e-04]
 [5.82404668e-04]
 [4.61445976e-04]
 [6.90201006e-04]
 [5.67376032e-04]
 [5.36323816e-04]
 [1.39173458e-03]
 [7.69052946e-04]
 [7.17898889e-04]
 [3.08414164e-04]
 [6.54648524e-04]
 [7.63130374e-04]
 [3.15753068e-03]
 [3.27874999e-03]
 [3.04908305e-03]
 [1.06604316e-03]
 [2.97697098e-03]
 [3.48222465e-03]
 [3.61745991e-03]
 [3.73982731e-03]
 [3.83292441e-03]
 [3.96506954e-03]
 [2.75529362e-03]
 [1.82647014e-03]
 [4.46212059e-03]
 [1.46890315e-03]
 [5.32959355e-03]
 [1.71607314e-03]
 [6.39096322e-03]
 [7.60645187e-03]
 [6.33607432e-03]
 [4.24766215e-03]
 [9.45213344e-03]
 [3.19030206e-03]
 [1.29189380e-02]
 [1.29149407e-02]
 [1.29329916e-02]
 [1.29878232e-02]
 [1.28951622e-02]
 [1.33327041e-02]
 [1.35331890e-02]
 [1.33098178e-02]
 [6.93421206e-03]
 [1.33099193e-02]
 [1.28597217e-02]
 [1.36922421e-02]
 [6.04408933e-03]
 [1.42912269e-02]
 [1.29090073e-02]
 [7.64277577e-03]
 [1.63591169e-02]
 [5.59331216e-02]
 [9.75529104e-03]
 [3.64629440e-02]
 [5.77764921e-02]
 [5.77158667e-02]
 [5.64873107e-02]
 [5.35497628e-02]
 [1.54705355e-02]
 [5.55861779e-02]
 [4.92230058e-02]
 [5.46935722e-02]
 [5.67792319e-02]
 [1.72908381e-02]
 [5.87948747e-02]
 [2.25394554e-02]]
Softplus factor for those samples:
[1.91330910e-05 1.91926956e-05 2.05039978e-05 2.12788582e-05
 2.30073929e-05 2.70009041e-05 2.70605087e-05 3.48687172e-05
 3.62396240e-05 4.79221344e-05 5.35249710e-05 6.99162483e-05
 2.27391720e-04 2.14993954e-04 2.38537788e-04 2.13027000e-04
 1.94311142e-04 9.15527344e-05 2.50041485e-04 1.77323818e-04
 2.85446644e-04 3.40640545e-04 4.47630882e-04 1.81734562e-04
 4.33146954e-04 4.24265862e-04 4.20391560e-04 4.08470631e-04
 4.46319580e-04 4.15444374e-04 1.22845173e-04 4.90069389e-04
 4.24981117e-04 2.44617462e-04 4.79757786e-04 5.82218170e-04
 4.61399555e-04 6.89983368e-04 5.67197800e-04 5.36203384e-04
 1.39075518e-03 7.68721104e-04 7.17699528e-04 3.08454037e-04
 6.54399395e-04 7.62879848e-04 3.15260887e-03 3.27348709e-03
 3.04442644e-03 1.06555223e-03 2.97254324e-03 3.47614288e-03
 3.61090899e-03 3.73286009e-03 3.82560492e-03 3.95721197e-03
 2.75152922e-03 1.82479620e-03 4.45216894e-03 1.46788359e-03
 5.31548262e-03 1.71452761e-03 6.37054443e-03 7.57765770e-03
 6.31606579e-03 4.23866510e-03 9.40757990e-03 3.18521261e-03
 1.28358006e-02 1.28318667e-02 1.28497481e-02 1.29038095e-02
 1.28124356e-02 1.32442117e-02 1.34419799e-02 1.32216215e-02
 6.91014528e-03 1.32217407e-02 1.27773881e-02 1.35989189e-02
 6.02585077e-03 1.41896009e-02 1.28260851e-02 7.61359930e-03
 1.62260532e-02 5.43975830e-02 9.70792770e-03 3.58062387e-02
 5.61391115e-02 5.60818911e-02 5.49215674e-02 5.21411896e-02
 1.53514147e-02 5.40694594e-02 4.80311513e-02 5.32248020e-02
 5.51973581e-02 1.71422362e-02 5.70998192e-02 2.22874284e-02]

- 4633 expected decrease violations (out of 72633 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-142.83239746; mean=-64.94627657; max=-0.00000015
-- Smallest suggested mesh based on expected decrease violations: 0.00000340

- 101 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999732; mean=0.68030834; max=12.90119839
-- 0 hard violations (out of 43)

- 17 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-23.10412598; mean=357.26727295; max=834.72094727
-- 1 hard violations (out of 5)
-- Stats. of [V_unsafe_mean-1/(1-p)] (<0 is violation): min=-14.44378662; mean=0.08148912; max=8.84582520
Create dataset plot...

- Skip refinement, as there are still "hard" violations that cannot be fixed with refinement

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 25 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 970
- Init. samples: 50
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.29227185249328613 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 25): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 22

Loss components in last train step:
 - 0. total: 0.15193783
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0017499059
 - 6. expDecrease counterx: 0.15018792
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.221854, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10539399, dtype=float32), Array([1.        , 0.99995816], dtype=float32)), (Array(0.2828636, dtype=float32), Array([1.], dtype=float32)), (Array(0.14143476, dtype=float32), Array([1.        , 0.99995816], dtype=float32)), (Array(2.0909295, dtype=float32), None), (Array(1.7233062, dtype=float32), None), (Array(2.0940218, dtype=float32), None), (Array(5.45504, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2504.9329, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1087.05, dtype=float32), Array([1.       , 0.7912068], dtype=float32)), (Array(3979.814, dtype=float32), Array([1.], dtype=float32)), (Array(2221.8618, dtype=float32), Array([1.       , 0.7912068], dtype=float32)), (Array(16073.754, dtype=float32), None), (Array(12569.493, dtype=float32), None), (Array(17897.309, dtype=float32), None), (Array(42871.043, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2282.940 (L1)
-- Lipschitz coefficient of certificate: 1087.050 (L1)
-- Lipschitz coefficient of policy: 0.105 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.09it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72000
-- Number of factors below 0.75: 164
-- Number of factors below 0.5: 141
-- Number of factors below 0.25: 116
-- Number of factors below 0.1: 109
-- Number of factors below 0.05: 91
-- Number of factors below 0.01: 67
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225  0.035  0.01 ]]
Corresponding V values are:
[[4.04045238e-07]
 [5.59243290e-07]
 [3.00812644e-07]
 [8.39016138e-07]
 [2.38378746e-07]
 [1.29173748e-06]
 [2.00344900e-07]
 [2.04774551e-06]
 [1.97685893e-07]
 [3.47476293e-06]
 [2.23760651e-07]
 [1.40325554e-07]
 [1.54411993e-07]
 [2.08400238e-07]
 [3.78693983e-07]
 [6.11711812e-06]
 [1.34443383e-07]
 [2.81999661e-07]
 [8.23330481e-07]
 [1.41934848e-07]
 [1.53545756e-07]
 [1.74456858e-07]
 [4.20788155e-07]
 [1.58110231e-06]
 [2.04164877e-07]
 [2.31750209e-06]
 [1.10603094e-06]
 [8.33693719e-07]
 [6.80585799e-07]
 [1.84430644e-06]
 [3.50160190e-06]
 [2.58911484e-07]
 [6.58476040e-07]
 [1.15647590e-05]
 [5.51671565e-06]
 [6.96732059e-07]
 [3.93853043e-07]
 [8.85804184e-07]
 [9.86400755e-06]
 [5.96401378e-07]
 [5.49745664e-06]
 [1.68027429e-06]
 [1.41330395e-06]
 [2.28960216e-05]
 [2.08305755e-06]
 [1.18563082e-06]
 [1.98060989e-05]
 [2.38756525e-06]
 [1.40726650e-06]
 [1.04139781e-06]
 [2.37585186e-06]
 [9.90198146e-07]
 [1.08381016e-06]
 [1.32357502e-06]
 [1.61781918e-06]
 [5.62092691e-06]
 [4.00575937e-06]
 [1.95462485e-06]
 [2.35714037e-06]
 [2.82434371e-06]
 [5.16082473e-05]
 [1.15495059e-05]
 [3.72719001e-06]
 [4.49692525e-05]
 [1.72437376e-05]
 [2.84644939e-05]
 [5.59934961e-06]
 [7.32843591e-06]
 [7.83461292e-06]
 [8.69331234e-06]
 [6.97909900e-06]
 [1.06134366e-05]
 [6.79961840e-06]
 [1.42891349e-05]
 [7.02538955e-06]
 [1.37159905e-05]
 [7.70020597e-06]
 [9.99350868e-06]
 [1.06459775e-05]
 [2.31907543e-05]
 [1.43110510e-05]
 [5.09627607e-05]
 [1.65714955e-05]
 [2.37369441e-05]
 [1.28983578e-04]
 [9.82821293e-05]
 [1.37227153e-05]
 [1.34965721e-05]
 [1.59405936e-05]
 [1.28953370e-05]
 [1.21762032e-05]
 [4.11094225e-05]
 [1.45437780e-05]
 [2.82707151e-05]
 [1.52926605e-05]
 [1.78938481e-05]
 [2.18578862e-05]
 [1.67982216e-04]
 [1.55053218e-04]
 [2.67900214e-05]]
[[3.1285825e-05]
 [3.2929318e-05]
 [3.1659169e-05]
 [3.5574489e-05]
 [3.2639615e-05]
 [4.1267915e-05]
 [4.0218463e-05]
 [5.2087558e-05]
 [5.2504685e-05]
 [7.0515496e-05]
 [7.6723394e-05]
 [2.7953123e-04]
 [2.6621090e-04]
 [2.5606580e-04]
 [2.3566317e-04]
 [1.0596239e-04]
 [2.9729414e-04]
 [1.2998175e-04]
 [2.1567372e-04]
 [3.4062270e-04]
 [4.0804956e-04]
 [4.9178302e-04]
 [2.2883044e-04]
 [6.9008855e-04]
 [5.9100048e-04]
 [6.8258651e-04]
 [6.8911258e-04]
 [6.7970401e-04]
 [6.8572350e-04]
 [2.9905382e-04]
 [6.6741090e-04]
 [7.0584554e-04]
 [7.0053822e-04]
 [1.9446257e-04]
 [7.4338366e-04]
 [7.2884245e-04]
 [8.3814329e-04]
 [7.9131790e-04]
 [9.1988384e-04]
 [1.0965201e-03]
 [8.0401456e-04]
 [9.7354274e-04]
 [1.0196258e-03]
 [5.0049112e-04]
 [2.7011188e-03]
 [4.3838187e-03]
 [1.3360169e-03]
 [1.4545318e-03]
 [4.2195884e-03]
 [4.4131465e-03]
 [3.9752736e-03]
 [4.6607922e-03]
 [4.7173211e-03]
 [4.8517301e-03]
 [4.9634115e-03]
 [3.6483093e-03]
 [2.3959647e-03]
 [5.6438153e-03]
 [6.8021026e-03]
 [8.1448564e-03]
 [2.6186227e-03]
 [7.4132290e-03]
 [9.7046141e-03]
 [2.8716268e-03]
 [5.3562522e-03]
 [3.8618681e-03]
 [1.1370880e-02]
 [1.7728096e-02]
 [1.7997406e-02]
 [1.8118745e-02]
 [1.8182190e-02]
 [1.8858476e-02]
 [1.8845959e-02]
 [1.8849785e-02]
 [1.9409431e-02]
 [7.3745754e-03]
 [2.0043267e-02]
 [2.0359140e-02]
 [1.7629988e-02]
 [1.8389123e-02]
 [2.0531051e-02]
 [2.0184744e-02]
 [1.6122311e-02]
 [2.1849995e-02]
 [1.3416568e-02]
 [1.9834150e-02]
 [8.1086047e-02]
 [8.3304122e-02]
 [8.0208622e-02]
 [8.2807645e-02]
 [8.5106790e-02]
 [2.8146440e-02]
 [8.0008745e-02]
 [6.9011450e-02]
 [7.8351967e-02]
 [7.8072652e-02]
 [7.9759426e-02]
 [1.8620018e-02]
 [2.6610581e-02]
 [8.1737362e-02]]
Softplus factor for those samples:
[3.12924385e-05 3.29613686e-05 3.16500664e-05 3.55839729e-05
 3.26037407e-05 4.12464142e-05 4.02927399e-05 5.20944595e-05
 5.25116920e-05 7.05122948e-05 7.66515732e-05 2.79486179e-04
 2.66134739e-04 2.56061554e-04 2.35617161e-04 1.05977058e-04
 2.97307968e-04 1.29997730e-04 2.15649605e-04 3.40580940e-04
 4.07993793e-04 4.91619110e-04 2.28762627e-04 6.89923763e-04
 5.90860844e-04 6.82294369e-04 6.88850880e-04 6.79492950e-04
 6.85572624e-04 2.99036503e-04 6.67154789e-04 7.05659389e-04
 7.00354576e-04 1.94430351e-04 7.43031502e-04 7.28607178e-04
 8.37802887e-04 7.90953636e-04 9.19401646e-04 1.09595060e-03
 8.03709030e-04 9.73105431e-04 1.01912022e-03 5.00321388e-04
 2.69740820e-03 4.37420607e-03 1.33514404e-03 1.45339966e-03
 4.21065092e-03 4.40347195e-03 3.96740437e-03 4.64993715e-03
 4.70620394e-03 4.83995676e-03 4.95105982e-03 3.64166498e-03
 2.39312649e-03 5.62793016e-03 6.77901506e-03 8.11183453e-03
 2.61515379e-03 7.38584995e-03 9.65768099e-03 2.86746025e-03
 5.34194708e-03 3.85445356e-03 1.13064051e-02 1.75718665e-02
 1.78364515e-02 1.79556608e-02 1.80179477e-02 1.86817646e-02
 1.86694860e-02 1.86732411e-02 1.92222595e-02 7.34752417e-03
 1.98436975e-02 2.01532841e-02 1.74755454e-02 1.82210207e-02
 2.03217268e-02 1.99824572e-02 1.59929991e-02 2.16130614e-02
 1.33270025e-02 1.96386576e-02 7.78856277e-02 7.99286962e-02
 7.70761967e-02 7.94718266e-02 8.15858245e-02 2.77540684e-02
 7.68917799e-02 6.66839480e-02 7.53611326e-02 7.51026869e-02
 7.66615272e-02 1.84476972e-02 2.62596011e-02 7.84860253e-02]

- 4640 expected decrease violations (out of 72000 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-145.06359863; mean=-65.21321675; max=-0.00000012
-- Smallest suggested mesh based on expected decrease violations: 0.00000165

- 106 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999630; mean=0.89504123; max=16.40460777
-- 0 hard violations (out of 47)

- 12 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-20.81689453; mean=375.04357910; max=831.21020508
-- 0 hard violations (out of 3)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 26 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 969
- Init. samples: 51
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.5795235633850098 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 26): 100%|████████████████████████████████████████████████████████| 25/25 [00:16<00:00,  1.52it/s]
Number of times the learn.train_step function was compiled: 23

Loss components in last train step:
 - 0. total: 0.5754982
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0026300622
 - 6. expDecrease counterx: 0.57286817
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.21684624, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10276432, dtype=float32), Array([1.        , 0.99901223], dtype=float32)), (Array(0.27473268, dtype=float32), Array([1.], dtype=float32)), (Array(0.13743423, dtype=float32), Array([1.        , 0.99901223], dtype=float32)), (Array(2.0306458, dtype=float32), None), (Array(1.6766208, dtype=float32), None), (Array(2.0628157, dtype=float32), None), (Array(5.3079243, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2535.7224, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1097.8218, dtype=float32), Array([1.        , 0.78688246], dtype=float32)), (Array(4022.486, dtype=float32), Array([1.], dtype=float32)), (Array(2251.1194, dtype=float32), Array([1.        , 0.78688246], dtype=float32)), (Array(15415.859, dtype=float32), None), (Array(12865.421, dtype=float32), None), (Array(18106.643, dtype=float32), None), (Array(44133.664, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2302.820 (L1)
-- Lipschitz coefficient of certificate: 1097.822 (L1)
-- Lipschitz coefficient of policy: 0.103 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.08it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71430
-- Number of factors below 0.75: 166
-- Number of factors below 0.5: 142
-- Number of factors below 0.25: 118
-- Number of factors below 0.1: 112
-- Number of factors below 0.05: 92
-- Number of factors below 0.01: 68
Most violating states:
[[-0.205  0.005  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.035  0.01 ]
 [-0.225 -0.075  0.01 ]]
Corresponding V values are:
[[5.67667826e-07]
 [4.13217634e-07]
 [7.81470590e-07]
 [3.13171455e-07]
 [2.49888842e-07]
 [1.14775298e-06]
 [2.14091742e-07]
 [1.75086677e-06]
 [2.08577802e-07]
 [2.94014262e-06]
 [2.32064835e-07]
 [5.21802349e-06]
 [1.26214061e-07]
 [1.20549899e-07]
 [1.45778060e-07]
 [2.10504965e-07]
 [3.85365468e-07]
 [1.29205674e-07]
 [2.89878614e-07]
 [1.39463566e-07]
 [8.33824913e-07]
 [2.03953641e-06]
 [1.03361879e-06]
 [1.40775239e-06]
 [7.90941669e-07]
 [3.06186303e-06]
 [1.54782796e-07]
 [6.86893827e-07]
 [9.95769096e-06]
 [1.75326846e-07]
 [5.46886952e-07]
 [4.79342816e-06]
 [2.07261564e-07]
 [6.63114122e-07]
 [1.86901548e-06]
 [2.90327648e-07]
 [8.06961452e-06]
 [7.15859017e-07]
 [4.32430937e-07]
 [9.26566145e-07]
 [1.92532407e-05]
 [1.55640428e-05]
 [1.61031983e-06]
 [6.00358135e-06]
 [1.47946116e-06]
 [2.36155279e-06]
 [1.24446683e-06]
 [1.46798425e-06]
 [2.50416383e-06]
 [1.09159623e-06]
 [2.45065235e-06]
 [1.03184004e-06]
 [1.00803561e-06]
 [1.10648773e-06]
 [1.32799903e-06]
 [1.60792274e-06]
 [3.48104841e-05]
 [5.80772758e-06]
 [4.21567056e-05]
 [1.93097594e-06]
 [4.22845960e-06]
 [2.29544230e-06]
 [2.71712429e-06]
 [3.95707912e-06]
 [1.09735811e-05]
 [1.83638203e-05]
 [2.94701931e-05]
 [7.97262055e-06]
 [5.36921743e-06]
 [4.99091129e-06]
 [5.97893268e-06]
 [6.73717477e-06]
 [4.89195190e-06]
 [5.63917683e-06]
 [1.69427440e-05]
 [7.50640356e-06]
 [7.94619700e-06]
 [1.70134190e-05]
 [3.17202466e-05]
 [1.00836423e-05]
 [8.65234397e-05]
 [1.17936515e-05]
 [1.53790224e-05]
 [2.48440101e-05]
 [2.64255432e-05]
 [8.55890466e-05]
 [1.18035743e-04]
 [1.07110107e-04]
 [1.44060132e-05]
 [1.37633178e-05]
 [1.62353626e-05]
 [1.38689093e-05]
 [1.24881535e-05]
 [1.28837073e-05]
 [1.51119584e-05]
 [2.88482915e-05]
 [1.58504718e-05]
 [1.69934265e-05]
 [2.06110126e-05]
 [4.56946545e-05]]
[[2.30162532e-05]
 [2.19477442e-05]
 [2.59395056e-05]
 [2.35130829e-05]
 [2.92198092e-05]
 [3.06411821e-05]
 [3.67876819e-05]
 [3.96578616e-05]
 [4.99087801e-05]
 [5.41197878e-05]
 [7.73528591e-05]
 [7.84723961e-05]
 [3.00266780e-04]
 [3.13375058e-04]
 [2.86205584e-04]
 [2.70515506e-04]
 [2.51424441e-04]
 [3.17184546e-04]
 [1.32723973e-04]
 [3.46101297e-04]
 [2.28604709e-04]
 [4.80475836e-04]
 [4.72046551e-04]
 [4.78368165e-04]
 [4.59408591e-04]
 [4.69740451e-04]
 [4.10223991e-04]
 [4.50049352e-04]
 [1.31299064e-04]
 [4.82537114e-04]
 [2.86171213e-04]
 [4.79265873e-04]
 [5.70403354e-04]
 [4.69556631e-04]
 [3.19286220e-04]
 [6.70212263e-04]
 [5.45029761e-04]
 [5.49797143e-04]
 [7.80687784e-04]
 [7.29282678e-04]
 [2.82559224e-04]
 [7.64616008e-04]
 [1.88643194e-03]
 [7.64024677e-04]
 [9.81759862e-04]
 [1.24503195e-03]
 [4.51563764e-03]
 [4.33749938e-03]
 [1.50709017e-03]
 [4.54179849e-03]
 [4.07118537e-03]
 [4.63358592e-03]
 [4.78750002e-03]
 [4.88971360e-03]
 [4.93685901e-03]
 [5.02833305e-03]
 [1.46121997e-03]
 [3.73989809e-03]
 [1.31242012e-03]
 [5.30166924e-03]
 [2.61576008e-03]
 [6.29920000e-03]
 [7.45208841e-03]
 [8.73723440e-03]
 [1.28633650e-02]
 [5.03960298e-03]
 [3.71366460e-03]
 [1.26599753e-02]
 [1.25988154e-02]
 [1.29453624e-02]
 [1.22579159e-02]
 [1.21797435e-02]
 [1.33136204e-02]
 [1.37166586e-02]
 [1.26262894e-02]
 [1.38436379e-02]
 [1.10309515e-02]
 [1.01247989e-02]
 [1.32385762e-02]
 [1.41266081e-02]
 [6.44144136e-03]
 [1.20320674e-02]
 [1.63284130e-02]
 [1.32267606e-02]
 [2.15498339e-02]
 [1.61510557e-02]
 [9.16181132e-03]
 [1.75631922e-02]
 [7.65823722e-02]
 [7.84264877e-02]
 [7.71604255e-02]
 [8.05282891e-02]
 [8.16089287e-02]
 [8.01445171e-02]
 [7.49306083e-02]
 [6.68748841e-02]
 [7.33090118e-02]
 [7.51756504e-02]
 [7.66341090e-02]
 [3.01725380e-02]]
Softplus factor for those samples:
[2.30073929e-05 2.18749046e-05 2.59876251e-05 2.34842300e-05
 2.92062759e-05 3.05771828e-05 3.68356705e-05 3.96370888e-05
 4.99486923e-05 5.40614128e-05 7.73668289e-05 7.84993172e-05
 3.00288200e-04 3.13341618e-04 2.86161900e-04 2.70485878e-04
 2.51352787e-04 3.17215919e-04 1.32679939e-04 3.46004963e-04
 2.28583813e-04 4.80294228e-04 4.71949577e-04 4.78208065e-04
 4.59313393e-04 4.69684601e-04 4.10139561e-04 4.49895859e-04
 1.31309032e-04 4.82439995e-04 2.86102295e-04 4.79221344e-04
 5.70237637e-04 4.69446182e-04 3.19302082e-04 6.70015812e-04
 5.44905663e-04 5.49674034e-04 7.80344009e-04 7.29084015e-04
 2.82526016e-04 7.64310360e-04 1.88463926e-03 7.63773918e-04
 9.81330872e-04 1.24424696e-03 4.50545549e-03 4.32819128e-03
 1.50591135e-03 4.53150272e-03 4.06295061e-03 4.62281704e-03
 4.77600098e-03 4.87780571e-03 4.92465496e-03 5.01573086e-03
 1.46013498e-03 3.73291969e-03 1.31148100e-03 5.28758764e-03
 2.61241198e-03 6.27940893e-03 7.42435455e-03 8.69911909e-03
 1.27809644e-02 5.02693653e-03 3.70687246e-03 1.25802159e-02
 1.25198364e-02 1.28619075e-02 1.21831298e-02 1.21059418e-02
 1.32253766e-02 1.36229396e-02 1.25468969e-02 1.37482285e-02
 1.09703541e-02 1.00736618e-02 1.31512880e-02 1.40273571e-02
 6.42079115e-03 1.19599104e-02 1.61958933e-02 1.31396651e-02
 2.13192701e-02 1.60213709e-02 9.11992788e-03 1.74098611e-02
 7.37233162e-02 7.54299760e-02 7.42586851e-02 7.73711801e-02
 7.83677101e-02 7.70170689e-02 7.21920729e-02 6.46878481e-02
 7.06863403e-02 7.24195242e-02 7.37712979e-02 2.97218561e-02]

- 4705 expected decrease violations (out of 71430 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-144.10943604; mean=-64.79946468; max=-0.00000010
-- Smallest suggested mesh based on expected decrease violations: 0.00000176

- 104 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999654; mean=0.84306473; max=14.74953842
-- 0 hard violations (out of 45)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=6.07556152; mean=391.63345337; max=876.94104004
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 27 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 969
- Init. samples: 51
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.06714200973510742 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 27): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.00it/s]
Number of times the learn.train_step function was compiled: 23

Loss components in last train step:
 - 0. total: 0.37840763
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002785087
 - 6. expDecrease counterx: 0.37562254
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22855458, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10825787, dtype=float32), Array([1.        , 0.99969566], dtype=float32)), (Array(0.28668717, dtype=float32), Array([1.], dtype=float32)), (Array(0.1433654, dtype=float32), Array([1.        , 0.99969566], dtype=float32)), (Array(2.1390014, dtype=float32), None), (Array(1.7114285, dtype=float32), None), (Array(2.1410663, dtype=float32), None), (Array(5.3870797, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2514.4763, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1091.3223, dtype=float32), Array([1.       , 0.7814564], dtype=float32)), (Array(4022.7566, dtype=float32), Array([1.], dtype=float32)), (Array(2258.1284, dtype=float32), Array([1.       , 0.7814564], dtype=float32)), (Array(15748.3545, dtype=float32), None), (Array(13336.858, dtype=float32), None), (Array(18184.545, dtype=float32), None), (Array(45885.2, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2294.882 (L1)
-- Lipschitz coefficient of certificate: 1091.322 (L1)
-- Lipschitz coefficient of policy: 0.108 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.14it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71626
-- Number of factors below 0.75: 166
-- Number of factors below 0.5: 144
-- Number of factors below 0.25: 117
-- Number of factors below 0.1: 108
-- Number of factors below 0.05: 92
-- Number of factors below 0.01: 68
Most violating states:
[[-0.205  0.005  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.055  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225  0.025  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225  0.035  0.01 ]]
Corresponding V values are:
[[6.22079710e-07]
 [4.53219201e-07]
 [9.02247166e-07]
 [3.44136282e-07]
 [1.31839863e-06]
 [2.74642417e-07]
 [1.97148847e-06]
 [2.40212188e-07]
 [3.17631225e-06]
 [2.54759641e-07]
 [5.58365082e-06]
 [1.44447867e-07]
 [1.48608478e-07]
 [1.82042285e-07]
 [3.12130567e-07]
 [2.99874017e-07]
 [1.42884716e-07]
 [6.15744682e-07]
 [1.53737119e-07]
 [1.69324323e-07]
 [4.05926130e-07]
 [1.92838556e-07]
 [1.21779590e-06]
 [1.05458685e-05]
 [2.22811124e-07]
 [1.65093343e-06]
 [2.28459498e-06]
 [2.97576975e-07]
 [3.32241621e-06]
 [9.44838348e-07]
 [1.22250617e-06]
 [9.91257366e-07]
 [5.12687757e-06]
 [8.75426622e-07]
 [4.47708373e-07]
 [2.60336697e-06]
 [8.82424786e-07]
 [8.51887762e-06]
 [9.72183784e-07]
 [2.05932902e-05]
 [1.12501471e-06]
 [1.31307706e-06]
 [1.70669318e-05]
 [7.79388756e-06]
 [2.12341297e-06]
 [1.21487051e-06]
 [1.41212377e-06]
 [2.15595946e-06]
 [1.09830944e-06]
 [1.02577178e-06]
 [1.08561107e-06]
 [1.30303772e-06]
 [4.27538316e-06]
 [1.60859452e-06]
 [3.53634891e-06]
 [4.07152311e-06]
 [1.97697113e-06]
 [3.83262122e-05]
 [2.38288635e-06]
 [4.66963247e-05]
 [9.17292527e-06]
 [6.08987102e-06]
 [2.87428134e-06]
 [4.04000002e-06]
 [7.67812071e-06]
 [3.80639540e-05]
 [6.67598624e-06]
 [2.65171821e-05]
 [1.41121081e-05]
 [8.57239866e-06]
 [8.51804998e-06]
 [1.10346473e-05]
 [9.00012128e-06]
 [9.63214552e-06]
 [2.04773369e-05]
 [8.78595256e-06]
 [9.55339692e-06]
 [1.10233295e-05]
 [3.64437692e-05]
 [2.71472509e-05]
 [1.44229352e-05]
 [1.03482438e-04]
 [3.76599892e-05]
 [2.05569904e-05]
 [1.36176037e-04]
 [1.00998193e-04]
 [1.42793806e-05]
 [1.21971234e-05]
 [2.28449626e-05]
 [3.46420202e-05]
 [1.11230811e-05]
 [1.22167276e-05]
 [1.33040412e-05]
 [1.43121551e-05]
 [1.53740348e-05]
 [1.53395609e-04]
 [1.65893944e-05]
 [4.79562659e-05]
 [4.97613582e-05]
 [2.05000961e-05]]
[[4.1658859e-05]
 [4.1490275e-05]
 [4.2249314e-05]
 [4.5537261e-05]
 [4.7381574e-05]
 [4.9697617e-05]
 [5.7313551e-05]
 [6.1569772e-05]
 [7.2129587e-05]
 [7.8991507e-05]
 [1.0107971e-04]
 [2.9540260e-04]
 [2.7732819e-04]
 [2.6342491e-04]
 [2.3988228e-04]
 [1.1507203e-04]
 [3.1522088e-04]
 [2.2112312e-04]
 [3.4582155e-04]
 [4.1655125e-04]
 [1.9527313e-04]
 [5.0485984e-04]
 [2.8116300e-04]
 [1.6126317e-04]
 [6.1074301e-04]
 [8.3506451e-04]
 [8.4227178e-04]
 [7.2407728e-04]
 [8.2451478e-04]
 [4.7746272e-04]
 [8.1864832e-04]
 [8.0121343e-04]
 [8.1210199e-04]
 [8.3518517e-04]
 [8.5697637e-04]
 [4.9066159e-04]
 [8.8878116e-04]
 [8.9708314e-04]
 [9.7959244e-04]
 [4.0051967e-04]
 [1.3044212e-03]
 [1.1257489e-03]
 [1.1250988e-03]
 [1.0521191e-03]
 [1.4881419e-03]
 [4.0565478e-03]
 [3.8055647e-03]
 [3.5769686e-03]
 [4.2559085e-03]
 [4.5509823e-03]
 [4.7985422e-03]
 [4.9435208e-03]
 [3.3397812e-03]
 [5.1507181e-03]
 [2.1131078e-03]
 [2.1230069e-03]
 [5.4131690e-03]
 [1.8587059e-03]
 [6.5210033e-03]
 [1.9767620e-03]
 [4.2177015e-03]
 [3.5873554e-03]
 [7.8604734e-03]
 [9.4272699e-03]
 [6.8778195e-03]
 [4.9209888e-03]
 [1.1200778e-02]
 [7.2895498e-03]
 [1.9678075e-02]
 [2.0359775e-02]
 [1.9935986e-02]
 [1.9583499e-02]
 [1.9583587e-02]
 [1.9536892e-02]
 [1.9415634e-02]
 [2.0708237e-02]
 [2.1560062e-02]
 [2.3071205e-02]
 [1.9829787e-02]
 [1.5333095e-02]
 [2.4387861e-02]
 [9.3189571e-03]
 [3.5963006e-02]
 [2.5906509e-02]
 [2.3303300e-02]
 [2.2759601e-02]
 [6.4975478e-02]
 [6.9472723e-02]
 [5.6362685e-02]
 [2.9525682e-02]
 [7.2675973e-02]
 [7.3800266e-02]
 [7.3615916e-02]
 [7.3860340e-02]
 [7.4144751e-02]
 [1.4032283e-02]
 [7.5191498e-02]
 [2.4701156e-02]
 [5.0881051e-02]
 [7.8299403e-02]]
Softplus factor for those samples:
[4.16636467e-05 4.14252281e-05 4.22000885e-05 4.55379486e-05
 4.73856926e-05 4.96506691e-05 5.73396683e-05 6.16312027e-05
 7.21216202e-05 7.90357590e-05 1.01149082e-04 2.95460224e-04
 2.77340412e-04 2.63392925e-04 2.39908695e-04 1.15096569e-04
 3.15189362e-04 2.21133232e-04 3.45766544e-04 4.16398048e-04
 1.95264816e-04 5.04672527e-04 2.81155109e-04 1.61230564e-04
 6.10530376e-04 8.34703445e-04 8.41975212e-04 7.23838806e-04
 8.24213028e-04 4.77313995e-04 8.18252563e-04 8.00848007e-04
 8.11755657e-04 8.34822655e-04 8.56697559e-04 4.90546227e-04
 8.88407230e-04 8.96692276e-04 9.79185104e-04 4.00364399e-04
 1.30355358e-03 1.12509727e-03 1.12438202e-03 1.05160475e-03
 1.48707628e-03 4.04834747e-03 3.79830599e-03 3.57055664e-03
 4.24689054e-03 4.54062223e-03 4.78702784e-03 4.93139029e-03
 3.33422422e-03 5.13750315e-03 2.11083889e-03 2.12079287e-03
 5.39851189e-03 1.85692310e-03 6.49982691e-03 1.97482109e-03
 4.20880318e-03 3.58092785e-03 7.82972574e-03 9.38302279e-03
 6.85429573e-03 4.90891933e-03 1.11382604e-02 7.26306438e-03
 1.94856524e-02 2.01538801e-02 1.97385550e-02 1.93929672e-02
 1.93930268e-02 1.93473101e-02 1.92283988e-02 2.04952955e-02
 2.13293433e-02 2.28070617e-02 1.96344256e-02 1.52160525e-02
 2.40929127e-02 9.27561522e-03 3.53240371e-02 2.55738497e-02
 2.30338573e-02 2.25025415e-02 6.29095435e-02 6.71144128e-02
 5.48036695e-02 2.90941000e-02 7.00978637e-02 7.11428523e-02
 7.09716082e-02 7.11985230e-02 7.14627504e-02 1.39342546e-02
 7.24341869e-02 2.43985653e-02 4.96082902e-02 7.53125548e-02]

- 4532 expected decrease violations (out of 71626 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-147.28198242; mean=-66.10050500; max=-0.00000024
-- Smallest suggested mesh based on expected decrease violations: 0.00000242

- 102 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999499; mean=0.82305920; max=14.26404285
-- 0 hard violations (out of 43)

- 2 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-5.09869385; mean=386.97821045; max=844.45080566
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 28 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 967
- Init. samples: 53
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.5892062187194824 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 28): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 24

Loss components in last train step:
 - 0. total: 0.6022134
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0027710327
 - 6. expDecrease counterx: 0.59944236
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22246042, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10536499, dtype=float32), Array([1.       , 0.9994142], dtype=float32)), (Array(0.2779071, dtype=float32), Array([1.], dtype=float32)), (Array(0.13899426, dtype=float32), Array([1.       , 0.9994142], dtype=float32)), (Array(2.0819373, dtype=float32), None), (Array(1.6759732, dtype=float32), None), (Array(2.1002953, dtype=float32), None), (Array(5.275384, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2545.6006, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1105.0941, dtype=float32), Array([1.        , 0.77476174], dtype=float32)), (Array(4064.0537, dtype=float32), Array([1.], dtype=float32)), (Array(2289.9148, dtype=float32), Array([1.        , 0.77476174], dtype=float32)), (Array(15305.016, dtype=float32), None), (Array(13647.111, dtype=float32), None), (Array(18391.912, dtype=float32), None), (Array(47166.652, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2320.804 (L1)
-- Lipschitz coefficient of certificate: 1105.094 (L1)
-- Lipschitz coefficient of policy: 0.105 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.07it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71289
-- Number of factors below 0.75: 167
-- Number of factors below 0.5: 142
-- Number of factors below 0.25: 126
-- Number of factors below 0.1: 113
-- Number of factors below 0.05: 94
-- Number of factors below 0.01: 70
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.075  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.225  0.045  0.01 ]
 [ 0.225 -0.055  0.01 ]]
Corresponding V values are:
[[4.6181182e-07]
 [6.3453780e-07]
 [3.4296110e-07]
 [9.1088503e-07]
 [2.7136977e-07]
 [1.3581713e-06]
 [2.2017142e-07]
 [2.1032649e-06]
 [2.0556747e-07]
 [3.5625796e-06]
 [2.1866917e-07]
 [6.3365292e-06]
 [2.6003269e-07]
 [1.6615289e-07]
 [1.7542351e-07]
 [1.6058098e-07]
 [2.2061658e-07]
 [3.5907203e-07]
 [1.6533981e-07]
 [6.8334793e-07]
 [4.1599571e-07]
 [1.7472094e-07]
 [2.3619580e-06]
 [1.1847300e-06]
 [1.6470098e-06]
 [8.7050387e-07]
 [3.5287087e-06]
 [6.8842905e-07]
 [1.9022384e-07]
 [1.1573034e-05]
 [6.4865378e-07]
 [2.1214062e-07]
 [5.5397491e-06]
 [1.4481433e-06]
 [2.5121858e-07]
 [6.6469704e-07]
 [3.6588392e-07]
 [9.4065408e-06]
 [7.7977614e-07]
 [7.3165569e-07]
 [3.6487681e-06]
 [1.1860559e-06]
 [2.2421551e-05]
 [1.7152148e-06]
 [1.7779828e-05]
 [1.9357253e-06]
 [1.4673902e-05]
 [1.5344781e-06]
 [1.8621249e-06]
 [1.3088487e-06]
 [1.1692368e-06]
 [2.6245889e-06]
 [1.2136279e-06]
 [1.4131731e-06]
 [3.1953014e-06]
 [1.6674942e-06]
 [4.9351183e-06]
 [3.9586484e-05]
 [1.9579400e-06]
 [4.9035452e-06]
 [4.8370148e-05]
 [2.2626455e-06]
 [2.5947884e-06]
 [1.1209764e-05]
 [3.2172493e-06]
 [1.2004018e-05]
 [4.6831433e-06]
 [1.2089263e-05]
 [8.9155219e-06]
 [5.5769451e-06]
 [1.8787903e-05]
 [6.0515163e-06]
 [5.2246864e-06]
 [6.6519447e-06]
 [7.4846512e-06]
 [5.3185399e-06]
 [6.1213782e-06]
 [7.9833408e-06]
 [3.6155994e-05]
 [2.2988768e-05]
 [1.1503502e-05]
 [1.4833597e-05]
 [9.9560239e-05]
 [4.4775872e-05]
 [1.9078163e-05]
 [9.2532202e-05]
 [8.4144354e-05]
 [1.3565151e-04]
 [3.2326589e-05]
 [1.4675329e-05]
 [1.5099268e-05]
 [1.4050374e-05]
 [1.5465339e-05]
 [1.6101016e-05]
 [1.6495229e-05]
 [1.7104572e-05]
 [1.8842953e-05]
 [2.0062052e-05]
 [2.3626801e-05]
 [2.7579252e-05]]
[[2.49796904e-05]
 [2.72535017e-05]
 [2.44226485e-05]
 [3.09648058e-05]
 [2.63243292e-05]
 [3.58827783e-05]
 [3.27184607e-05]
 [4.58424402e-05]
 [4.24582104e-05]
 [6.14040109e-05]
 [6.17487021e-05]
 [8.83066532e-05]
 [1.02794642e-04]
 [3.54758202e-04]
 [3.45877284e-04]
 [3.62041872e-04]
 [3.36508325e-04]
 [3.26784939e-04]
 [3.78480006e-04]
 [3.23086511e-04]
 [1.86959674e-04]
 [4.36967995e-04]
 [5.37047337e-04]
 [5.16867382e-04]
 [5.31034719e-04]
 [5.02119365e-04]
 [5.24376694e-04]
 [4.86573583e-04]
 [5.05672826e-04]
 [1.53766756e-04]
 [4.91802930e-04]
 [5.85867791e-04]
 [5.24773553e-04]
 [3.70295922e-04]
 [6.74860028e-04]
 [5.18882414e-04]
 [7.71541556e-04]
 [5.73213911e-04]
 [5.91024698e-04]
 [9.34229116e-04]
 [5.90305543e-04]
 [7.67675112e-04]
 [3.20186198e-04]
 [7.99621048e-04]
 [7.78196729e-04]
 [1.10249524e-03]
 [1.79570040e-03]
 [4.94094193e-03]
 [4.76503186e-03]
 [5.23414928e-03]
 [5.32096718e-03]
 [4.79673501e-03]
 [5.38061792e-03]
 [5.33791305e-03]
 [1.82785688e-03]
 [5.30353514e-03]
 [4.79735807e-03]
 [1.49311870e-03]
 [5.41305821e-03]
 [4.06576274e-03]
 [1.47710857e-03]
 [6.25284016e-03]
 [7.16743991e-03]
 [5.95187023e-03]
 [8.26985296e-03]
 [5.46803605e-03]
 [9.39251482e-03]
 [1.21038454e-02]
 [1.25248022e-02]
 [1.31568294e-02]
 [1.13703571e-02]
 [1.29270861e-02]
 [1.33959493e-02]
 [1.25171486e-02]
 [1.25301518e-02]
 [1.35473423e-02]
 [1.36596775e-02]
 [1.36379125e-02]
 [1.08289225e-02]
 [2.25595646e-02]
 [1.38206072e-02]
 [7.50143128e-03]
 [6.10230491e-03]
 [1.02389855e-02]
 [1.56539660e-02]
 [1.27876624e-02]
 [1.11870151e-02]
 [9.85558983e-03]
 [2.09001135e-02]
 [8.36108699e-02]
 [8.53707120e-02]
 [8.53976756e-02]
 [8.06389302e-02]
 [7.73151368e-02]
 [7.60040507e-02]
 [7.63612464e-02]
 [8.32963511e-02]
 [7.54577667e-02]
 [7.48467296e-02]
 [7.78448656e-02]]
Softplus factor for those samples:
[2.49147415e-05 2.72989273e-05 2.43782997e-05 3.09348106e-05
 2.64048576e-05 3.59416008e-05 3.26633453e-05 4.57763672e-05
 4.24981117e-05 6.13927841e-05 6.17504120e-05 8.82744789e-05
 1.02758408e-04 3.54647636e-04 3.45826149e-04 3.61979008e-04
 3.36408615e-04 3.26812267e-04 3.78429890e-04 3.23057175e-04
 1.86920166e-04 4.36842442e-04 5.36859035e-04 5.16712666e-04
 5.30958176e-04 5.01990318e-04 5.24222851e-04 4.86433506e-04
 5.05506992e-04 1.53779984e-04 4.91619110e-04 5.85675240e-04
 5.24640083e-04 3.70204449e-04 6.74664974e-04 5.18798828e-04
 7.71224499e-04 5.73039055e-04 5.90860844e-04 9.33766365e-04
 5.90085983e-04 7.67350197e-04 3.20196152e-04 7.99357891e-04
 7.77840614e-04 1.10179186e-03 1.79404020e-03 4.92876768e-03
 4.75376844e-03 5.22047281e-03 5.30689955e-03 4.78523970e-03
 5.36614656e-03 5.32370806e-03 1.82616711e-03 5.28955460e-03
 4.78583574e-03 1.49196386e-03 5.39845228e-03 4.05752659e-03
 1.47598982e-03 6.23333454e-03 7.14182854e-03 5.93411922e-03
 8.23575258e-03 5.45310974e-03 9.34857130e-03 1.20308995e-02
 1.24467015e-02 1.30707026e-02 1.13059282e-02 1.28438473e-02
 1.33066177e-02 1.24391317e-02 1.24519467e-02 1.34559870e-02
 1.35667920e-02 1.35453343e-02 1.07705593e-02 2.23070383e-02
 1.37255192e-02 7.47340918e-03 6.08372688e-03 1.01867318e-02
 1.55320168e-02 1.27062798e-02 1.11247301e-02 9.80722904e-03
 2.06832886e-02 8.02108645e-02 8.18281770e-02 8.18528533e-02
 7.74732828e-02 7.44019747e-02 7.31875300e-02 7.35185742e-02
 7.99215436e-02 7.26810694e-02 7.21142888e-02 7.48921037e-02]

- 4658 expected decrease violations (out of 71289 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-144.77813721; mean=-65.58373426; max=-0.00000007
-- Smallest suggested mesh based on expected decrease violations: 0.00000112

- 99 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999642; mean=0.68717569; max=12.62304592
-- 0 hard violations (out of 42)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=16.87799072; mean=395.64596558; max=876.03820801
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 29 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 970
- Init. samples: 52
- Unsafe samples: 0
- Target samples: 2
- Initializing iteration took 0.3460836410522461 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 29): 100%|████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.71it/s]
Number of times the learn.train_step function was compiled: 25

Loss components in last train step:
 - 0. total: 0.7818949
 - 1. init: 0.5175574
 - 2. init counterx: 0.028967422
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0019399682
 - 6. expDecrease counterx: 0.23343013
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.23464689, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11123504, dtype=float32), Array([1.       , 0.9996904], dtype=float32)), (Array(0.28972366, dtype=float32), Array([1.], dtype=float32)), (Array(0.14488426, dtype=float32), Array([1.       , 0.9996904], dtype=float32)), (Array(2.1749387, dtype=float32), None), (Array(1.7117203, dtype=float32), None), (Array(2.1617146, dtype=float32), None), (Array(5.3544335, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2483.7075, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1073.6226, dtype=float32), Array([1.       , 0.7775573], dtype=float32)), (Array(4004.7861, dtype=float32), Array([1.], dtype=float32)), (Array(2252.972, dtype=float32), Array([1.       , 0.7775573], dtype=float32)), (Array(14978.568, dtype=float32), None), (Array(14023.136, dtype=float32), None), (Array(18172.887, dtype=float32), None), (Array(48762.96, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2260.698 (L1)
-- Lipschitz coefficient of certificate: 1073.623 (L1)
-- Lipschitz coefficient of policy: 0.111 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.07it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72336
-- Number of factors below 0.75: 144
-- Number of factors below 0.5: 139
-- Number of factors below 0.25: 103
-- Number of factors below 0.1: 92
-- Number of factors below 0.05: 88
-- Number of factors below 0.01: 50
Most violating states:
[[-0.205  0.005  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215  0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225 -0.075  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.085  0.01 ]
 [-0.225  0.085  0.01 ]
 [-0.215 -0.095  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]]
Corresponding V values are:
[[1.24771339e-06]
 [9.08134552e-07]
 [1.77137520e-06]
 [6.84515442e-07]
 [2.63351990e-06]
 [5.43245051e-07]
 [4.01181887e-06]
 [4.66219745e-07]
 [6.62254297e-06]
 [4.82294752e-07]
 [1.14324466e-05]
 [5.53320774e-07]
 [7.29908493e-07]
 [2.00394134e-05]
 [1.16394995e-06]
 [8.89103205e-07]
 [9.12583118e-07]
 [4.49318168e-06]
 [6.54284804e-06]
 [3.21183848e-06]
 [2.36950495e-06]
 [1.07075437e-06]
 [1.85417719e-06]
 [1.01057940e-05]
 [1.61432536e-06]
 [8.68691870e-07]
 [1.49768732e-06]
 [1.59659101e-06]
 [9.30583042e-07]
 [2.31958052e-06]
 [1.72812233e-05]
 [1.76269998e-06]
 [1.00699799e-06]
 [3.95416610e-05]
 [1.13148360e-06]
 [4.51349979e-06]
 [2.29941884e-06]
 [1.29878470e-06]
 [1.62839456e-06]
 [3.27436828e-05]
 [4.74802619e-06]
 [3.68936753e-06]
 [2.32202183e-06]
 [1.04988349e-05]
 [4.00167391e-06]
 [5.92135939e-06]
 [3.05761459e-05]
 [7.03017795e-05]
 [9.55806354e-06]
 [9.04234475e-05]
 [7.79864604e-06]
 [9.48406159e-06]
 [2.94663969e-05]
 [6.85715850e-06]
 [1.30753679e-05]
 [6.62771117e-06]
 [8.23980645e-06]
 [7.11983103e-06]
 [9.66980770e-06]
 [1.99667320e-05]
 [1.12696398e-05]
 [2.58081345e-05]
 [4.05956707e-05]
 [1.29048831e-05]
 [2.63739821e-05]
 [3.87674045e-05]
 [1.47261644e-05]
 [2.10451817e-05]
 [1.68633214e-05]
 [1.59478150e-05]
 [1.53829387e-05]
 [1.60249128e-05]
 [1.80518273e-05]
 [1.77695219e-05]
 [1.89780658e-05]
 [2.33101800e-05]
 [1.95117045e-05]
 [7.30653046e-05]
 [1.53369008e-04]
 [3.89612833e-05]
 [3.31123083e-05]
 [1.96614317e-04]
 [2.78102707e-05]
 [1.12200913e-04]
 [5.34495666e-05]
 [1.87852129e-04]
 [1.14279836e-04]
 [8.75797923e-05]
 [3.14341713e-04]
 [5.06898854e-04]
 [1.85874247e-04]
 [7.09498825e-04]
 [1.73560038e-04]
 [9.72623020e-05]
 [8.45345203e-05]
 [1.32096291e-04]
 [8.07771066e-05]
 [8.27945405e-05]
 [8.61687076e-05]
 [8.82367822e-05]]
[[8.4228253e-05]
 [7.9761936e-05]
 [8.9998728e-05]
 [8.0433427e-05]
 [9.9202582e-05]
 [8.6324399e-05]
 [1.1475861e-04]
 [1.0453339e-04]
 [1.4186586e-04]
 [1.3852851e-04]
 [1.9809615e-04]
 [1.9489326e-04]
 [3.1968893e-04]
 [3.4046228e-04]
 [5.6417246e-04]
 [1.9527600e-03]
 [1.9111431e-03]
 [1.6496591e-03]
 [1.6127261e-03]
 [1.6161876e-03]
 [1.5647413e-03]
 [1.8461912e-03]
 [1.5275336e-03]
 [1.5502439e-03]
 [1.5232491e-03]
 [1.9904596e-03]
 [1.7950921e-03]
 [1.5079902e-03]
 [2.0597312e-03]
 [1.7846492e-03]
 [1.6437853e-03]
 [1.5620959e-03]
 [2.3595197e-03]
 [8.6100795e-04]
 [2.6938987e-03]
 [1.9855371e-03]
 [1.7488159e-03]
 [3.0916033e-03]
 [3.4721743e-03]
 [2.0767888e-03]
 [2.3362639e-03]
 [2.2247364e-03]
 [3.9098077e-03]
 [2.4519127e-03]
 [5.4700393e-03]
 [3.1284944e-03]
 [4.3454501e-03]
 [3.7235087e-03]
 [5.0307824e-03]
 [4.0666140e-03]
 [2.4619671e-02]
 [2.2560155e-02]
 [1.5678344e-02]
 [2.6207132e-02]
 [2.1220153e-02]
 [2.6891645e-02]
 [2.6521914e-02]
 [2.7064485e-02]
 [2.6345670e-02]
 [2.1142928e-02]
 [2.6513090e-02]
 [2.4421666e-02]
 [2.2955479e-02]
 [3.0302476e-02]
 [3.3093091e-02]
 [3.1265303e-02]
 [3.4506112e-02]
 [3.3850614e-02]
 [3.5300612e-02]
 [3.5569761e-02]
 [3.5786815e-02]
 [3.5720903e-02]
 [3.5491463e-02]
 [3.5067771e-02]
 [3.4927081e-02]
 [3.5296720e-02]
 [3.9225057e-02]
 [2.9296076e-02]
 [1.7307503e-02]
 [1.8688438e-02]
 [3.5105187e-02]
 [1.6631436e-02]
 [4.3906860e-02]
 [2.6699372e-02]
 [3.8756277e-02]
 [3.2506086e-02]
 [1.2230124e-01]
 [5.0644889e-02]
 [2.9055094e-02]
 [6.6803552e-02]
 [1.0019269e-01]
 [7.6208405e-02]
 [8.2975194e-02]
 [2.5966436e-01]
 [2.7868527e-01]
 [2.3112941e-01]
 [2.9213935e-01]
 [2.9844671e-01]
 [3.0352637e-01]
 [3.0570912e-01]]
Softplus factor for those samples:
[8.42809677e-05 7.96914101e-05 9.00030136e-05 8.04066658e-05
 9.91821289e-05 8.63671303e-05 1.14738941e-04 1.04486942e-04
 1.41799450e-04 1.38580799e-04 1.98125839e-04 1.94847584e-04
 3.19600105e-04 3.40342522e-04 5.64038754e-04 1.95086002e-03
 1.90931559e-03 1.64824724e-03 1.61135197e-03 1.61480904e-03
 1.56354904e-03 1.84452534e-03 1.52629614e-03 1.54906511e-03
 1.52212381e-03 1.98853016e-03 1.79344416e-03 1.50680542e-03
 2.05755234e-03 1.78301334e-03 1.64246559e-03 1.56086683e-03
 2.35670805e-03 8.60691071e-04 2.69025564e-03 1.98352337e-03
 1.74731016e-03 3.08686495e-03 3.46618891e-03 2.07459927e-03
 2.33352184e-03 2.22229958e-03 3.90219688e-03 2.44891644e-03
 5.45513630e-03 3.12364101e-03 4.33599949e-03 3.71652842e-03
 5.01823425e-03 4.05836105e-03 2.43191123e-02 2.23075151e-02
 1.55560970e-02 2.58666873e-02 2.09965706e-02 2.65333056e-02
 2.61732936e-02 2.67015696e-02 2.60016322e-02 2.09209919e-02
 2.61647105e-02 2.41259336e-02 2.26939917e-02 2.98479199e-02
 3.25515270e-02 3.07815671e-02 3.39176059e-02 3.32840681e-02
 3.46848369e-02 3.49445343e-02 3.51540446e-02 3.50904465e-02
 3.48690152e-02 3.44600081e-02 3.43242288e-02 3.46810818e-02
 3.84657979e-02 2.88711190e-02 1.71585679e-02 1.85149312e-02
 3.44961882e-02 1.64939165e-02 4.29568887e-02 2.63460875e-02
 3.80149484e-02 3.19834352e-02 1.15118265e-01 4.93838191e-02
 2.86369920e-02 6.46210909e-02 9.53369737e-02 7.33769536e-02
 7.96260238e-02 2.28689611e-01 2.43221939e-01 2.06363261e-01
 2.53335536e-01 2.58030176e-01 2.61789620e-01 2.63399184e-01]

- 4400 expected decrease violations (out of 72336 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-147.28326416; mean=-66.37523512; max=-0.00000044
-- Smallest suggested mesh based on expected decrease violations: 0.00000222

- 123 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999040; mean=1.10301328; max=15.57767487
-- 0 hard violations (out of 63)

- 3 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-7.24365234; mean=366.25595093; max=825.70263672
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 30 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 966
- Init. samples: 56
- Unsafe samples: 0
- Target samples: 2
- Initializing iteration took 0.6039643287658691 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 30): 100%|████████████████████████████████████████████████████████| 25/25 [00:16<00:00,  1.56it/s]
Number of times the learn.train_step function was compiled: 26

Loss components in last train step:
 - 0. total: 0.57346666
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0024655573
 - 6. expDecrease counterx: 0.5710011
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.22810088, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.10813993, dtype=float32), Array([0.99999994, 0.9988014 ], dtype=float32)), (Array(0.28045154, dtype=float32), Array([1.], dtype=float32)), (Array(0.14030989, dtype=float32), Array([0.99999994, 0.9988014 ], dtype=float32)), (Array(2.0998216, dtype=float32), None), (Array(1.6821352, dtype=float32), None), (Array(2.103395, dtype=float32), None), (Array(5.263709, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2531.46, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1097.9425, dtype=float32), Array([1.        , 0.77004594], dtype=float32)), (Array(4080.5664, dtype=float32), Array([1.], dtype=float32)), (Array(2305.3447, dtype=float32), Array([1.        , 0.77004594], dtype=float32)), (Array(15002.272, dtype=float32), None), (Array(14515.246, dtype=float32), None), (Array(18503.707, dtype=float32), None), (Array(50618., dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2308.680 (L1)
-- Lipschitz coefficient of certificate: 1097.943 (L1)
-- Lipschitz coefficient of policy: 0.108 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.10it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 71538
-- Number of factors below 0.75: 167
-- Number of factors below 0.5: 141
-- Number of factors below 0.25: 116
-- Number of factors below 0.1: 95
-- Number of factors below 0.05: 89
-- Number of factors below 0.01: 51
Most violating states:
[[-0.205 -0.005  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.215  0.065  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.015  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.055  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225  0.075  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.075  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [-0.225 -0.085  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]]
Corresponding V values are:
[[9.1286864e-07]
 [1.2715861e-06]
 [1.7891732e-06]
 [6.7931478e-07]
 [5.2081106e-07]
 [2.6177047e-06]
 [4.4239457e-07]
 [3.9582001e-06]
 [6.4274818e-06]
 [4.3190587e-07]
 [1.1218737e-05]
 [4.8279770e-07]
 [6.0176041e-07]
 [6.7699108e-07]
 [7.6264450e-07]
 [1.1528959e-06]
 [6.4376371e-07]
 [2.0259084e-05]
 [1.6773060e-06]
 [2.2615022e-06]
 [8.7533897e-07]
 [3.1793732e-06]
 [1.4371698e-06]
 [5.9933660e-07]
 [1.3288288e-06]
 [4.5252573e-06]
 [1.3784546e-06]
 [6.5503214e-06]
 [6.1049104e-07]
 [2.5671916e-06]
 [6.4431464e-07]
 [9.9831350e-06]
 [1.4966606e-06]
 [6.8892490e-07]
 [7.6727036e-07]
 [1.6447366e-05]
 [1.0434675e-06]
 [1.9479685e-06]
 [5.9294348e-06]
 [3.9659870e-05]
 [1.4432309e-06]
 [2.9914427e-06]
 [3.1460015e-05]
 [2.5032659e-06]
 [4.7244580e-06]
 [4.6054797e-06]
 [1.8546860e-05]
 [7.1319687e-06]
 [4.3874111e-06]
 [3.9328770e-06]
 [6.8855727e-05]
 [5.3177946e-06]
 [4.0765390e-06]
 [8.9351961e-05]
 [6.6737584e-06]
 [4.5546640e-06]
 [9.6432213e-06]
 [5.2050468e-06]
 [5.8942373e-06]
 [2.0103213e-05]
 [6.6266621e-06]
 [7.4654681e-06]
 [2.6445234e-05]
 [1.6126172e-05]
 [8.4450430e-06]
 [1.3657228e-05]
 [1.1715664e-05]
 [1.1181075e-05]
 [1.1536021e-05]
 [1.7173385e-05]
 [1.1880517e-05]
 [9.3552837e-05]
 [1.2691310e-05]
 [1.4305142e-05]
 [5.7931968e-05]
 [1.6579716e-05]
 [2.0289419e-05]
 [2.3890554e-05]
 [2.6194208e-05]
 [3.8167040e-05]
 [1.6628708e-05]
 [1.8769976e-04]
 [6.6815206e-05]
 [3.7257683e-05]
 [4.7710757e-05]
 [7.1219969e-05]
 [1.6858689e-04]
 [2.8561123e-04]
 [5.8889822e-05]
 [2.7668924e-04]
 [4.1354982e-05]
 [4.9479706e-05]
 [1.5577377e-04]
 [3.8006277e-05]
 [3.8670001e-05]
 [4.3246506e-05]
 [4.0658750e-05]
 [6.1756007e-05]
 [4.9365033e-05]
 [5.6779434e-05]]
[[5.67797579e-05]
 [6.20663850e-05]
 [7.25472855e-05]
 [5.79047919e-05]
 [6.63630781e-05]
 [8.80234875e-05]
 [8.02041759e-05]
 [1.08389679e-04]
 [1.37519120e-04]
 [1.05178442e-04]
 [1.93186715e-04]
 [1.48417676e-04]
 [2.31235608e-04]
 [9.43880295e-04]
 [9.04721499e-04]
 [4.74364700e-04]
 [1.00000389e-03]
 [3.15519195e-04]
 [1.05974008e-03]
 [1.12292077e-03]
 [9.42235696e-04]
 [1.18188106e-03]
 [1.00064557e-03]
 [1.15756586e-03]
 [1.02150138e-03]
 [1.28346705e-03]
 [9.56027128e-04]
 [1.34103419e-03]
 [1.31125597e-03]
 [1.03251520e-03]
 [1.47734152e-03]
 [1.44265825e-03]
 [9.85513907e-04]
 [1.66204362e-03]
 [1.87270809e-03]
 [1.61826960e-03]
 [2.08441122e-03]
 [1.13456545e-03]
 [1.21351681e-03]
 [6.75285468e-04]
 [2.29184190e-03]
 [1.42300199e-03]
 [2.05737096e-03]
 [3.42595484e-03]
 [1.90266024e-03]
 [2.00207345e-03]
 [2.14938098e-03]
 [3.31920199e-03]
 [1.22711333e-02]
 [1.27026848e-02]
 [3.22910934e-03]
 [1.13479635e-02]
 [1.25116454e-02]
 [3.21760168e-03]
 [1.14339441e-02]
 [1.24071054e-02]
 [1.18179563e-02]
 [1.27936015e-02]
 [1.42971277e-02]
 [1.16172712e-02]
 [1.60595179e-02]
 [1.80740803e-02]
 [1.27474340e-02]
 [1.55772977e-02]
 [2.02880651e-02]
 [1.94795523e-02]
 [2.04357579e-02]
 [2.16347165e-02]
 [2.25046184e-02]
 [1.88772064e-02]
 [2.25100629e-02]
 [8.79910495e-03]
 [2.37715393e-02]
 [2.48604305e-02]
 [1.28372647e-02]
 [2.60745995e-02]
 [2.65267547e-02]
 [2.00599264e-02]
 [2.75724772e-02]
 [2.81731710e-02]
 [2.59794258e-02]
 [1.29616745e-02]
 [3.01493667e-02]
 [2.39749979e-02]
 [1.87605340e-02]
 [7.86676183e-02]
 [3.43236700e-02]
 [3.28183807e-02]
 [3.28481533e-02]
 [2.31439862e-02]
 [1.44329727e-01]
 [1.34576991e-01]
 [8.39908943e-02]
 [1.51514500e-01]
 [1.52666405e-01]
 [1.50448874e-01]
 [1.51677012e-01]
 [1.26459122e-01]
 [1.46973327e-01]
 [1.46416143e-01]]
Softplus factor for those samples:
[5.68032265e-05 6.21080399e-05 7.25388527e-05 5.78761101e-05
 6.63995743e-05 8.79764557e-05 8.02874565e-05 1.08361244e-04
 1.37448311e-04 1.05202198e-04 1.93119049e-04 1.48355961e-04
 2.31206417e-04 9.43362713e-04 9.04262066e-04 4.74214554e-04
 9.99510288e-04 3.15487385e-04 1.05917454e-03 1.12223625e-03
 9.41812992e-04 1.18118525e-03 1.00010633e-03 1.15686655e-03
 1.02096796e-03 1.28263235e-03 9.55522060e-04 1.34009123e-03
 1.31040812e-03 1.03193521e-03 1.47628784e-03 1.44159794e-03
 9.85026360e-04 1.66064501e-03 1.87098980e-03 1.61695480e-03
 2.08222866e-03 1.13391876e-03 1.21277571e-03 6.75141811e-04
 2.28917599e-03 1.42204762e-03 2.05534697e-03 3.42005491e-03
 1.90085173e-03 2.00003386e-03 2.14701891e-03 3.31372023e-03
 1.21961236e-02 1.26223564e-02 3.22383642e-03 1.12838745e-02
 1.24337673e-02 3.21245193e-03 1.13688111e-02 1.23304725e-02
 1.17484331e-02 1.27121806e-02 1.41954422e-02 1.15500093e-02
 1.59312487e-02 1.79116726e-02 1.26665235e-02 1.54566765e-02
 2.00836062e-02 1.92909837e-02 2.02283859e-02 2.14023590e-02
 2.22532749e-02 1.87000632e-02 2.22586393e-02 8.76051188e-03
 2.34912038e-02 2.45539546e-02 1.27552152e-02 2.57375836e-02
 2.61780620e-02 1.98600888e-02 2.71958113e-02 2.77799368e-02
 2.56447792e-02 1.28780007e-02 2.96993852e-02 2.36898661e-02
 1.85856223e-02 7.56528974e-02 3.37412953e-02 3.22856903e-02
 3.23145986e-02 2.28781700e-02 1.34397686e-01 1.25914454e-01
 8.05603862e-02 1.40594542e-01 1.41583979e-01 1.39678359e-01
 1.40734196e-01 1.18789792e-01 1.36682987e-01 1.36201918e-01]

- 4542 expected decrease violations (out of 71538 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-147.38494873; mean=-66.04858051; max=-0.00000008
-- Smallest suggested mesh based on expected decrease violations: 0.00000056

- 119 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99999195; mean=0.81722301; max=14.37051392
-- 0 hard violations (out of 59)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=9.98980713; mean=388.35058594; max=864.45178223
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 31 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 966
- Init. samples: 56
- Unsafe samples: 0
- Target samples: 2
- Initializing iteration took 0.06216740608215332 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 31): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.01it/s]
Number of times the learn.train_step function was compiled: 26

Loss components in last train step:
 - 0. total: 0.61053276
 - 1. init: 0.00036728382
 - 2. init counterx: 9.270502e-07
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0028539458
 - 6. expDecrease counterx: 0.6073106
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.24097672, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11438317, dtype=float32), Array([1.       , 0.9966267], dtype=float32)), (Array(0.2945937, dtype=float32), Array([1.], dtype=float32)), (Array(0.14754573, dtype=float32), Array([1.       , 0.9966267], dtype=float32)), (Array(2.2205195, dtype=float32), None), (Array(1.7142106, dtype=float32), None), (Array(2.1918232, dtype=float32), None), (Array(5.33365, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2499.152, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1083.1486, dtype=float32), Array([1.        , 0.76547045], dtype=float32)), (Array(4061.7407, dtype=float32), Array([1.], dtype=float32)), (Array(2300.6562, dtype=float32), Array([1.        , 0.76547045], dtype=float32)), (Array(15158.909, dtype=float32), None), (Array(14837.227, dtype=float32), None), (Array(18469.951, dtype=float32), None), (Array(51859.703, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2283.996 (L1)
-- Lipschitz coefficient of certificate: 1083.149 (L1)
-- Lipschitz coefficient of policy: 0.114 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.10it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72007
-- Number of factors below 0.75: 165
-- Number of factors below 0.5: 141
-- Number of factors below 0.25: 115
-- Number of factors below 0.1: 94
-- Number of factors below 0.05: 89
-- Number of factors below 0.01: 51
Most violating states:
[[-0.205  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.035  0.01 ]]
Corresponding V values are:
[[1.67796520e-06]
 [2.42445162e-06]
 [1.22527717e-06]
 [3.50875189e-06]
 [9.04143803e-07]
 [5.31655724e-06]
 [7.23928565e-07]
 [8.55224516e-06]
 [6.38014797e-07]
 [6.81533379e-07]
 [1.46534567e-05]
 [8.08924199e-07]
 [7.97194502e-07]
 [8.48788034e-07]
 [1.12036685e-06]
 [9.61741421e-07]
 [7.29463068e-07]
 [2.54216920e-05]
 [1.15992975e-06]
 [7.06560229e-07]
 [1.67550922e-06]
 [7.32269939e-07]
 [3.29795375e-06]
 [2.02187448e-06]
 [7.64771983e-07]
 [8.75259616e-07]
 [5.87901195e-06]
 [4.21250525e-06]
 [3.03664501e-06]
 [2.48666993e-06]
 [8.49478329e-06]
 [2.23864254e-06]
 [1.20218692e-06]
 [1.28605316e-05]
 [2.26713610e-06]
 [7.26849385e-06]
 [2.60914362e-06]
 [2.13875810e-05]
 [1.62298682e-06]
 [5.07865989e-05]
 [3.50271080e-06]
 [3.17553986e-06]
 [4.04248749e-05]
 [5.39289022e-06]
 [2.07300764e-05]
 [8.07888591e-06]
 [8.24100061e-06]
 [5.66910876e-06]
 [5.03142746e-06]
 [6.91597006e-06]
 [4.64538243e-06]
 [5.04166792e-06]
 [8.29088367e-06]
 [1.26313835e-05]
 [5.60717262e-06]
 [1.14614959e-05]
 [8.84581095e-05]
 [6.19098364e-06]
 [1.14837210e-04]
 [6.86205203e-06]
 [2.39983819e-05]
 [7.60180637e-06]
 [9.46434739e-06]
 [1.03412298e-04]
 [1.30533526e-05]
 [4.25833896e-05]
 [1.99569859e-05]
 [6.66193737e-05]
 [1.85763165e-05]
 [2.38733337e-05]
 [2.14790125e-05]
 [2.05864580e-05]
 [2.14547508e-05]
 [2.95818081e-05]
 [2.25115400e-05]
 [2.90663975e-05]
 [2.39317596e-05]
 [3.59835940e-05]
 [2.51541987e-05]
 [5.11201797e-05]
 [4.01865254e-05]
 [2.51861638e-04]
 [8.84080146e-05]
 [3.03201406e-04]
 [6.23801752e-05]
 [8.46746625e-05]
 [7.38825038e-05]
 [2.30604986e-04]
 [9.69082685e-05]
 [4.79573173e-05]
 [4.27499326e-05]
 [3.80802288e-04]
 [4.43388890e-05]
 [4.63825818e-05]
 [5.82398425e-05]
 [4.84671145e-05]
 [5.08572157e-05]
 [5.72278004e-05]
 [7.27249644e-05]
 [6.45973705e-05]]
[[1.22833721e-04]
 [1.32093643e-04]
 [1.19250173e-04]
 [1.48168809e-04]
 [1.24759608e-04]
 [1.73948240e-04]
 [1.34395072e-04]
 [2.09728052e-04]
 [1.59721560e-04]
 [2.00545910e-04]
 [2.85070360e-04]
 [2.74926628e-04]
 [1.17343024e-03]
 [1.12518237e-03]
 [4.24549449e-04]
 [1.12318201e-03]
 [1.25008996e-03]
 [4.53137414e-04]
 [1.11084990e-03]
 [1.40430499e-03]
 [1.19433284e-03]
 [1.56030711e-03]
 [1.24220795e-03]
 [8.00012553e-04]
 [1.72170741e-03]
 [1.88829564e-03]
 [2.25978740e-03]
 [2.21319078e-03]
 [2.14063632e-03]
 [2.04513269e-03]
 [2.27178703e-03]
 [1.95747451e-03]
 [2.05513695e-03]
 [2.30079284e-03]
 [1.87012705e-03]
 [1.41455478e-03]
 [1.92625460e-03]
 [2.45071622e-03]
 [2.49795523e-03]
 [1.00817461e-03]
 [2.10771943e-03]
 [4.53027012e-03]
 [3.00556328e-03]
 [2.54242774e-03]
 [2.50367774e-03]
 [3.17442114e-03]
 [3.41162714e-03]
 [1.28194988e-02]
 [1.31300613e-02]
 [1.26281856e-02]
 [1.37902126e-02]
 [1.40541736e-02]
 [1.31266536e-02]
 [5.29524591e-03]
 [1.42444335e-02]
 [1.39368949e-02]
 [4.69957013e-03]
 [1.45392325e-02]
 [4.77876980e-03]
 [1.61025859e-02]
 [1.37308463e-02]
 [1.78231318e-02]
 [1.94333065e-02]
 [9.77209024e-03]
 [2.11369880e-02]
 [1.78234000e-02]
 [2.09297985e-02]
 [1.46879479e-02]
 [2.70082802e-02]
 [3.36067714e-02]
 [3.52314450e-02]
 [3.67827639e-02]
 [3.80585417e-02]
 [3.21593620e-02]
 [3.94539572e-02]
 [4.25986275e-02]
 [4.09116969e-02]
 [4.20568995e-02]
 [4.20324169e-02]
 [4.02483791e-02]
 [3.20042856e-02]
 [1.82941761e-02]
 [4.07093726e-02]
 [3.60071473e-02]
 [3.54553349e-02]
 [9.67585742e-02]
 [2.78652776e-02]
 [4.33551148e-02]
 [4.61636297e-02]
 [1.52058959e-01]
 [1.57190904e-01]
 [3.39242294e-02]
 [1.56710580e-01]
 [1.50957927e-01]
 [1.43489525e-01]
 [1.47507995e-01]
 [1.50239348e-01]
 [1.52400285e-01]
 [1.41298652e-01]
 [1.55012235e-01]]
Softplus factor for those samples:
[1.2290478e-04 1.3208389e-04 1.1920929e-04 1.4817715e-04 1.2475252e-04
 1.7392635e-04 1.3434887e-04 2.0968914e-04 1.5968084e-04 2.0051003e-04
 2.8508902e-04 2.7483702e-04 1.1727810e-03 1.1245608e-03 4.2450428e-04
 1.1225343e-03 1.2493134e-03 4.5299530e-04 1.1102557e-03 1.4033318e-03
 1.1936426e-03 1.5591383e-03 1.2414455e-03 7.9965591e-04 1.7201900e-03
 1.8866062e-03 2.2572279e-03 2.2106767e-03 2.1383166e-03 2.0430088e-03
 2.2692084e-03 1.9555688e-03 2.0530224e-03 2.2981763e-03 1.8684268e-03
 1.4135242e-03 1.9243956e-03 2.4477243e-03 2.4948716e-03 1.0076165e-03
 2.1054745e-03 4.5199990e-03 3.0010343e-03 2.5392175e-03 2.5005937e-03
 3.1693578e-03 3.4058094e-03 1.2737632e-02 1.3044238e-02 1.2548745e-02
 1.3695538e-02 1.3955951e-02 1.3040841e-02 5.2811503e-03 1.4143407e-02
 1.3840258e-02 4.6885610e-03 1.4434040e-02 4.7672987e-03 1.5973628e-02
 1.3637006e-02 1.7665267e-02 1.9245803e-02 9.7244382e-03 2.0915151e-02
 1.7665446e-02 2.0712256e-02 1.4580667e-02 2.6646852e-02 3.3048391e-02
 3.4618080e-02 3.6114514e-02 3.7343442e-02 3.1647742e-02 3.8685739e-02
 4.1704059e-02 4.0086091e-02 4.1184783e-02 4.1161299e-02 3.9449155e-02
 3.1497478e-02 1.8127799e-02 3.9891899e-02 3.5366595e-02 3.4834206e-02
 9.2224836e-02 2.7480602e-02 4.2428672e-02 4.5114338e-02 1.4106238e-01
 1.4545912e-01 3.3355236e-02 1.4504856e-01 1.4011604e-01 1.3367021e-01
 1.3714451e-01 1.3949800e-01 1.4135557e-01 1.3177007e-01 1.4359534e-01]

- 4330 expected decrease violations (out of 72007 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-149.34332275; mean=-67.25245162; max=-0.00000038
-- Smallest suggested mesh based on expected decrease violations: 0.00000127

- 123 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99998558; mean=0.76757824; max=13.25215054
-- 0 hard violations (out of 63)

- 2 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-4.32568359; mean=376.99301147; max=824.42785645
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 32 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 966
- Init. samples: 56
- Unsafe samples: 0
- Target samples: 2
- Initializing iteration took 0.06743836402893066 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 32): 100%|████████████████████████████████████████████████████████| 25/25 [00:11<00:00,  2.08it/s]
Number of times the learn.train_step function was compiled: 26

Loss components in last train step:
 - 0. total: 0.46961176
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002822598
 - 6. expDecrease counterx: 0.46678916
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.24105102, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11444545, dtype=float32), Array([0.99984443, 1.        ], dtype=float32)), (Array(0.29279009, dtype=float32), Array([1.], dtype=float32)), (Array(0.14640644, dtype=float32), Array([0.99984443, 1.        ], dtype=float32)), (Array(2.2154167, dtype=float32), None), (Array(1.7156161, dtype=float32), None), (Array(2.1796758, dtype=float32), None), (Array(5.328585, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2498.3247, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1081.493, dtype=float32), Array([1.       , 0.7599904], dtype=float32)), (Array(4061.2505, dtype=float32), Array([1.], dtype=float32)), (Array(2307.5417, dtype=float32), Array([1.       , 0.7599904], dtype=float32)), (Array(14422.9795, dtype=float32), None), (Array(15116.073, dtype=float32), None), (Array(18533.416, dtype=float32), None), (Array(53155.332, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2280.569 (L1)
-- Lipschitz coefficient of certificate: 1081.493 (L1)
-- Lipschitz coefficient of policy: 0.114 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.10it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72202
-- Number of factors below 0.75: 164
-- Number of factors below 0.5: 141
-- Number of factors below 0.25: 115
-- Number of factors below 0.1: 92
-- Number of factors below 0.05: 85
-- Number of factors below 0.01: 51
Most violating states:
[[-0.205  0.005  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.065  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225 -0.075  0.01 ]]
Corresponding V values are:
[[2.54258021e-06]
 [1.83527584e-06]
 [3.48542994e-06]
 [5.13081977e-06]
 [1.39013412e-06]
 [7.57974158e-06]
 [1.11817133e-06]
 [1.14777176e-05]
 [1.04896503e-06]
 [1.86852849e-05]
 [1.14988507e-06]
 [1.39457961e-06]
 [3.22317137e-05]
 [1.25597364e-06]
 [1.18027549e-06]
 [1.35758592e-06]
 [1.10563440e-06]
 [1.56391036e-06]
 [2.23501388e-06]
 [1.12367752e-06]
 [2.03771265e-06]
 [4.21730829e-06]
 [1.14609918e-06]
 [1.16958256e-06]
 [8.15510157e-06]
 [1.26149564e-06]
 [5.83836527e-06]
 [4.37234894e-06]
 [1.20421073e-05]
 [3.55371276e-06]
 [1.68531676e-06]
 [3.81617838e-06]
 [3.39987855e-06]
 [8.98798407e-06]
 [1.83143948e-05]
 [6.25110624e-05]
 [3.46172487e-06]
 [2.24911741e-06]
 [2.85677270e-05]
 [4.29690044e-06]
 [4.15284012e-06]
 [6.27639247e-06]
 [2.42107853e-05]
 [4.99872804e-05]
 [9.69331450e-06]
 [1.53999808e-05]
 [7.95397591e-06]
 [9.12393625e-06]
 [1.38890289e-04]
 [1.06929256e-05]
 [7.05647199e-06]
 [1.48480885e-05]
 [1.42886720e-05]
 [6.91098558e-06]
 [1.05462685e-04]
 [7.49787478e-06]
 [8.30501722e-06]
 [2.75502025e-05]
 [9.11504685e-06]
 [9.95429218e-06]
 [1.07015767e-05]
 [1.10830159e-04]
 [2.27540331e-05]
 [1.25018096e-05]
 [2.47931002e-05]
 [1.67935250e-05]
 [6.86943240e-05]
 [2.28677400e-05]
 [7.97587418e-05]
 [2.99437252e-05]
 [2.84390524e-04]
 [3.69539994e-05]
 [2.82469173e-05]
 [3.73783296e-05]
 [2.81953508e-05]
 [4.90266320e-05]
 [2.94346064e-05]
 [3.18961538e-05]
 [3.01165874e-05]
 [7.38183444e-05]
 [4.85449200e-05]
 [3.01482884e-04]
 [1.01381971e-04]
 [1.15030663e-04]
 [7.12027249e-05]
 [2.60051369e-04]
 [1.12158443e-04]
 [4.20541153e-04]
 [6.00560961e-05]
 [1.41620287e-04]
 [6.64130930e-05]
 [5.80987216e-05]
 [7.93307627e-05]
 [6.10265997e-05]
 [6.40324870e-05]
 [1.07382562e-04]
 [6.67741915e-05]
 [7.03491241e-05]
 [7.80261616e-05]
 [2.24766234e-04]]
[[1.5909254e-04]
 [1.6110500e-04]
 [1.6853964e-04]
 [1.8958440e-04]
 [1.6862822e-04]
 [2.2130559e-04]
 [2.0236801e-04]
 [2.8828226e-04]
 [2.4424726e-04]
 [4.0076816e-04]
 [3.2616610e-04]
 [4.8106397e-04]
 [5.8891933e-04]
 [1.6068978e-03]
 [1.6923229e-03]
 [1.5928340e-03]
 [1.8437081e-03]
 [1.6107404e-03]
 [1.5535476e-03]
 [2.0058414e-03]
 [7.5663684e-04]
 [1.4619610e-03]
 [2.1866001e-03]
 [2.3517224e-03]
 [2.7871260e-03]
 [2.5635487e-03]
 [2.7958031e-03]
 [2.7243902e-03]
 [2.6766867e-03]
 [2.6185792e-03]
 [2.7340855e-03]
 [1.4259164e-03]
 [2.4965589e-03]
 [1.5759479e-03]
 [2.7532924e-03]
 [1.1187996e-03]
 [2.4743024e-03]
 [3.1289097e-03]
 [3.2010628e-03]
 [2.6028063e-03]
 [4.6879700e-03]
 [3.1655910e-03]
 [2.5936153e-03]
 [4.2903842e-03]
 [4.0949578e-03]
 [5.7343794e-03]
 [1.6502364e-02]
 [1.5350707e-02]
 [4.9811471e-03]
 [1.5406761e-02]
 [1.7835213e-02]
 [5.9386822e-03]
 [1.5718509e-02]
 [1.8117845e-02]
 [5.9359865e-03]
 [1.8209666e-02]
 [1.8294606e-02]
 [1.5065879e-02]
 [1.9097582e-02]
 [2.0837750e-02]
 [2.2384701e-02]
 [9.3487268e-03]
 [9.3051679e-03]
 [2.4196343e-02]
 [2.0304801e-02]
 [2.5783027e-02]
 [1.5736375e-02]
 [3.0731948e-02]
 [3.1293139e-02]
 [4.4295259e-02]
 [1.9086620e-02]
 [4.2296901e-02]
 [4.5957290e-02]
 [5.0351370e-02]
 [4.7547236e-02]
 [4.8534278e-02]
 [4.9074024e-02]
 [5.1456962e-02]
 [5.0136149e-02]
 [4.5850493e-02]
 [4.0859107e-02]
 [3.4029644e-02]
 [9.1952525e-02]
 [4.7767363e-02]
 [4.2675562e-02]
 [5.9976131e-02]
 [5.1643938e-02]
 [3.3509854e-02]
 [1.6752654e-01]
 [5.0988968e-02]
 [1.6630845e-01]
 [1.6950524e-01]
 [1.5833582e-01]
 [1.6832438e-01]
 [1.7424080e-01]
 [1.5908849e-01]
 [1.7748512e-01]
 [1.7716745e-01]
 [1.7767780e-01]
 [1.4728887e-01]]
Softplus factor for those samples:
[1.5908480e-04 1.6117096e-04 1.6856194e-04 1.8954277e-04 1.6862154e-04
 2.2125244e-04 2.0241737e-04 2.8824806e-04 2.4425983e-04 4.0066242e-04
 3.2609701e-04 4.8100948e-04 5.8871508e-04 1.6055703e-03 1.6909242e-03
 1.5915632e-03 1.8420219e-03 1.6094446e-03 1.5523434e-03 2.0038486e-03
 7.5638294e-04 1.4609098e-03 2.1842122e-03 2.3489594e-03 2.7832389e-03
 2.5601983e-03 2.7918816e-03 2.7207136e-03 2.6731491e-03 2.6150942e-03
 2.7303696e-03 1.4249682e-03 2.4933815e-03 1.5747547e-03 2.7495027e-03
 1.1181831e-03 2.4712682e-03 3.1240582e-03 3.1960011e-03 2.5994778e-03
 4.6769381e-03 3.1605959e-03 2.5902987e-03 4.2811632e-03 4.0865541e-03
 5.7179928e-03 1.6366959e-02 1.5233517e-02 4.9687028e-03 1.5288651e-02
 1.7677009e-02 5.9210658e-03 1.5595615e-02 1.7954648e-02 5.9184432e-03
 1.8044829e-02 1.8128276e-02 1.4952898e-02 1.8916368e-02 2.0622194e-02
 2.2135973e-02 9.3051195e-03 9.2620254e-03 2.3905933e-02 2.0100057e-02
 2.5453508e-02 1.5613139e-02 3.0264497e-02 3.0808508e-02 4.3328583e-02
 1.8905640e-02 4.1414857e-02 4.4917166e-02 4.9104691e-02 4.6434581e-02
 4.7375381e-02 4.7889352e-02 5.0155461e-02 4.8900068e-02 4.4815242e-02
 4.0035605e-02 3.3457160e-02 8.7851584e-02 4.6644390e-02 4.1777730e-02
 5.8212996e-02 5.0333083e-02 3.2954633e-02 1.5424579e-01 4.9710810e-02
 1.5321505e-01 1.5591764e-01 1.4643687e-01 1.5492028e-01 1.5990543e-01
 1.4707911e-01 1.6262656e-01 1.6236049e-01 1.6278791e-01 1.3695544e-01]

- 4361 expected decrease violations (out of 72202 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-149.03967285; mean=-67.01892678; max=-0.00000042
-- Smallest suggested mesh based on expected decrease violations: 0.00000109

- 123 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99997842; mean=0.70157737; max=12.54451084
-- 0 hard violations (out of 62)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=2.97601318; mean=372.74725342; max=838.99157715
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 33 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 966
- Init. samples: 56
- Unsafe samples: 0
- Target samples: 2
- Initializing iteration took 0.0627291202545166 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 33): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.00it/s]
Number of times the learn.train_step function was compiled: 26

Loss components in last train step:
 - 0. total: 0.6192696
 - 1. init: 0.0012990236
 - 2. init counterx: 5.0543375e-05
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0022564062
 - 6. expDecrease counterx: 0.61566365
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.2503435, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11893484, dtype=float32), Array([1.        , 0.99975526], dtype=float32)), (Array(0.30241936, dtype=float32), Array([1.], dtype=float32)), (Array(0.1512282, dtype=float32), Array([1.        , 0.99975526], dtype=float32)), (Array(2.2793772, dtype=float32), None), (Array(1.7343628, dtype=float32), None), (Array(2.2406898, dtype=float32), None), (Array(5.372097, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2477.466, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1073.5787, dtype=float32), Array([1.        , 0.75698644], dtype=float32)), (Array(4055.3208, dtype=float32), Array([1.], dtype=float32)), (Array(2308.112, dtype=float32), Array([1.        , 0.75698644], dtype=float32)), (Array(14862.511, dtype=float32), None), (Array(15504.785, dtype=float32), None), (Array(18513.998, dtype=float32), None), (Array(54561.875, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2268.459 (L1)
-- Lipschitz coefficient of certificate: 1073.579 (L1)
-- Lipschitz coefficient of policy: 0.119 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.11it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72579
-- Number of factors below 0.75: 164
-- Number of factors below 0.5: 140
-- Number of factors below 0.25: 115
-- Number of factors below 0.1: 92
-- Number of factors below 0.05: 84
-- Number of factors below 0.01: 49
Most violating states:
[[-0.205  0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205  0.005  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.005  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215  0.055  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.075  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.005  0.01 ]]
Corresponding V values are:
[[5.12038378e-06]
 [3.57783983e-06]
 [7.32659100e-06]
 [2.55823420e-06]
 [1.07794631e-05]
 [1.59551637e-05]
 [1.92735160e-06]
 [2.54524039e-05]
 [1.54273755e-06]
 [1.44175624e-06]
 [1.58633713e-06]
 [4.14390670e-05]
 [2.00740328e-06]
 [1.87163926e-06]
 [2.03636455e-06]
 [1.79365270e-06]
 [1.79591382e-06]
 [1.07776332e-05]
 [2.88942442e-06]
 [2.38495272e-06]
 [1.77234517e-06]
 [3.49783022e-06]
 [1.52599096e-05]
 [7.93562504e-06]
 [1.76404546e-06]
 [6.94145001e-06]
 [1.78054665e-06]
 [5.91569278e-06]
 [2.24521500e-05]
 [1.78270272e-06]
 [2.28013710e-06]
 [7.90324993e-05]
 [5.22869368e-06]
 [5.39341454e-06]
 [5.02370312e-06]
 [3.49042966e-05]
 [2.98482291e-06]
 [1.55066173e-05]
 [5.29730460e-06]
 [4.99532052e-06]
 [6.21853542e-05]
 [6.60255228e-06]
 [8.67492690e-06]
 [4.42757628e-05]
 [1.30329026e-05]
 [1.74520945e-04]
 [1.28161613e-04]
 [2.10734397e-05]
 [1.94072618e-05]
 [1.38261494e-05]
 [1.59750944e-05]
 [1.18505759e-05]
 [2.22679118e-05]
 [1.13728765e-05]
 [1.16654255e-05]
 [1.11651025e-05]
 [1.22528736e-05]
 [4.60668707e-05]
 [1.32024979e-05]
 [1.40539933e-05]
 [2.89352738e-05]
 [1.47840547e-05]
 [2.91030647e-05]
 [1.63444947e-05]
 [2.14819811e-05]
 [2.06229917e-04]
 [1.22103200e-04]
 [2.94033798e-05]
 [3.14426470e-05]
 [3.20801628e-05]
 [3.34384895e-05]
 [3.38691898e-05]
 [4.01699326e-05]
 [5.32080485e-05]
 [3.61679959e-05]
 [3.35821736e-04]
 [9.94032380e-05]
 [7.93631480e-05]
 [4.38842289e-05]
 [5.25432115e-05]
 [1.13905997e-04]
 [1.27607826e-04]
 [6.69550936e-05]
 [5.24430186e-04]
 [8.95492703e-05]
 [2.89168762e-04]
 [1.33764479e-04]
 [5.16514177e-04]
 [1.88462174e-04]
 [1.13230322e-04]
 [1.53985384e-04]
 [2.02226802e-04]
 [9.99494150e-05]
 [9.47178487e-05]
 [3.42543877e-04]
 [9.44562707e-05]
 [9.58412493e-05]
 [1.00150348e-04]
 [1.08658445e-04]
 [9.98805190e-05]]
[[2.2488223e-04]
 [2.2323368e-04]
 [2.3270104e-04]
 [2.3710665e-04]
 [2.6630587e-04]
 [3.4816071e-04]
 [2.8288786e-04]
 [4.8100820e-04]
 [3.3377451e-04]
 [3.9518200e-04]
 [5.1507895e-04]
 [7.1320770e-04]
 [6.8315258e-04]
 [2.7386905e-03]
 [2.6365703e-03]
 [2.7688553e-03]
 [2.7504594e-03]
 [2.7011987e-03]
 [1.0245711e-03]
 [2.5451500e-03]
 [2.9203400e-03]
 [2.4735108e-03]
 [2.8262136e-03]
 [2.6450953e-03]
 [3.1136854e-03]
 [2.2287341e-03]
 [3.3081234e-03]
 [2.7028301e-03]
 [2.9614863e-03]
 [3.4764344e-03]
 [3.6289436e-03]
 [1.3808232e-03]
 [2.8641096e-03]
 [1.9025968e-03]
 [2.9913613e-03]
 [3.4072252e-03]
 [3.9455830e-03]
 [2.4072756e-03]
 [3.2067904e-03]
 [5.5993763e-03]
 [4.4677714e-03]
 [3.7960571e-03]
 [4.5219110e-03]
 [3.9077555e-03]
 [5.7558883e-03]
 [5.9534754e-03]
 [6.4015551e-03]
 [7.3876446e-03]
 [7.6112766e-03]
 [2.6077213e-02]
 [2.4606083e-02]
 [2.7035663e-02]
 [2.2241661e-02]
 [2.7730964e-02]
 [2.7084930e-02]
 [2.7672840e-02]
 [2.6278827e-02]
 [1.9713549e-02]
 [2.6141632e-02]
 [2.7804404e-02]
 [1.1199923e-02]
 [2.9227860e-02]
 [2.4503665e-02]
 [3.0915314e-02]
 [3.2292008e-02]
 [1.4549147e-02]
 [1.9660220e-02]
 [3.6239445e-02]
 [4.2037472e-02]
 [4.0116243e-02]
 [4.3700825e-02]
 [3.8446758e-02]
 [4.4852827e-02]
 [4.3585096e-02]
 [3.8223103e-02]
 [2.0837618e-02]
 [3.6305044e-02]
 [4.2520627e-02]
 [4.0142193e-02]
 [4.1958936e-02]
 [1.0246196e-01]
 [4.5513771e-02]
 [4.4679135e-02]
 [4.4698704e-02]
 [5.3043246e-02]
 [5.6312818e-02]
 [6.3441224e-02]
 [3.8952194e-02]
 [6.4128309e-02]
 [2.1719971e-01]
 [1.9834918e-01]
 [8.3094433e-02]
 [2.2881314e-01]
 [2.3426786e-01]
 [1.6680798e-01]
 [2.3875999e-01]
 [2.4186963e-01]
 [2.3850138e-01]
 [2.3477598e-01]
 [2.4200508e-01]]
Softplus factor for those samples:
[0.00022483 0.00022328 0.00023264 0.00023705 0.00026631 0.00034809
 0.00028288 0.00048095 0.00033373 0.00039506 0.00051498 0.00071299
 0.00068295 0.00273502 0.00263315 0.00276506 0.0027467  0.00269747
 0.00102401 0.0025419  0.00291616 0.00247043 0.00282222 0.00264162
 0.00310886 0.00222623 0.00330263 0.00269914 0.00295711 0.00347042
 0.00362241 0.00137985 0.00285995 0.00190073 0.00298691 0.0034014
 0.00393772 0.00240439 0.00320166 0.00558376 0.00445771 0.00378883
 0.00451171 0.00390011 0.00573933 0.00593579 0.00638115 0.00736046
 0.00758237 0.02574009 0.02430576 0.02667344 0.02199608 0.02735007
 0.02672142 0.02729338 0.0259366  0.01952052 0.02580291 0.02742136
 0.01113743 0.0288049  0.02420592 0.0304423  0.03177625 0.01444387
 0.01946819 0.03559059 0.04116619 0.03932214 0.04275972 0.03771704
 0.04386187 0.04264891 0.03750187 0.02062201 0.03565389 0.04162937
 0.03934723 0.04109085 0.09738749 0.04449356 0.04369569 0.04371446
 0.05166095 0.05475664 0.06147075 0.0382033  0.06211537 0.19523072
 0.17991656 0.0797357  0.20452291 0.2088502  0.15363789 0.21239609
 0.21484154 0.21219242 0.20925206 0.21494782]

- 4248 expected decrease violations (out of 72579 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-150.20745850; mean=-67.84763380; max=-0.00000043
-- Smallest suggested mesh based on expected decrease violations: 0.00000080

- 123 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99996454; mean=0.68123466; max=12.11067200
-- 0 hard violations (out of 62)

- 10 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-18.51721191; mean=361.42407227; max=801.51062012
-- 0 hard violations (out of 2)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 34 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 960
- Init. samples: 60
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.5656545162200928 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 34): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.57it/s]
Number of times the learn.train_step function was compiled: 27

Loss components in last train step:
 - 0. total: 0.3570164
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.00261022
 - 6. expDecrease counterx: 0.3544062
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.2414958, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11470187, dtype=float32), Array([1.       , 0.9993414], dtype=float32)), (Array(0.2909484, dtype=float32), Array([1.], dtype=float32)), (Array(0.14552213, dtype=float32), Array([1.       , 0.9993414], dtype=float32)), (Array(2.1888313, dtype=float32), None), (Array(1.6940918, dtype=float32), None), (Array(2.1736677, dtype=float32), None), (Array(5.250488, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2498.4673, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1079.3203, dtype=float32), Array([1.        , 0.75007445], dtype=float32)), (Array(4086.109, dtype=float32), Array([0.99999994], dtype=float32)), (Array(2334.8203, dtype=float32), Array([1.        , 0.75007445], dtype=float32)), (Array(13973.213, dtype=float32), None), (Array(15688.384, dtype=float32), None), (Array(18710.2, dtype=float32), None), (Array(55546.62, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2276.251 (L1)
-- Lipschitz coefficient of certificate: 1079.320 (L1)
-- Lipschitz coefficient of policy: 0.115 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.09it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72208
-- Number of factors below 0.75: 164
-- Number of factors below 0.5: 131
-- Number of factors below 0.25: 113
-- Number of factors below 0.1: 90
-- Number of factors below 0.05: 72
-- Number of factors below 0.01: 49
Most violating states:
[[-0.205  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.205 -0.065  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.035  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.205  0.095  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.075  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.005  0.01 ]]
Corresponding V values are:
[[4.79108803e-06]
 [6.66071082e-06]
 [9.69288885e-06]
 [3.52345592e-06]
 [1.42915615e-05]
 [2.19598878e-05]
 [2.66120287e-06]
 [3.52929710e-05]
 [2.13591397e-06]
 [2.06306436e-06]
 [2.24246514e-06]
 [5.76649727e-05]
 [2.75767366e-06]
 [2.12566215e-06]
 [2.32787534e-06]
 [1.95098960e-06]
 [1.93622395e-06]
 [2.63156153e-06]
 [1.91409708e-06]
 [3.80398023e-06]
 [1.87981777e-06]
 [1.88270269e-06]
 [7.38248355e-06]
 [2.15319778e-06]
 [3.90265041e-06]
 [2.02775045e-05]
 [2.91351680e-05]
 [1.46773036e-05]
 [2.65884864e-06]
 [1.09516377e-05]
 [9.89522887e-05]
 [4.49774489e-05]
 [6.28440648e-06]
 [1.60782911e-05]
 [8.62547950e-06]
 [3.40444694e-06]
 [7.29928706e-06]
 [6.85441910e-06]
 [5.71638975e-06]
 [6.98337362e-06]
 [8.21965805e-05]
 [8.59451484e-06]
 [4.54494111e-05]
 [1.21292414e-05]
 [1.78733662e-05]
 [2.20903297e-04]
 [2.41182606e-05]
 [1.43824846e-05]
 [1.21911917e-05]
 [1.56667156e-04]
 [1.14811664e-05]
 [1.66693717e-05]
 [1.17694608e-05]
 [2.30909154e-05]
 [1.22012407e-05]
 [1.26371315e-05]
 [2.62757694e-05]
 [4.65587000e-05]
 [1.32252826e-05]
 [1.39172043e-05]
 [1.46080693e-05]
 [1.86614743e-05]
 [3.87103319e-05]
 [2.38004559e-05]
 [1.19183322e-04]
 [2.11797509e-04]
 [3.34693723e-05]
 [3.08581220e-05]
 [1.15188952e-04]
 [3.97903699e-04]
 [6.52854142e-05]
 [5.20596041e-05]
 [4.81481366e-05]
 [4.88604710e-05]
 [9.28149093e-05]
 [5.17224544e-05]
 [5.47252494e-05]
 [5.30450256e-04]
 [1.55464528e-04]
 [5.68832693e-05]
 [5.93173936e-05]
 [6.85072155e-05]
 [1.26596118e-04]
 [8.52784651e-05]
 [3.47823108e-04]
 [1.20398203e-04]
 [6.25463610e-04]
 [1.81823212e-04]
 [1.90454899e-04]
 [1.14652190e-04]
 [1.00307108e-04]
 [1.56001071e-04]
 [9.10896124e-05]
 [8.73145254e-05]
 [8.80586595e-05]
 [3.34458513e-04]
 [8.93704564e-05]
 [1.00243313e-04]
 [1.05883919e-04]
 [9.17077414e-05]]
[[0.00035542]
 [0.00034734]
 [0.00034818]
 [0.0003717 ]
 [0.00036618]
 [0.00041965]
 [0.00038085]
 [0.00055621]
 [0.00042789]
 [0.00049376]
 [0.00063409]
 [0.00086573]
 [0.00090585]
 [0.00259709]
 [0.00251683]
 [0.00270104]
 [0.00286058]
 [0.0025082 ]
 [0.00296876]
 [0.00252242]
 [0.00312982]
 [0.00329616]
 [0.00232836]
 [0.00340915]
 [0.00134041]
 [0.00388636]
 [0.00388011]
 [0.00392576]
 [0.00348212]
 [0.00406953]
 [0.00174599]
 [0.00417285]
 [0.00219685]
 [0.00250382]
 [0.00428352]
 [0.00434697]
 [0.00447957]
 [0.00468715]
 [0.00802976]
 [0.00485586]
 [0.00501475]
 [0.00495505]
 [0.00402307]
 [0.00566734]
 [0.00697   ]
 [0.00674183]
 [0.00836371]
 [0.02429211]
 [0.0251292 ]
 [0.00769743]
 [0.02551964]
 [0.02302372]
 [0.02542456]
 [0.02163077]
 [0.02493319]
 [0.024075  ]
 [0.00972873]
 [0.01912532]
 [0.0253999 ]
 [0.02671119]
 [0.02801877]
 [0.02895768]
 [0.01453421]
 [0.0301936 ]
 [0.01933268]
 [0.01443215]
 [0.03377868]
 [0.03829123]
 [0.04152013]
 [0.02468902]
 [0.06271431]
 [0.06325595]
 [0.06318448]
 [0.06055333]
 [0.06068541]
 [0.05705788]
 [0.05597649]
 [0.0449172 ]
 [0.05901276]
 [0.05832797]
 [0.06137513]
 [0.06356118]
 [0.14086978]
 [0.0653901 ]
 [0.06487416]
 [0.06651863]
 [0.04344114]
 [0.07610735]
 [0.06323905]
 [0.1987006 ]
 [0.2077999 ]
 [0.17908616]
 [0.21374917]
 [0.2144896 ]
 [0.21706282]
 [0.15603942]
 [0.21996532]
 [0.21240783]
 [0.20395361]
 [0.21823823]]
Softplus factor for those samples:
[0.00035536 0.00034726 0.00034809 0.00037158 0.00036603 0.0004195
 0.00038075 0.00055611 0.00042772 0.00049365 0.0006339  0.0008654
 0.00090545 0.00259376 0.00251371 0.00269735 0.00285643 0.00250506
 0.00296438 0.00251925 0.00312495 0.00329077 0.00232559 0.00340343
 0.00133955 0.00387883 0.00387263 0.00391805 0.00347608 0.00406128
 0.00174445 0.00416422 0.00219452 0.00250065 0.00427437 0.00433749
 0.00446963 0.0046761  0.00799763 0.00484413 0.00500226 0.00494277
 0.00401503 0.0056513  0.00694579 0.00671905 0.00832886 0.02399939
 0.02481616 0.00766784 0.02519673 0.02276075 0.02510417 0.02139854
 0.02462494 0.0237875  0.00968146 0.01894361 0.02508003 0.02635765
 0.02762991 0.0285424  0.01442903 0.02974236 0.01914692 0.01432848
 0.03321445 0.03756738 0.04066998 0.0243867  0.06078821 0.06129682
 0.06122971 0.05875641 0.05888075 0.05546057 0.05443865 0.04392338
 0.05730528 0.05665946 0.0595296  0.06158328 0.13139755 0.06329799
 0.06281459 0.06435454 0.04251099 0.07328331 0.06128097 0.18020475
 0.18763041 0.16396612 0.1924491  0.19304681 0.19512063 0.14447457
 0.19745344 0.19136518 0.1844998  0.19606608]

- 4345 expected decrease violations (out of 72208 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-147.61315918; mean=-66.77293744; max=-0.00000144
-- Smallest suggested mesh based on expected decrease violations: 0.00000169

- 123 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99995232; mean=0.79534376; max=14.02393532
-- 0 hard violations (out of 62)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=5.80920410; mean=372.77920532; max=836.34216309
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 35 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 960
- Init. samples: 60
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.06817317008972168 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 35): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.06it/s]
Number of times the learn.train_step function was compiled: 27

Loss components in last train step:
 - 0. total: 0.4484823
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0020264224
 - 6. expDecrease counterx: 0.4464559
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.23827295, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.1131454, dtype=float32), Array([1.        , 0.99929875], dtype=float32)), (Array(0.28626877, dtype=float32), Array([1.], dtype=float32)), (Array(0.1431846, dtype=float32), Array([1.        , 0.99929875], dtype=float32)), (Array(2.1493266, dtype=float32), None), (Array(1.6720623, dtype=float32), None), (Array(2.146558, dtype=float32), None), (Array(5.17921, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2479.7417, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1070.2168, dtype=float32), Array([1.        , 0.74673605], dtype=float32)), (Array(4082.3354, dtype=float32), Array([1.], dtype=float32)), (Array(2337.122, dtype=float32), Array([1.        , 0.74673605], dtype=float32)), (Array(14414.024, dtype=float32), None), (Array(16037.498, dtype=float32), None), (Array(18755.32, dtype=float32), None), (Array(56828.51, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2255.469 (L1)
-- Lipschitz coefficient of certificate: 1070.217 (L1)
-- Lipschitz coefficient of policy: 0.113 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.08it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72461
-- Number of factors below 0.75: 160
-- Number of factors below 0.5: 126
-- Number of factors below 0.25: 106
-- Number of factors below 0.1: 88
-- Number of factors below 0.05: 67
-- Number of factors below 0.01: 44
Most violating states:
[[-0.205  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.055  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.035  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.205  0.085  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225 -0.005  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225 -0.065  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.075  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.005  0.01 ]
 [-0.205 -0.095  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]]
Corresponding V values are:
[[8.73098270e-06]
 [1.25178203e-05]
 [6.27338841e-06]
 [1.79559011e-05]
 [4.71143221e-06]
 [2.68103377e-05]
 [3.61215461e-06]
 [4.24755053e-05]
 [2.91619131e-06]
 [2.79957067e-06]
 [3.07589357e-06]
 [6.85074701e-05]
 [3.87649152e-06]
 [3.73510011e-06]
 [3.39712687e-06]
 [3.14140925e-06]
 [4.23795109e-06]
 [3.12766451e-06]
 [5.61168736e-06]
 [3.10307632e-06]
 [5.50512186e-06]
 [3.02544390e-06]
 [1.07113783e-05]
 [2.97567385e-06]
 [3.08769086e-06]
 [2.49407221e-05]
 [1.84421642e-05]
 [3.57107892e-05]
 [3.78805521e-06]
 [1.21215206e-04]
 [1.38619016e-05]
 [9.19965260e-06]
 [5.50934201e-05]
 [1.13194674e-05]
 [4.78524771e-06]
 [2.38170778e-05]
 [9.94146467e-06]
 [9.07939921e-06]
 [9.42153474e-06]
 [7.71456871e-06]
 [9.91727793e-05]
 [1.16364936e-05]
 [1.60360578e-05]
 [6.23982560e-05]
 [2.36831056e-05]
 [1.90549166e-04]
 [2.69416050e-04]
 [3.50591545e-05]
 [2.07243247e-05]
 [1.82119311e-05]
 [2.41464531e-05]
 [1.84133078e-05]
 [3.43565480e-05]
 [1.86076813e-05]
 [3.30242910e-05]
 [1.89991806e-05]
 [6.68694556e-05]
 [1.96716410e-05]
 [2.04845619e-05]
 [2.10483122e-05]
 [2.19489175e-05]
 [2.49850491e-05]
 [5.03062511e-05]
 [3.19662249e-05]
 [2.90280441e-04]
 [1.67043443e-04]
 [3.99918863e-05]
 [5.22285736e-05]
 [8.65476177e-05]
 [5.03368734e-04]
 [6.85277337e-05]
 [1.56597554e-04]
 [6.18114500e-05]
 [5.97729268e-05]
 [6.21280924e-05]
 [1.19057455e-04]
 [6.81924503e-05]
 [6.99434488e-04]
 [7.39336683e-05]
 [1.93024302e-04]
 [7.78895846e-05]
 [8.60360960e-05]
 [1.05824656e-04]
 [4.39036026e-04]
 [1.46763283e-04]
 [1.59665215e-04]
 [2.21374386e-04]
 [1.60441472e-04]
 [1.38758565e-04]
 [2.10957805e-04]
 [9.21138097e-04]
 [1.29114647e-04]
 [1.25140301e-04]
 [4.50820022e-04]
 [1.25851657e-04]
 [1.26897809e-04]
 [1.38343821e-04]
 [3.04882327e-04]
 [1.50448992e-04]
 [1.59535077e-04]]
[[0.00050573]
 [0.00048342]
 [0.00052396]
 [0.00052264]
 [0.00053145]
 [0.00061598]
 [0.00055501]
 [0.00079324]
 [0.00060101]
 [0.00069628]
 [0.0008818 ]
 [0.00120843]
 [0.00121567]
 [0.00387208]
 [0.00400949]
 [0.00436716]
 [0.00381787]
 [0.00460359]
 [0.00386886]
 [0.00477677]
 [0.0017927 ]
 [0.00498798]
 [0.00355876]
 [0.00514945]
 [0.00532312]
 [0.0052195 ]
 [0.00528711]
 [0.00528964]
 [0.00541609]
 [0.00272727]
 [0.00536909]
 [0.00327019]
 [0.00583624]
 [0.00552525]
 [0.00603854]
 [0.00373521]
 [0.00589888]
 [0.00629936]
 [0.00658544]
 [0.01408068]
 [0.00695091]
 [0.00678149]
 [0.00739164]
 [0.00609036]
 [0.00898045]
 [0.01033953]
 [0.0111622 ]
 [0.01225055]
 [0.03603543]
 [0.03746798]
 [0.0343946 ]
 [0.03678403]
 [0.01202586]
 [0.03607576]
 [0.03209289]
 [0.03523385]
 [0.02840446]
 [0.03670096]
 [0.0383211 ]
 [0.03935525]
 [0.04100512]
 [0.04209339]
 [0.01775945]
 [0.04287213]
 [0.02114877]
 [0.02743313]
 [0.05868153]
 [0.05675363]
 [0.06917258]
 [0.03723243]
 [0.0695591 ]
 [0.05614137]
 [0.07125749]
 [0.0724695 ]
 [0.07183662]
 [0.06744272]
 [0.07080951]
 [0.06379394]
 [0.07146408]
 [0.06846815]
 [0.07379569]
 [0.07725796]
 [0.07998504]
 [0.07614172]
 [0.08280472]
 [0.22331174]
 [0.09038551]
 [0.27644604]
 [0.28421175]
 [0.254568  ]
 [0.07364929]
 [0.28743693]
 [0.29050124]
 [0.21471417]
 [0.29294416]
 [0.29255393]
 [0.2844312 ]
 [0.09536099]
 [0.27504134]
 [0.26563627]]
Softplus factor for those samples:
[0.00050557 0.00048327 0.00052381 0.00052249 0.00053138 0.00061578
 0.00055492 0.00079292 0.00060087 0.00069606 0.00088143 0.00120765
 0.00121492 0.00386459 0.00400138 0.00435764 0.00381052 0.00459301
 0.00386137 0.00476539 0.00179112 0.00497556 0.00355244 0.00513625
 0.00530905 0.00520587 0.00527322 0.00527573 0.00540149 0.00272352
 0.00535464 0.0032649  0.00581926 0.00551003 0.00602037 0.00372821
 0.00588149 0.00627953 0.00656378 0.01398206 0.00692677 0.00675857
 0.00736439 0.00607187 0.00894028 0.01028627 0.01110017 0.01217586
 0.03539395 0.03677475 0.03380984 0.03611565 0.01195383 0.03543282
 0.03158337 0.03462034 0.02800488 0.03603566 0.03759605 0.03859091
 0.04017574 0.04121977 0.01760274 0.04196614 0.02092665 0.02706033
 0.05699301 0.05517322 0.06683439 0.03654784 0.06719506 0.05459458
 0.06877792 0.06990594 0.0693171  0.06521875 0.06836063 0.06180167
 0.06897026 0.06617683 0.07113856 0.07434893 0.0768699  0.07331514
 0.07946908 0.20013452 0.08642107 0.24152547 0.24739277 0.22474867
 0.07100254 0.24981618 0.25211143 0.193228   0.25393623 0.25364506
 0.24755788 0.09095526 0.24045926 0.23328203]

- 4399 expected decrease violations (out of 72461 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-145.90032959; mean=-66.08380102; max=-0.00000231
-- Smallest suggested mesh based on expected decrease violations: 0.00000192

- 125 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99992973; mean=0.89400059; max=14.56604767
-- 0 hard violations (out of 64)

- 6 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-12.29864502; mean=366.34210205; max=806.72070312
-- 0 hard violations (out of 1)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 36 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 962
- Init. samples: 58
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.6081252098083496 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 36): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 28

Loss components in last train step:
 - 0. total: 0.42348403
 - 1. init: 0.003379941
 - 2. init counterx: 9.523162e-06
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.0023675645
 - 6. expDecrease counterx: 0.417727
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.24250722, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11517882, dtype=float32), Array([1.       , 0.9999737], dtype=float32)), (Array(0.2896803, dtype=float32), Array([1.], dtype=float32)), (Array(0.14484209, dtype=float32), Array([1.       , 0.9999737], dtype=float32)), (Array(2.1765325, dtype=float32), None), (Array(1.6808097, dtype=float32), None), (Array(2.1637173, dtype=float32), None), (Array(5.1895266, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2503.5989, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1082.2528, dtype=float32), Array([0.99999994, 0.74118084], dtype=float32)), (Array(4121.848, dtype=float32), Array([1.], dtype=float32)), (Array(2367.2717, dtype=float32), Array([0.99999994, 0.74118084], dtype=float32)), (Array(13857.947, dtype=float32), None), (Array(16329.882, dtype=float32), None), (Array(18943.904, dtype=float32), None), (Array(58127.418, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2282.926 (L1)
-- Lipschitz coefficient of certificate: 1082.253 (L1)
-- Lipschitz coefficient of policy: 0.115 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.07it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72205
-- Number of factors below 0.75: 160
-- Number of factors below 0.5: 123
-- Number of factors below 0.25: 107
-- Number of factors below 0.1: 88
-- Number of factors below 0.05: 67
-- Number of factors below 0.01: 46
Most violating states:
[[-0.205  0.005  0.01 ]
 [-0.205  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.035  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.015  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215 -0.015  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.005  0.01 ]
 [-0.215 -0.075  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215  0.075  0.01 ]
 [-0.215 -0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.045  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.065  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225  0.055  0.01 ]
 [ 0.225 -0.045  0.01 ]]
Corresponding V values are:
[[7.9493275e-06]
 [1.1319802e-05]
 [1.6360136e-05]
 [2.3539671e-05]
 [5.8577789e-06]
 [3.6361253e-05]
 [4.3287223e-06]
 [3.3555355e-06]
 [5.8549467e-05]
 [2.8417053e-06]
 [2.9233643e-06]
 [3.3032768e-06]
 [9.6172123e-05]
 [4.3524460e-06]
 [3.6641984e-06]
 [4.4521562e-06]
 [3.9807815e-06]
 [3.5489372e-06]
 [3.4531486e-06]
 [5.1013644e-06]
 [3.3273056e-06]
 [3.2111741e-06]
 [2.3229712e-05]
 [3.1009436e-06]
 [3.5741634e-06]
 [6.5154818e-06]
 [6.8411100e-06]
 [1.6896323e-05]
 [3.2775235e-05]
 [1.2094175e-05]
 [4.8026566e-05]
 [1.2761022e-05]
 [4.3970872e-06]
 [7.8765996e-05]
 [1.0613154e-05]
 [1.7938852e-04]
 [9.4486550e-06]
 [7.1694685e-06]
 [9.1768798e-06]
 [2.6623326e-05]
 [1.0138691e-05]
 [1.3053141e-05]
 [1.4038474e-04]
 [1.9050600e-05]
 [6.6260254e-05]
 [2.6051855e-05]
 [2.7477416e-05]
 [2.3639916e-05]
 [2.1016482e-05]
 [2.0865005e-05]
 [2.0449623e-05]
 [2.8060505e-05]
 [2.0497244e-05]
 [3.9659870e-05]
 [2.7154951e-04]
 [2.0729522e-05]
 [2.1198652e-05]
 [3.6995221e-05]
 [2.1467442e-05]
 [2.1673026e-05]
 [2.2261798e-05]
 [7.2201576e-05]
 [2.7559112e-05]
 [4.0103230e-04]
 [3.0950329e-04]
 [3.4162575e-05]
 [1.1738860e-04]
 [1.7824928e-04]
 [8.1242943e-05]
 [1.0429333e-04]
 [5.7002901e-05]
 [6.7561465e-05]
 [6.2346509e-05]
 [1.4906545e-04]
 [6.0101356e-05]
 [6.4122687e-05]
 [7.0018294e-05]
 [7.2721152e-05]
 [7.8978097e-05]
 [2.6787928e-04]
 [7.2482321e-04]
 [9.2728747e-05]
 [1.2043563e-04]
 [7.3895173e-04]
 [1.7700263e-04]
 [1.3602457e-04]
 [6.4073247e-04]
 [2.2692930e-04]
 [2.6150956e-04]
 [1.3906522e-04]
 [1.3104288e-04]
 [1.4812600e-04]
 [1.5543235e-04]
 [1.5748500e-04]
 [1.3314649e-04]
 [1.7804527e-04]
 [1.4243684e-04]
 [1.3577213e-04]
 [1.5933198e-04]
 [1.5308525e-04]]
[[0.00049443]
 [0.00047876]
 [0.00051357]
 [0.00060179]
 [0.00050249]
 [0.00073053]
 [0.00051951]
 [0.00054699]
 [0.00096014]
 [0.00063232]
 [0.0007582 ]
 [0.00097527]
 [0.00160412]
 [0.00141823]
 [0.00491981]
 [0.00462593]
 [0.00473043]
 [0.00509967]
 [0.00520011]
 [0.00463491]
 [0.00524985]
 [0.00531175]
 [0.00528037]
 [0.00537762]
 [0.00526255]
 [0.00477191]
 [0.00256686]
 [0.00545084]
 [0.00502541]
 [0.00446758]
 [0.00532447]
 [0.00577321]
 [0.00533228]
 [0.0058763 ]
 [0.00576052]
 [0.00397613]
 [0.00598006]
 [0.01476399]
 [0.00617081]
 [0.00440616]
 [0.00636449]
 [0.00671693]
 [0.00757909]
 [0.0077593 ]
 [0.00656871]
 [0.00955982]
 [0.00985413]
 [0.04090999]
 [0.04120472]
 [0.03972822]
 [0.0377636 ]
 [0.03989244]
 [0.03695221]
 [0.01422123]
 [0.01426683]
 [0.03750631]
 [0.03793966]
 [0.03763983]
 [0.03841158]
 [0.03877243]
 [0.03879197]
 [0.0336336 ]
 [0.0383308 ]
 [0.0175399 ]
 [0.02078284]
 [0.05775792]
 [0.04477162]
 [0.03150496]
 [0.06409671]
 [0.06361338]
 [0.05858162]
 [0.06816774]
 [0.07190765]
 [0.06382644]
 [0.07591797]
 [0.07518759]
 [0.07478999]
 [0.07393823]
 [0.07421614]
 [0.07112347]
 [0.06308461]
 [0.07650276]
 [0.07772639]
 [0.05986522]
 [0.08184184]
 [0.2167682 ]
 [0.08613196]
 [0.07217224]
 [0.09767091]
 [0.27775186]
 [0.28728867]
 [0.26337534]
 [0.2496249 ]
 [0.25253838]
 [0.29516256]
 [0.29942903]
 [0.30057976]
 [0.29831553]
 [0.2551524 ]
 [0.30543098]]
Softplus factor for those samples:
[0.00049424 0.00047863 0.00051337 0.00060153 0.00050235 0.00073034
 0.00051939 0.00054681 0.00095969 0.00063217 0.00075787 0.00097483
 0.00160289 0.00141728 0.00490773 0.00461531 0.00471926 0.00508672
 0.00518656 0.00462413 0.00523609 0.0052976  0.00526643 0.00536317
 0.00524873 0.00476056 0.0025636  0.00543606 0.00501275 0.00445759
 0.00531036 0.00575656 0.00531811 0.00585908 0.00574398 0.00396824
 0.00596219 0.01465553 0.00615174 0.0043965  0.0063442  0.00669444
 0.00755054 0.00772929 0.00654721 0.00951421 0.00980568 0.04008448
 0.04036725 0.03894937 0.03705943 0.0391072  0.03627783 0.01412064
 0.01416558 0.03681171 0.037229   0.03694028 0.03768325 0.03803039
 0.03804916 0.03307426 0.03760546 0.01738697 0.02056837 0.05612165
 0.04378408 0.03101385 0.06208575 0.06163228 0.05689877 0.06589615
 0.06938314 0.06183219 0.07310784 0.07243049 0.07206166 0.071271
 0.07152897 0.06865305 0.06113595 0.07364964 0.07478243 0.05810851
 0.07858229 0.1948834  0.0825268  0.06962931 0.09305269 0.24251527
 0.2497049  0.23154664 0.22090703 0.22317362 0.25558943 0.25875872
 0.2596112  0.25793284 0.2252016  0.26319426]

- 4349 expected decrease violations (out of 72205 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-147.02185059; mean=-66.81377465; max=-0.00000059
-- Smallest suggested mesh based on expected decrease violations: 0.00000050

- 126 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99993199; mean=0.79318029; max=13.70059395
-- 0 hard violations (out of 64)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=9.36743164; mean=373.71264648; max=831.85253906
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 37 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 961
- Init. samples: 59
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.5876059532165527 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 37): 100%|████████████████████████████████████████████████████████| 25/25 [00:15<00:00,  1.58it/s]
Number of times the learn.train_step function was compiled: 29

Loss components in last train step:
 - 0. total: 0.38645893
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002443299
 - 6. expDecrease counterx: 0.38401562
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.24645783, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.11712594, dtype=float32), Array([1.       , 0.9999322], dtype=float32)), (Array(0.29307395, dtype=float32), Array([1.], dtype=float32)), (Array(0.14654192, dtype=float32), Array([1.       , 0.9999322], dtype=float32)), (Array(2.1932023, dtype=float32), None), (Array(1.6797261, dtype=float32), None), (Array(2.1837604, dtype=float32), None), (Array(5.175879, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2508.4146, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1095.3097, dtype=float32), Array([1.0000001, 0.7336703], dtype=float32)), (Array(4134.0547, dtype=float32), Array([1.], dtype=float32)), (Array(2384.5684, dtype=float32), Array([1.0000001, 0.7336703], dtype=float32)), (Array(14397.379, dtype=float32), None), (Array(16630.555, dtype=float32), None), (Array(19114.646, dtype=float32), None), (Array(59134.617, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2312.494 (L1)
-- Lipschitz coefficient of certificate: 1095.310 (L1)
-- Lipschitz coefficient of policy: 0.117 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.10it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72123
-- Number of factors below 0.75: 142
-- Number of factors below 0.5: 118
-- Number of factors below 0.25: 94
-- Number of factors below 0.1: 87
-- Number of factors below 0.05: 52
-- Number of factors below 0.01: 42
Most violating states:
[[-0.205  0.015  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205  0.015  0.01 ]
 [-0.205 -0.075  0.01 ]
 [-0.215  0.025  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205  0.025  0.01 ]
 [-0.205  0.075  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [ 0.205  0.055  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205  0.065  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215 -0.005  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.025  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215 -0.045  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.055  0.01 ]
 [-0.205 -0.085  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [-0.215  0.075  0.01 ]
 [-0.215 -0.065  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [ 0.215  0.025  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.205  0.085  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.065  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.035  0.01 ]
 [ 0.215  0.085  0.01 ]
 [-0.225 -0.045  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225 -0.065  0.01 ]
 [-0.205 -0.095  0.01 ]
 [-0.205  0.095  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225  0.005  0.01 ]
 [-0.225  0.085  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.035  0.01 ]]
Corresponding V values are:
[[1.36223161e-05]
 [9.76355659e-06]
 [1.93736068e-05]
 [4.17587762e-05]
 [2.79270771e-05]
 [7.26631060e-06]
 [6.65994303e-05]
 [5.37877577e-06]
 [4.20344395e-06]
 [3.69340910e-06]
 [3.83070528e-06]
 [1.06917840e-04]
 [4.47377397e-06]
 [6.04656634e-06]
 [5.98754832e-06]
 [6.53900543e-06]
 [5.76204229e-06]
 [9.78071239e-06]
 [2.76679220e-05]
 [7.48967796e-06]
 [3.81210957e-05]
 [5.56620125e-06]
 [1.81302428e-04]
 [5.37340247e-06]
 [5.09020219e-06]
 [5.40157380e-05]
 [8.67949439e-06]
 [4.95584209e-06]
 [1.01892610e-05]
 [5.82630082e-06]
 [2.05118904e-05]
 [1.44610167e-05]
 [8.33219092e-05]
 [1.64259855e-05]
 [2.75692310e-05]
 [1.44835003e-05]
 [7.10541644e-06]
 [1.29525006e-05]
 [1.47673534e-04]
 [1.26925925e-05]
 [1.44673613e-05]
 [1.81915530e-05]
 [5.72443387e-05]
 [2.61478108e-05]
 [3.61637212e-05]
 [3.93770752e-04]
 [1.69758088e-04]
 [2.72620498e-04]
 [3.68314249e-05]
 [5.22623086e-05]
 [3.53102441e-05]
 [3.91894937e-05]
 [3.47043169e-05]
 [4.33485766e-05]
 [3.34826582e-05]
 [3.23960594e-05]
 [5.29485842e-05]
 [3.22432716e-05]
 [3.31194133e-05]
 [3.34646502e-05]
 [3.36426892e-05]
 [4.30722794e-05]
 [7.79774346e-05]
 [3.55203847e-05]
 [4.32913548e-05]
 [1.64165904e-04]
 [1.57799033e-04]
 [6.65472762e-04]
 [1.23182326e-04]
 [9.91061243e-05]
 [1.63487726e-04]
 [8.85202244e-05]
 [8.47241827e-05]
 [8.62962479e-05]
 [3.96087155e-04]
 [8.96494166e-05]
 [2.60088593e-04]
 [9.30055030e-05]
 [1.00075318e-04]
 [1.09788227e-04]
 [1.25637860e-04]
 [1.27706808e-04]
 [8.05606192e-04]
 [5.57484804e-04]
 [1.61386080e-04]
 [2.30026722e-04]
 [2.90882832e-04]
 [1.18400413e-03]
 [1.86709245e-03]
 [3.33486591e-04]
 [2.01141913e-04]
 [1.95146538e-04]
 [2.05192802e-04]
 [2.09920341e-04]
 [1.60486018e-03]
 [2.28364399e-04]
 [2.22078044e-04]
 [2.65760464e-04]
 [2.30503851e-04]
 [2.37719272e-04]]
[[0.00072361]
 [0.00073457]
 [0.00072138]
 [0.00092873]
 [0.00079388]
 [0.00072518]
 [0.00114922]
 [0.00075425]
 [0.00080835]
 [0.00091685]
 [0.001085  ]
 [0.00169813]
 [0.00136201]
 [0.00194211]
 [0.00758976]
 [0.00715467]
 [0.00781993]
 [0.00334704]
 [0.00755978]
 [0.00675522]
 [0.00734488]
 [0.00800015]
 [0.0033772 ]
 [0.00806918]
 [0.0081336 ]
 [0.00717697]
 [0.00651622]
 [0.0082328 ]
 [0.0069343 ]
 [0.00807028]
 [0.00763307]
 [0.00699887]
 [0.00786105]
 [0.00752828]
 [0.00687711]
 [0.00775799]
 [0.01515069]
 [0.00795056]
 [0.00877758]
 [0.0080993 ]
 [0.00860152]
 [0.0093245 ]
 [0.00804147]
 [0.01061442]
 [0.01222733]
 [0.01296704]
 [0.01611056]
 [0.01256343]
 [0.01310424]
 [0.01822755]
 [0.0528704 ]
 [0.05363516]
 [0.05146826]
 [0.05382912]
 [0.05313846]
 [0.05483588]
 [0.05452899]
 [0.0560162 ]
 [0.05651807]
 [0.05689858]
 [0.05719281]
 [0.05892713]
 [0.05311164]
 [0.05761862]
 [0.06465685]
 [0.04903258]
 [0.05450475]
 [0.03982345]
 [0.08477215]
 [0.08861417]
 [0.08143561]
 [0.08944127]
 [0.09258603]
 [0.09253204]
 [0.0571983 ]
 [0.09041224]
 [0.08116251]
 [0.08835552]
 [0.08860348]
 [0.09006258]
 [0.21515425]
 [0.09121816]
 [0.05636506]
 [0.08663739]
 [0.09645454]
 [0.1042769 ]
 [0.09639655]
 [0.07813235]
 [0.157297  ]
 [0.12102631]
 [0.36099276]
 [0.37252566]
 [0.38107052]
 [0.34885803]
 [0.13030772]
 [0.3818036 ]
 [0.33957246]
 [0.3739187 ]
 [0.3469768 ]
 [0.348761  ]]
Softplus factor for those samples:
[0.00072342 0.00073433 0.00072122 0.00092834 0.00079352 0.00072491
 0.00114858 0.00075394 0.00080806 0.00091636 0.00108439 0.00169671
 0.00136113 0.00194019 0.00756103 0.00712913 0.00778943 0.0033415
 0.00753129 0.00673246 0.00731796 0.00796819 0.00337154 0.00803661
 0.00810063 0.00715137 0.00649506 0.00819898 0.00691032 0.00803781
 0.007604   0.0069744  0.00783026 0.00750005 0.00685352 0.00772804
 0.01503652 0.00791901 0.00873917 0.00806659 0.00856465 0.00928116
 0.00800925 0.01055825 0.01215285 0.01288331 0.01598144 0.01248485
 0.01301879 0.01806247 0.05149698 0.05222213 0.05016619 0.05240595
 0.05175126 0.05335951 0.05306894 0.05447614 0.05495059 0.05531013
 0.05558807 0.05722451 0.0517258  0.05599004 0.06261086 0.04784989
 0.05304605 0.03904092 0.08127844 0.08480138 0.07820797 0.085558
 0.08842921 0.08837998 0.05559325 0.08644557 0.07795626 0.08456469
 0.0847916  0.08612603 0.19358301 0.08718145 0.05480599 0.08299053
 0.09194881 0.09902424 0.09189624 0.07515806 0.14554971 0.11398941
 0.30301595 0.31100804 0.31687033 0.29450667 0.12217474 0.3173709
 0.28792536 0.31196713 0.29317826 0.29443824]

- 4451 expected decrease violations (out of 72123 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-147.24017334; mean=-67.11014024; max=-0.00000095
-- Smallest suggested mesh based on expected decrease violations: 0.00000054

- 127 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99989885; mean=0.88892692; max=14.51707458
-- 0 hard violations (out of 64)

- 3 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=-8.45086670; mean=374.63308716; max=857.90185547
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 38 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 962
- Init. samples: 58
- Unsafe samples: 2
- Target samples: 2
- Initializing iteration took 0.06853747367858887 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 38): 100%|████████████████████████████████████████████████████████| 25/25 [00:12<00:00,  2.01it/s]
Number of times the learn.train_step function was compiled: 29

Loss components in last train step:
 - 0. total: 0.5427539
 - 1. init: 0.0
 - 2. init counterx: 0.0
 - 3. unsafe: 0.0
 - 4. unsafe counterx: 0.0
 - 5. expDecrease: 0.002366931
 - 6. expDecrease counterx: 0.5403869
 - 7. loss_lipschitz: 0.0
 - 8. loss_aux: 0.0

Lipschitz policy (all methods): [(Array(0.25929508, dtype=float32), Array([1., 1.], dtype=float32)), (Array(0.12325622, dtype=float32), Array([1.       , 0.9994312], dtype=float32)), (Array(0.30727044, dtype=float32), Array([1.], dtype=float32)), (Array(0.15367894, dtype=float32), Array([1.       , 0.9994312], dtype=float32)), (Array(2.3185256, dtype=float32), None), (Array(1.713706, dtype=float32), None), (Array(2.2761085, dtype=float32), None), (Array(5.2508087, dtype=float32), None)]
Lipschitz certificate (all methods) [(Array(2486.5151, dtype=float32), Array([1., 1.], dtype=float32)), (Array(1073.7872, dtype=float32), Array([1.        , 0.72506094], dtype=float32)), (Array(4127.8867, dtype=float32), Array([0.99999994], dtype=float32)), (Array(2392.8936, dtype=float32), Array([1.        , 0.72506094], dtype=float32)), (Array(13447.043, dtype=float32), None), (Array(16994.21, dtype=float32), None), (Array(19156.514, dtype=float32), None), (Array(60939.68, dtype=float32), None)]
Create trace plot...
Create vector plot...
Vectors shape: (100, 2)
- 2D Quiver...
Create dataset plot...
Create certificate plot...

Check martingale conditions...
- Total number of samples: 90000
- Overall Lipschitz coefficient K = 2273.308 (L1)
-- Lipschitz coefficient of certificate: 1073.787 (L1)
-- Lipschitz coefficient of policy: 0.123 (L1)
Verifying exp. decrease condition: 100%|██████████████████████████████████████████████████████| 3/3 [00:02<00:00,  1.03it/s]
- Compute improved Lipschitz constant for SoftPlus activation function in certificate network
-- Number of factors below 1: 72709
-- Number of factors below 0.75: 159
-- Number of factors below 0.5: 116
-- Number of factors below 0.25: 94
-- Number of factors below 0.1: 74
-- Number of factors below 0.05: 60
-- Number of factors below 0.01: 33
Most violating states:
[[-0.205  0.015  0.01 ]
 [-0.205  0.025  0.01 ]
 [-0.205  0.005  0.01 ]
 [-0.205  0.035  0.01 ]
 [-0.205  0.045  0.01 ]
 [-0.205 -0.005  0.01 ]
 [-0.205 -0.015  0.01 ]
 [-0.205  0.055  0.01 ]
 [-0.205 -0.025  0.01 ]
 [-0.205 -0.035  0.01 ]
 [-0.205 -0.045  0.01 ]
 [-0.205  0.065  0.01 ]
 [-0.205 -0.055  0.01 ]
 [-0.205 -0.065  0.01 ]
 [ 0.205  0.025  0.01 ]
 [ 0.205  0.015  0.01 ]
 [ 0.205  0.035  0.01 ]
 [ 0.205  0.005  0.01 ]
 [ 0.205 -0.005  0.01 ]
 [ 0.205  0.045  0.01 ]
 [ 0.205  0.055  0.01 ]
 [ 0.205 -0.015  0.01 ]
 [-0.205 -0.075  0.01 ]
 [ 0.205  0.065  0.01 ]
 [ 0.205 -0.025  0.01 ]
 [-0.215  0.025  0.01 ]
 [-0.215  0.035  0.01 ]
 [ 0.205 -0.035  0.01 ]
 [ 0.205 -0.045  0.01 ]
 [-0.215  0.045  0.01 ]
 [-0.215  0.015  0.01 ]
 [ 0.205 -0.055  0.01 ]
 [-0.215  0.005  0.01 ]
 [ 0.205  0.075  0.01 ]
 [-0.215  0.055  0.01 ]
 [-0.205  0.075  0.01 ]
 [-0.215 -0.005  0.01 ]
 [-0.215 -0.015  0.01 ]
 [-0.215 -0.025  0.01 ]
 [ 0.205 -0.065  0.01 ]
 [-0.215 -0.035  0.01 ]
 [-0.215  0.065  0.01 ]
 [-0.215 -0.045  0.01 ]
 [-0.215 -0.055  0.01 ]
 [ 0.205 -0.075  0.01 ]
 [ 0.205  0.085  0.01 ]
 [-0.215 -0.065  0.01 ]
 [ 0.215 -0.025  0.01 ]
 [ 0.215 -0.015  0.01 ]
 [ 0.215 -0.005  0.01 ]
 [-0.215  0.075  0.01 ]
 [ 0.215 -0.035  0.01 ]
 [ 0.215  0.005  0.01 ]
 [ 0.215  0.015  0.01 ]
 [ 0.215 -0.045  0.01 ]
 [-0.215 -0.075  0.01 ]
 [ 0.215  0.025  0.01 ]
 [-0.205  0.085  0.01 ]
 [ 0.215  0.035  0.01 ]
 [ 0.215  0.045  0.01 ]
 [ 0.215  0.055  0.01 ]
 [ 0.215 -0.055  0.01 ]
 [ 0.215  0.065  0.01 ]
 [-0.205 -0.085  0.01 ]
 [ 0.205 -0.085  0.01 ]
 [ 0.215 -0.065  0.01 ]
 [ 0.215  0.075  0.01 ]
 [ 0.215  0.085  0.01 ]
 [ 0.215 -0.075  0.01 ]
 [ 0.215 -0.085  0.01 ]
 [-0.225  0.045  0.01 ]
 [-0.225  0.035  0.01 ]
 [-0.225  0.055  0.01 ]
 [-0.225  0.025  0.01 ]
 [-0.225  0.015  0.01 ]
 [-0.215  0.085  0.01 ]
 [-0.225 -0.015  0.01 ]
 [-0.225  0.005  0.01 ]
 [-0.225 -0.025  0.01 ]
 [-0.225 -0.005  0.01 ]
 [-0.225 -0.035  0.01 ]
 [-0.225  0.065  0.01 ]
 [-0.225 -0.045  0.01 ]
 [-0.215 -0.085  0.01 ]
 [-0.225 -0.055  0.01 ]
 [-0.225  0.075  0.01 ]
 [-0.225 -0.065  0.01 ]
 [ 0.225 -0.015  0.01 ]
 [ 0.225 -0.025  0.01 ]
 [ 0.225 -0.005  0.01 ]
 [ 0.225 -0.035  0.01 ]
 [-0.225 -0.075  0.01 ]
 [ 0.225 -0.045  0.01 ]
 [ 0.225  0.005  0.01 ]
 [ 0.225 -0.055  0.01 ]
 [ 0.225  0.015  0.01 ]
 [ 0.225  0.025  0.01 ]
 [ 0.225  0.035  0.01 ]
 [ 0.225  0.045  0.01 ]
 [ 0.225 -0.065  0.01 ]]
Corresponding V values are:
[[1.7594857e-05]
 [2.5301415e-05]
 [1.2710035e-05]
 [3.6137695e-05]
 [5.4691234e-05]
 [9.4591132e-06]
 [7.0158953e-06]
 [8.7152643e-05]
 [5.4694533e-06]
 [4.9396435e-06]
 [5.2256378e-06]
 [1.4081740e-04]
 [6.1656356e-06]
 [8.3756877e-06]
 [7.0935753e-06]
 [7.3363867e-06]
 [6.8131135e-06]
 [7.5364296e-06]
 [8.3835193e-06]
 [6.4381493e-06]
 [6.2039690e-06]
 [9.6511694e-06]
 [1.9020519e-05]
 [7.1745294e-06]
 [1.1096223e-05]
 [3.4820281e-05]
 [4.9275903e-05]
 [1.3556467e-05]
 [1.9088136e-05]
 [7.2045303e-05]
 [2.5608764e-05]
 [3.3183500e-05]
 [2.0393185e-05]
 [9.0804388e-06]
 [1.1522004e-04]
 [2.5572468e-04]
 [1.7767388e-05]
 [1.6711550e-05]
 [1.6802576e-05]
 [6.2412422e-05]
 [1.9575895e-05]
 [2.0146075e-04]
 [2.4686316e-05]
 [3.4882432e-05]
 [1.3904601e-04]
 [4.6062520e-05]
 [4.8673883e-05]
 [4.6985740e-05]
 [4.3112756e-05]
 [4.0785038e-05]
 [3.9092684e-04]
 [5.2098840e-05]
 [3.9408889e-05]
 [3.8356673e-05]
 [6.0128128e-05]
 [7.7180732e-05]
 [3.6936523e-05]
 [5.7013449e-04]
 [3.6198846e-05]
 [3.6055382e-05]
 [3.6405389e-05]
 [8.1261387e-05]
 [3.8576629e-05]
 [7.4380405e-05]
 [6.0463400e-04]
 [1.5512286e-04]
 [4.7077323e-05]
 [1.4754011e-04]
 [3.4405309e-04]
 [1.3217501e-03]
 [1.6154036e-04]
 [1.2796791e-04]
 [2.2670609e-04]
 [1.1184432e-04]
 [1.0663447e-04]
 [1.0514760e-03]
 [1.1418605e-04]
 [1.0515317e-04]
 [1.1817021e-04]
 [1.0922985e-04]
 [1.3739237e-04]
 [3.8967535e-04]
 [1.6039038e-04]
 [2.8907339e-04]
 [2.0585168e-04]
 [8.7648211e-04]
 [2.9196544e-04]
 [2.0918119e-04]
 [2.0825451e-04]
 [2.1362709e-04]
 [2.3537615e-04]
 [4.1928756e-04]
 [2.7210056e-04]
 [2.1917041e-04]
 [3.3299983e-04]
 [2.2560412e-04]
 [2.3240941e-04]
 [2.3775647e-04]
 [2.3970555e-04]
 [4.5496193e-04]]
[[0.00096631]
 [0.00098736]
 [0.00097789]
 [0.001117  ]
 [0.00132065]
 [0.00097646]
 [0.00099573]
 [0.00166999]
 [0.00111093]
 [0.00124691]
 [0.00147701]
 [0.00265131]
 [0.00184437]
 [0.0026106 ]
 [0.00831954]
 [0.00828166]
 [0.00840581]
 [0.0079663 ]
 [0.00746567]
 [0.0084841 ]
 [0.00852801]
 [0.00712806]
 [0.00559685]
 [0.00833691]
 [0.00695709]
 [0.01021105]
 [0.00969774]
 [0.00693076]
 [0.00698146]
 [0.00959644]
 [0.01055599]
 [0.00700094]
 [0.01069659]
 [0.00858896]
 [0.01034859]
 [0.00608501]
 [0.01049517]
 [0.0102661 ]
 [0.01034703]
 [0.00774097]
 [0.01042571]
 [0.01253004]
 [0.01179493]
 [0.01327258]
 [0.0118389 ]
 [0.03179578]
 [0.01641132]
 [0.04674229]
 [0.04806834]
 [0.05037525]
 [0.02029299]
 [0.04774952]
 [0.0519325 ]
 [0.05388075]
 [0.04906351]
 [0.02424996]
 [0.05371234]
 [0.02509927]
 [0.053924  ]
 [0.05445198]
 [0.0549663 ]
 [0.04862734]
 [0.05489588]
 [0.02228313]
 [0.0354908 ]
 [0.04548074]
 [0.05384108]
 [0.11168151]
 [0.04714941]
 [0.09911261]
 [0.10211305]
 [0.10662618]
 [0.0950577 ]
 [0.11261053]
 [0.11740033]
 [0.07195342]
 [0.11477367]
 [0.11946621]
 [0.11202253]
 [0.11746851]
 [0.10790429]
 [0.09775336]
 [0.10653922]
 [0.08357725]
 [0.10844305]
 [0.11069199]
 [0.12094953]
 [0.3166799 ]
 [0.32459477]
 [0.30877334]
 [0.32615262]
 [0.141416  ]
 [0.3172563 ]
 [0.3020818 ]
 [0.30268914]
 [0.31104255]
 [0.31171313]
 [0.31412435]
 [0.31633195]
 [0.29851255]]
Softplus factor for those samples:
[0.00096583 0.00098693 0.00097746 0.00111639 0.00131971 0.00097597
 0.00099522 0.00166857 0.00111032 0.00124615 0.00147593 0.00264776
 0.00184262 0.00260723 0.00828505 0.00824749 0.00837058 0.00793457
 0.00743783 0.00844818 0.00849175 0.00710273 0.0055812  0.00830221
 0.00693291 0.01015908 0.00965083 0.00690675 0.00695711 0.00955057
 0.01050055 0.00697649 0.01063967 0.00855219 0.01029527 0.00606656
 0.01044023 0.01021361 0.01029372 0.00771099 0.01037151 0.01245183
 0.01172566 0.01318491 0.01176906 0.03129554 0.01627737 0.04566675
 0.04693139 0.04912752 0.02008837 0.04662746 0.05060709 0.05245489
 0.0478794  0.02395833 0.05229539 0.02478683 0.05249596 0.05299604
 0.05348295 0.04746401 0.05341619 0.02203673 0.03486842 0.04446197
 0.05241728 0.10567099 0.04605514 0.09435928 0.0970726  0.10113835
 0.09067953 0.1065014  0.11077088 0.06942576 0.10843211 0.11260599
 0.10597587 0.1108315  0.10228646 0.09312749 0.10106021 0.08018005
 0.10277003 0.10478562 0.11392134 0.27143615 0.27717984 0.26565284
 0.278305   0.13187188 0.27185595 0.26072246 0.26117128 0.26731735
 0.26780844 0.2695719  0.27118254 0.25807905]

- 4225 expected decrease violations (out of 72709 checked vertices)
-- Stats. of E[V(x')-V(x)]: min=-148.80822754; mean=-68.07448079; max=-0.00000061
-- Smallest suggested mesh based on expected decrease violations: 0.00000026

- 128 initial state violations (out of 308 checked vertices)
-- Stats. of [V_init_ub-1] (>0 is violation): min=-0.99985874; mean=0.73281562; max=13.93719101
-- 0 hard violations (out of 64)

- 0 unsafe state violations (out of 3322 checked vertices)
-- Stats. of [V_unsafe_lb-1/(1-p)] (<0 is violation): min=3.05914307; mean=361.26504517; max=824.09875488
-- 0 hard violations (out of 0)
Create dataset plot...

- Skip refinement, because lowest suggested mesh (0.00000) is below minimum tau (0.00001)

Refresh 50.0% of the counterexample buffer
low: [-1.495 -1.495]
high: [1.495 1.495]
size: [300 300]

================


=== Start CEGIS iteration 39 (train buffer: 90000; counterexample buffer: 30000) ===


Create training batches from train buffer...
- Exp. decrease samples: 2910
- Init. samples: 6
- Unsafe samples: 102
- Target samples: 54

Create training batches from counterexample buffer...
- Exp. decrease samples: 963
- Init. samples: 59
- Unsafe samples: 0
- Target samples: 2
- Initializing iteration took 0.31037425994873047 sec.
- Number of epochs: 25; number of batches: 30
Learner epochs (iteration 39):  68%|██████████████████████████████████████                  | 17/25 [00:11<00:03,  2.02it/s]Learner epochs (iteration 39):  96%|█████████████████████████████████████████████████████▊  | 24/25 [00:14<00:00,  2.17it/s]Learner epochs (iteration 39):  96%|█████████████████████████████████████████████████████▊  | 24/25 [00:15<00:00,  1.60it/s]
Traceback (most recent call last):
  File "/home/tbadings/Documents/martingales/neural_stochastic_control/run.py", line 354, in <module>
    V_state = V_state.apply_gradients(grads=V_grads)
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/flax/training/train_state.py", line 101, in apply_gradients
    updates, new_opt_state = self.tx.update(
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/optax/_src/combine.py", line 59, in update_fn
    updates, new_s = fn(updates, s, params, **extra_args)
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/optax/_src/base.py", line 311, in update
    return tx.update(updates, state, params)
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/optax/_src/transform.py", line 343, in update_fn
    nu = update_moment_per_elem_norm(updates, state.nu, b2, 2)
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/optax/_src/transform.py", line 106, in update_moment_per_elem_norm
    return jax.tree_util.tree_map(
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/jax/_src/tree_util.py", line 244, in tree_map
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/jax/_src/tree_util.py", line 244, in <genexpr>
    return treedef.unflatten(f(*xs) for xs in zip(*all_leaves))
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/optax/_src/transform.py", line 107, in <lambda>
    lambda g, t: (1 - decay) * orderth_norm(g) + decay * t, updates, moments)
  File "/home/tbadings/miniconda3/envs/flax/lib/python3.10/site-packages/jax/_src/numpy/array_methods.py", line 271, in deferring_binary_op
    return binary_op(*args)
KeyboardInterrupt
^C
